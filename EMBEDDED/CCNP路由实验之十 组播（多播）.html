<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  <title>CCNP路由实验之十 组播（多播） | 芯机智</title>
  
  
  <meta name="description" content="CCNP路由实验之十 组播（多播）
单播（Unicast）：网络节点之间的通信通讯的模式是”一对一”的，此时信息的接收和传递只在两个节点之间进行。例如，你在收发电子邮件、浏览网页时，必须与邮件服务器、Web服务器建立连接，此时使用的就是单播数据传输方">
  

  
  <link rel="alternate" href="/atom.xml" title="芯机智">
  

  <meta name="HandheldFriendly" content="True" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <!-- meta -->
  

  <!-- link -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.10.1/css/all.min.css">
  

  

  
    <link rel="stylesheet" href="/style.css">
  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
  
</head>

<body>
  
  
  <header class="l_header pure">
  <div id="loading-bar-wrapper">
    <div id="loading-bar" class="pure"></div>
  </div>

	<div class='wrapper'>
		<div class="nav-main container container--flex">
      <a class="logo flat-box" href='/' >
        
          芯机智
        
      </a>
			<div class='menu navgation'>
				<ul class='h-list'>
          
  					
  						<li>
								<a class="nav flat-box" href="/"
                  
                  
                  id="home">
									<i class='fas fa-home fa-fw'></i>&nbsp;主页
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/categories/"
                  
                    rel="nofollow"
                  
                  
                  id="categories">
									<i class='fas fa-folder-open fa-fw'></i>&nbsp;分类
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/blog/tags/"
                  
                    rel="nofollow"
                  
                  
                  id="blogtags">
									<i class='fas fa-hashtag fa-fw'></i>&nbsp;标签
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/blog/archives/"
                  
                    rel="nofollow"
                  
                  
                  id="blogarchives">
									<i class='fas fa-archive fa-fw'></i>&nbsp;归档
								</a>
							</li>
      			
      		
				</ul>
			</div>

			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="搜索" />
						<i class="icon fas fa-search fa-fw"></i>
					</form>
				</div>
			
			<ul class='switcher h-list'>
				
					<li class='s-search'><a class="fas fa-search fa-fw" href='javascript:void(0)'></a></li>
				
				<li class='s-menu'><a class="fas fa-bars fa-fw" href='javascript:void(0)'></a></li>
			</ul>
		</div>

		<div class='nav-sub container container--flex'>
			<a class="logo flat-box"></a>
			<ul class='switcher h-list'>
				<li class='s-comment'><a class="flat-btn fas fa-comments fa-fw" href='javascript:void(0)'></a></li>
        
          <li class='s-toc'><a class="flat-btn fas fa-list fa-fw" href='javascript:void(0)'></a></li>
        
			</ul>
		</div>
	</div>
</header>
	<aside class="menu-phone">
    <header>
		<nav class="menu navgation">
      <ul>
        
          
            <li>
							<a class="nav flat-box" href="/"
                
                
                id="home">
								<i class='fas fa-clock fa-fw'></i>&nbsp;近期文章
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/blog/archives/"
                
                  rel="nofollow"
                
                
                id="blogarchives">
								<i class='fas fa-archive fa-fw'></i>&nbsp;文章归档
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/projects/"
                
                
                id="projects">
								<i class='fas fa-code-branch fa-fw'></i>&nbsp;开源项目
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/friends/"
                
                  rel="nofollow"
                
                
                id="friends">
								<i class='fas fa-link fa-fw'></i>&nbsp;我的友链
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="https://xaoxuu.com/wiki/material-x/"
                
                  rel="nofollow"
                
                
                id="https:xaoxuu.comwikimaterial-x">
								<i class='fas fa-book fa-fw'></i>&nbsp;主题文档
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/about/"
                
                  rel="nofollow"
                
                
                id="about">
								<i class='fas fa-info-circle fa-fw'></i>&nbsp;关于小站
							</a>
            </li>
          
       
      </ul>
		</nav>
    </header>
	</aside>
<script>setLoadingBarProgress(40);</script>



  <div class="l_body nocover">
    <div class='body-wrapper'>
      <div class='l_main'>
  

  
    <article id="post" class="post white-box article-type-post" itemscope itemprop="blogPost">
      


  <section class='meta'>
    
    
    <div class="meta" id="header-meta">
      
        
  
    <h1 class="title">
      <a href="/EMBEDDED/CCNP路由实验之十 组播（多播）.html">
        CCNP路由实验之十 组播（多播）
      </a>
    </h1>
  


      
      <div class='new-meta-box'>
        
          
        
          
            
  <div class='new-meta-item author'>
    <a href="http://demonelf.github.io" rel="nofollow">
      
        <i class="fas fa-user" aria-hidden="true"></i>
      
      <p>madhex</p>
    </a>
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt" aria-hidden="true"></i>
    <p>2016-05-10</p>
  </a>
</div>

          
        
          
            
  
  <div class='new-meta-item category'>
    <a href='/categories/EMBEDDED/' rel="nofollow">
      <i class="fas fa-folder-open" aria-hidden="true"></i>
      <p>EMBEDDED</p>
    </a>
  </div>


          
        
          
            
  
    <div class="new-meta-item browse busuanzi">
      <a class='notlink'>
        <i class="fas fa-eye" aria-hidden="true"></i>
        <p>
          <span id="busuanzi_value_page_pv">
            <i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i>
          </span>
        </p>
      </a>
    </div>
  


          
        
          
            

          
        
      </div>
      
        <hr>
      
    </div>
  </section>


      <section class="article typo">
        <div class="article-entry" itemprop="articleBody">
          <p><span style="color:black"><span style="font-size:14pt"><strong> CCNP<span style="font-family:宋体">路由实验之十</span> <span style="font-family:宋体">组播（多播）</span></strong></span><span style="font-family:Arial; font-size:10pt"><br>            </span></span></p>
<a id="more"></a>
<p><span style="color:black"><span style="font-size:12pt"><span style="font-family:Times New Roman">  </span><span style="font-family:宋体"><strong>单播（</strong></span></span><span style="color:#333333"><span style="font-family:Times New Roman; font-size:10pt">Unicast</span><span style="color:black"><span style="font-family:宋体"><span style="font-size:12pt"><strong>）：</strong></span><span style="font-size:10pt">网络节点之间的通信通讯的模式是”一对一”的，此时信息的接收和传递只在两个节点之间进行。例如，你在收发电子邮件、浏览网页时，必须与邮件服务器、</span></span><span style="font-size:10pt"><span style="font-family:Verdana">Web</span><span style="font-family:宋体">服务器建立连接，此时使用的就是单播数据传输方式。网络中的交换机和路由器对数据只进行转发不进行复制。如果</span><span style="font-family:Times New Roman">10</span><span style="font-family:宋体">个客户机需要相同的数据，则服务器需要逐一传送，重复</span><span style="font-family:Times New Roman">10</span><span style="font-family:宋体">次相同的工作。但由于其能够针对每个客户的及时响应，所以现在的网页浏览全部都是采用</span><span style="font-family:Times New Roman">IP</span><span style="font-family:宋体">单播协议。网络中的路由器和交换机根据其目标地址选择传输路径，将</span><span style="font-family:Times New Roman">IP</span><span style="font-family:宋体">单播数据传送到其指定的目的地。单播应用于</span><span style="font-family:Times New Roman">TCP</span><span style="font-family:宋体">，而</span><span style="font-family:Times New Roman">TCP</span><span style="font-family:宋体">是一个面向连接的协议，它意味着分别运行于两主机（由</span><span style="font-family:Times New Roman">IP</span><span style="font-family:宋体">地址确定）内的两进程（由端口号确定）间存在一条连接。考虑包含多个主机的共享信道网络如以太网。每个以太网帧包含源主机和目的主机的以太网地址（</span><span style="font-family:Times New Roman">48 bit</span><span style="font-family:宋体">）。通常每个以太网帧仅发往单个目的主机，目的地址指明单个接收接口，因而称为单播</span><span style="font-family:Times New Roman">(unicast)</span><span style="font-family:宋体">。在这种方式下，任意两个主机的通信不会干扰网内其他主机（可能引起争夺共享信道的情况除外）</span><span style="font-family:Arial"><br>                        </span></span></span></span></span></p>
<ol>
<li><div style="background: white"><span style="color:black"><span style="font-family:宋体; font-size:9pt">单播的优点：</span><span style="font-family:Arial; font-size:10pt"><br>                </span></span></div>

<p><span style="color:black"><span style="font-size:9pt">1<span style="font-family:宋体">）服务器及时响应客户机的请求</span></span><span style="font-size:10pt"></span></span></p>
<pre><code>            &lt;/span&gt;&lt;/span&gt;
</code></pre></li>
</ol>
<p><span style="color:black"><span style="font-size:9pt">2<span style="font-family:宋体">）服务器针对每个客户不同的请求发送不同的数据，容易实现个性化服务。</span></span><span style="font-size:10pt"><br>                    </span></span></p>
<ol>
<li><div style="background: white"><span style="color:black"><span style="font-family:宋体; font-size:9pt">单播的缺点：</span><span style="font-size:10pt"><br>                </span></span></div>

<p><span style="color:black"><span style="font-size:9pt">1<span style="font-family:宋体">）服务器针对每个客户机发送数据流，在客户数量大、每个客户机流量大的流媒体应用中服务器不堪重负。</span></span><span style="font-size:10pt"></span></span></p>
<pre><code>            &lt;/span&gt;&lt;/span&gt;
</code></pre></li>
</ol>
<p><span style="color:black"><span style="font-size:9pt">2<span style="font-family:宋体">）大量佔用网络带宽</span></span><span style="font-size:10pt"><br>                    </span></span></p>
<p><span style="color:black; font-size:10pt"><strong><span style="font-family:宋体">广播（</span>Broadcast<span style="font-family:宋体">）：</span></strong>主机之间”一对所有”的通讯模式（UDP<span style="font-family:宋体">），网络对其中每一台主机发出的信号都进行无条件复制并转发，所有主机都可以接收到所有信息（不管你是否需要），如客户机通过</span><span style="font-family:Verdana">DHCP</span><span style="font-family:宋体">自动获得</span><span style="font-family:Verdana">IP</span><span style="font-family:宋体">地址的过程就是通过广播来实现的，由于其不用路径选择，所以其网络成本可以很低廉。有线电视网就是典型的广播型网络，我们的电视机实际上是接受到所有频道的信号，但只将一个频道的信号还原成画面。在数据网络中也允许广播的存在，但是同单播和多播相比，广播几乎占用了子网内网络的所有带宽，因此其被限制在二层交换机的局域网范围内，禁止广播数据穿过路由器，防止广播数据（广播风暴）影响大面积的主机。集线器由于其工作原理决定了不可能过滤广播风暴，一般的交换机也没有这一功能，不过现在有的网络交换机（如全向的</span><span style="font-family:Verdana">QS</span><span style="font-family:宋体">系列交换机）也有过滤广播风暴功能了，路由器本身就有隔离广播风暴的作用。</span><span style="font-family:Verdana"> </span><span style="font-family:宋体">广播风暴不能完全杜绝，但是只能在同一子网内传播，就好像喇叭的声音只能在同一会场内传播一样，因此在由几百台甚至上千台电脑构成的大中型局域网中，一般进行子网划分，就像将一个大厅用墙壁隔离成许多小厅一样，以达到隔离广播风暴的目的。</span><span style="font-family:Verdana"> </span><span style="font-family:宋体">在</span><span style="font-family:Verdana">IP</span><span style="font-family:宋体">网络中，广播地址用</span><span style="font-family:Verdana">IP</span><span style="font-family:宋体">地址</span><span style="font-family:Verdana">“255.255.255.255”</span><span style="font-family:宋体">来表示，这个</span><span style="font-family:Verdana">IP</span><span style="font-family:宋体">地址代表同一子网内所有的</span><span style="font-family:Verdana">IP</span><span style="font-family:宋体">地址。</span><br>                </span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">广播分为第</span><span style="font-family:Times New Roman">2</span><span style="font-family:宋体">层广播和第</span><span style="font-family:Times New Roman">3</span><span style="font-family:宋体">层广播。第</span><span style="font-family:Times New Roman">2</span><span style="font-family:宋体">层广播也称硬件广播，用于在局域网内向所有的结点发送数据，通常不会穿过局域网的边界（路由器），除非它变成一个单播。广播是一个二进制的全</span><span style="font-family:Times New Roman">1</span><span style="font-family:宋体">或者十六进制全</span><span style="font-family:Times New Roman">F</span><span style="font-family:宋体">的地址。</span><span style="font-family:Times New Roman">  </span><span style="font-family:宋体">第</span><span style="font-family:Times New Roman">3</span><span style="font-family:宋体">层广播用于在这个网络内向所有的结点发送数据。第</span><span style="font-family:Times New Roman">3</span><span style="font-family:宋体">层广播也支持平面的老式广播。广播信息是指以某个广播域所有主机为目的的信息。这些被称为网络广播，它们是所有的主机位均为</span><span style="font-family:Times New Roman">ON</span><span style="font-family:宋体">。</span><br>                </span></p>
<p><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">广播的优点：</span><br>1<span style="font-family:宋体">）网络设备简单，维护简单，布网成本低廉</span></span><span style="font-size:10pt"><br>                    </span></span></p>
<p><span style="color:black"><span style="font-size:9pt">2<span style="font-family:宋体">）由于服务器不用向每个客户机单独发送数据，所以服务器流量负载极低。</span></span><span style="font-size:10pt"><br>                    </span></span></p>
<p><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">广播的缺点：</span><br>1<span style="font-family:宋体">）无法针对每个客户的要求和时间及时提供个性化服务。</span></span><span style="font-size:10pt"><br>                    </span></span></p>
<p><span style="color:black"><span style="font-size:9pt">2<span style="font-family:宋体">）网络允许服务器提供数据的带宽有限，客户端的最大带宽＝服务总带宽。例如有线电视的客户端的线路支持</span>100<span style="font-family:宋体">个频道（如果采用数字压缩技术，理论上可以提供</span>500<span style="font-family:宋体">个频道），即使服务商有更大的财力配置更多的发送设备、改成光纤主干，也无法超过此极限。也就是说无法向众多客户提供更多样化、更加个性化的服务。</span><br>3<span style="font-family:宋体">）广播禁止允许在</span>Internet<span style="font-family:宋体">宽带网上传输。</span></span><span style="font-size:10pt"><br>                    </span></span></p>
<p><span style="color:black"><span style="font-family:宋体"><span style="font-size:12pt"><strong>泛洪</strong></span><span style="font-size:10pt">，</span><span style="font-size:12pt">是<a href="http://baike.baidu.com/view/1077.htm" target="_blank" rel="external">交换机</a>和网桥使用的一种<a href="http://baike.baidu.com/view/166248.htm" target="_blank" rel="external">数据流</a>传递技术</span></span><span style="font-size:12pt">,<a href="http://baike.baidu.com/view/1077.htm" target="_blank" rel="external"><span style="font-family:宋体">交换机</span></a><span style="font-family:宋体">根据收到<a href="http://baike.baidu.com/view/1366167.htm" target="_blank" rel="external">数据帧</a>中的源</span>MAC<span style="font-family:宋体">地址建立该地址同交换机端口的映射，并将其写</span> <span style="font-family:宋体">入<a href="http://baike.baidu.com/view/325678.htm" target="_blank" rel="external"></a></span>MAC<span style="font-family:宋体">地址表<span style="text-decoration:underline">（</span></span><span style="text-decoration:underline">CAM<span style="font-family:宋体">表）</span></span>中。<a href="http://baike.baidu.com/view/1077.htm" target="_blank"><span style="font-family:宋体">交换机</span></a><span style="font-family:宋体">将<a href="http://baike.baidu.com/view/1366167.htm" target="_blank" rel="external">数据帧</a>中的目的</span>MAC<span style="font-family:宋体">地址同已建立的</span>MAC<span style="font-family:宋体">地址表进行比较，以决定由哪个端口进行转发。如<a href="http://baike.baidu.com/view/1366167.htm" target="_blank" rel="external">数据帧</a>中的目的</span>MAC<span style="font-family:宋体">地址不在</span>MAC<span style="font-family:宋体">地址表中，则向所有<a href="http://baike.baidu.com/view/1197744.htm" target="_blank" rel="external">端口转发</a>。</span></span><span style="font-size:10pt">泛洪操作广播的是普通数据帧而不是广播帧<span style="font-family:Times New Roman"> </span>(FF.FF.FF.FF.FF.FF).<span style="font-family:宋体">，广播是向同一子网内所有的端口（包括自己的那个端口）发送消息</span><span style="font-family:Times New Roman">; </span><span style="font-family:宋体">泛洪只是在所有的端口中不包括发送消息的（自己的）那个端口发送消息</span><span style="font-family:Times New Roman">.</span><br>                    </span></span></p>
<p><span style="color:black"><span style="font-size:12pt"><span style="font-family:宋体">洪水攻击包含</span>MAC<span style="font-family:宋体">泛洪、网络泛洪、</span>TCP SYN<span style="font-family:宋体">泛洪、应用程序泛洪、</span>DHCP<span style="font-family:宋体">报文泛洪攻击、</span>ARP<span style="font-family:宋体">报文泛洪攻击</span></span><span style="font-size:10pt"><br>                    </span></span></p>
<pre><code>1.  &lt;div style=&quot;background: white&quot;&gt;&lt;span style=&quot;color:black&quot;&gt;&lt;span style=&quot;font-size:9pt&quot;&gt;&lt;span style=&quot;font-family:Arial&quot;&gt;MAC&lt;/span&gt;&lt;span style=&quot;font-family:宋体&quot;&gt;泛洪：生在&lt;/span&gt;&lt;span style=&quot;font-family:Arial&quot;&gt;OSI&lt;/span&gt;&lt;span style=&quot;font-family:宋体&quot;&gt;第二层，攻击者进入&lt;/span&gt;&lt;span style=&quot;font-family:Arial&quot;&gt;LAN&lt;/span&gt;&lt;span style=&quot;font-family:宋体&quot;&gt;内，将假冒源&lt;/span&gt;&lt;span style=&quot;font-family:Arial&quot;&gt;MAC&lt;/span&gt;&lt;span style=&quot;font-family:宋体&quot;&gt;地址和目的&lt;/span&gt;&lt;span style=&quot;font-family:Arial&quot;&gt;MAC&lt;/span&gt;&lt;span style=&quot;font-family:宋体&quot;&gt;地址将数据帧发送到以太网上导致交换机的内容可寻址存储器（&lt;/span&gt;&lt;span style=&quot;font-family:Arial&quot;&gt;CAM&lt;/span&gt;&lt;span style=&quot;font-family:宋体&quot;&gt;）满掉，然后交换机失去转发功能，导致攻击者可以像在共享式以太网上对某些帧进行嗅探，如果发生了&lt;/span&gt;&lt;span style=&quot;font-family:Times New Roman&quot;&gt;mac&lt;/span&gt;&lt;span style=&quot;font-family:宋体&quot;&gt;地址泛洪攻击，那么你所处的局域网会出现网络缓慢或者断网现象，可以用&lt;/span&gt;&lt;span style=&quot;font-family:Times New Roman&quot;&gt;wireshark&lt;/span&gt;&lt;span style=&quot;font-family:宋体&quot;&gt;等抓包软件抓包分析，能够发现大量的数据包，其&lt;/span&gt;&lt;span style=&quot;font-family:Times New Roman&quot;&gt;mac&lt;/span&gt;&lt;span style=&quot;font-family:宋体&quot;&gt;地址均为随机伪造，且数据内容也为随机伪造。这种攻击可以通过端口安全技术方式防御，比如端口和&lt;/span&gt;&lt;span style=&quot;font-family:Arial&quot;&gt;MAC&lt;/span&gt;&lt;span style=&quot;font-family:宋体&quot;&gt;地址绑定。&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;font-family:Arial; font-size:10pt&quot;&gt;
                        &lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
2.  &lt;div style=&quot;background: white&quot;&gt;&lt;span style=&quot;color:black&quot;&gt;&lt;span style=&quot;font-size:9pt&quot;&gt;&lt;span style=&quot;font-family:宋体&quot;&gt;网络泛洪&lt;/span&gt;Smurf&lt;span style=&quot;font-family:宋体&quot;&gt;：发生在&lt;/span&gt;OSI&lt;span style=&quot;font-family:宋体&quot;&gt;第三层，就是假冒&lt;/span&gt;ICMP&lt;span style=&quot;font-family:宋体&quot;&gt;广播&lt;/span&gt;ping&lt;span style=&quot;font-family:宋体&quot;&gt;，如果路由器没有关闭定向广播，那攻击者就可以在某个网络内对其它网络发送定向广播&lt;/span&gt; ping&lt;span style=&quot;font-family:宋体&quot;&gt;，那个网络中的主机越是多，造成的结果越是严重，因为每个主机默认都会响应这个&lt;/span&gt;ping&lt;span style=&quot;font-family:宋体&quot;&gt;，导致链路流量过大而拒绝服务，所以属于增幅泛洪攻击，当然也可以对本&lt;/span&gt; &lt;span style=&quot;font-family:宋体&quot;&gt;网络发送广播&lt;/span&gt;ping&lt;span style=&quot;font-family:宋体&quot;&gt;。&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;font-size:10pt&quot;&gt;
                        &lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
3.  &lt;div style=&quot;background: white&quot;&gt;&lt;span style=&quot;color:black&quot;&gt;&lt;span style=&quot;font-size:9pt&quot;&gt;&lt;span style=&quot;font-family:宋体&quot;&gt;网络泛洪&lt;/span&gt;DDos&lt;span style=&quot;font-family:宋体&quot;&gt;：发生在&lt;/span&gt;OSI&lt;span style=&quot;font-family:宋体&quot;&gt;第三、四层，攻击侵入许多因特网上的系统，将&lt;/span&gt;DDos&lt;span style=&quot;font-family:宋体&quot;&gt;控制软件安装进去，然后这些系统再去感染其它系统，通过这些代理，攻击者将攻击指令发送给&lt;/span&gt;DDos&lt;span style=&quot;font-family:宋体&quot;&gt;控制软件，然后这个系统就去控制下面的代理系统去对某个&lt;/span&gt;IP&lt;span style=&quot;font-family:宋体&quot;&gt;地址发送大量假冒的网络流量，然后受攻击者的网络将被这些假的流量所占据就无法为他们的正常用户提供服务了。&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;font-size:10pt&quot;&gt;
                        &lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
4.  &lt;div style=&quot;background: white&quot;&gt;&lt;span style=&quot;color:black&quot;&gt;&lt;span style=&quot;font-size:9pt&quot;&gt;TCP SYN&lt;span style=&quot;font-family:宋体&quot;&gt;泛洪发生在&lt;/span&gt;OSI&lt;span style=&quot;font-family:宋体&quot;&gt;第四层，这种方式利用&lt;/span&gt;TCP&lt;span style=&quot;font-family:宋体&quot;&gt;协议的特性，就是三次握手。攻击者发送&lt;/span&gt;TCP SYN&lt;span style=&quot;font-family:宋体&quot;&gt;，&lt;/span&gt;SYN&lt;span style=&quot;font-family:宋体&quot;&gt;是&lt;/span&gt;TCP&lt;span style=&quot;font-family:宋体&quot;&gt;三次握手中的第一个数据包，而当服务器返回&lt;/span&gt;ACK&lt;span style=&quot;font-family:宋体&quot;&gt;后，改攻击者就不对之进行再确认，那这个&lt;/span&gt;TCP&lt;span style=&quot;font-family:宋体&quot;&gt;连接就处于挂起状态，也就是所谓的半连接状态，服务器收不到再确认的话，还会重复发送&lt;/span&gt;ACK&lt;span style=&quot;font-family:宋体&quot;&gt;给攻击者。这样更加会浪费服务器的资源。攻击者就对服务器发送非常大量的这种&lt;/span&gt;TCP&lt;span style=&quot;font-family:宋体&quot;&gt;连接，由于每一个都没法完成三次握手，所以在服务器上，这些&lt;/span&gt;TCP&lt;span style=&quot;font-family:宋体&quot;&gt;连接会因为挂起状态而消耗&lt;/span&gt;CPU&lt;span style=&quot;font-family:宋体&quot;&gt;和内存，最后服务器可能死机，就无法为正常用户提供服务了。&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;font-size:10pt&quot;&gt;
                        &lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
5.  &lt;div style=&quot;background: white&quot;&gt;&lt;span style=&quot;color:black&quot;&gt;&lt;span style=&quot;font-size:9pt&quot;&gt;&lt;span style=&quot;font-family:宋体&quot;&gt;应用程序泛洪发生在&lt;/span&gt;OSI&lt;span style=&quot;font-family:宋体&quot;&gt;第七层，目的是消耗应用程序或系统资源，比较常见的应用程序泛洪就是垃圾邮件，但一般无法产生严重的结果。其它类型的应用程序泛洪可能是在服务器上持续运行高&lt;/span&gt;CPU&lt;span style=&quot;font-family:宋体&quot;&gt;消耗的程序或者用持续不断的认证请求对服务器进行泛洪攻击，意思就是当&lt;/span&gt;TCP&lt;span style=&quot;font-family:宋体&quot;&gt;连接完成后，在服务器提示输入密码的时候停止响应。&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;font-size:10pt&quot;&gt;
                        &lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
6.  &lt;div style=&quot;background: white&quot;&gt;[&lt;span style=&quot;color:black; font-family:宋体; font-size:9pt&quot;&gt;DHCP&lt;/span&gt;](http://baike.baidu.com/view/7992.htm)&lt;span style=&quot;color:black&quot;&gt;&lt;span style=&quot;font-family:宋体; font-size:9pt&quot;&gt;报文泛洪攻击是指：恶意用户利用工具伪造大量DHCP报文发送到服务器，一方面恶意耗尽了IP资源，使得合法用户无法获得IP资源;另一方面,如果[交换机](http://baike.baidu.com/view/1077.htm)上开启了DHCPSnooping功能，会将接收到的DHCP报文上送到[CPU](http://baike.baidu.com/view/2089.htm)。因此大量的DHCP[报文](http://baike.baidu.com/view/175122.htm)攻击设备会使DHCP服务器高负荷运行，甚至会导致设备瘫痪。&lt;/span&gt;&lt;span style=&quot;font-size:10pt&quot;&gt;
                        &lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
7.  &lt;div style=&quot;background: white&quot;&gt;[&lt;span style=&quot;color:black; font-family:宋体; font-size:9pt&quot;&gt;ARP&lt;/span&gt;](http://baike.baidu.com/view/32698.htm)[&lt;span style=&quot;color:black; font-family:宋体; font-size:9pt&quot;&gt;报文&lt;/span&gt;](http://baike.baidu.com/view/175122.htm)&lt;span style=&quot;color:black&quot;&gt;&lt;span style=&quot;font-family:宋体; font-size:9pt&quot;&gt;泛洪类似DHCP泛洪，同样是恶意用户发出大量的[ARP](http://baike.baidu.com/view/32698.htm)报文，造成L3设备的ARP表项溢出，影响正常用户的转发。&lt;/span&gt;&lt;span style=&quot;font-size:10pt&quot;&gt;
                        &lt;/span&gt;&lt;/span&gt;&lt;/div&gt;

&lt;span style=&quot;color:black; font-size:10pt&quot;&gt;&lt;span style=&quot;font-family:宋体&quot;&gt;冲突域（&lt;/span&gt;&lt;span style=&quot;font-family:Times New Roman&quot;&gt;Collision Domain&lt;/span&gt;&lt;span style=&quot;font-family:宋体&quot;&gt;）：一组与同一条物理介质相连的设备，其中任何两台设备同时访问该介质都将导致冲突，冲突域中同一时间内只有一台机器能够发送数据。第一层设备如集线器，与之连接的所有设备都属于同一个冲突域和同一个广播域；第二层设备如交换机和网桥，将网络划分成多个网段，每个网段是一个独立的冲突域，但是相连的所有设备是一个广播域，交换机的每个端口就是一个冲突域；&lt;/span&gt;&lt;span style=&quot;font-family:Arial&quot;&gt;
                        &lt;/span&gt;&lt;/span&gt;

&lt;span style=&quot;color:black; font-size:10pt&quot;&gt;&lt;span style=&quot;font-family:宋体&quot;&gt;广播域（&lt;/span&gt;&lt;span style=&quot;font-family:Times New Roman&quot;&gt;Broadcast Domain&lt;/span&gt;&lt;span style=&quot;font-family:宋体&quot;&gt;）：网络中一组相互接收广播消息的设备。第三层设备如路由器，将网络划分为多个冲突域和广播域。&lt;/span&gt;&lt;span style=&quot;font-family:Arial&quot;&gt;
                        &lt;/span&gt;&lt;/span&gt;
</code></pre><p><span style="color:black; font-size:10pt"><span style="font-family:宋体">以太网使用载波侦听多路访问</span><span style="font-family:Times New Roman">/</span><span style="font-family:宋体">冲突检测（</span><span style="font-family:Times New Roman">Carrier SenseMulti-Access/Collision Detectio</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">技术以减少冲突的发生。即，二层广播帧覆盖的范围就是广播域；二层单播帧覆盖的范</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">围就是冲突域。</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black"><span style="font-size:10pt"><strong><span style="font-family:宋体">多播（</span>Multicast<span style="font-family:宋体">）</span></strong></span><span style="font-size:9pt">：</span><span style="font-size:10pt">“<span style="font-family:宋体">多播</span>“<span style="font-family:宋体">也可以称为</span>“<span style="font-family:宋体">组播</span>“<span style="font-family:宋体">，</span> <span style="font-family:宋体">主机之间一对一组的通讯模式（</span>UDP<span style="font-family:宋体">），也就是加入了同一个组的主机可以接受到此组内的所有数据，网络中的交换机和路由器只向有需求者复制并转发其所需数据。主机可以向路由器请求加入或退出某个组，网络中的路由器和交换机有选择的复制并传输数据，即只将组内数据传输给那些加入组的主机（组播组）。这样既能一次将数据传输给多个有需要的主机，又能保证不影响其他不需要（未加入组）的主机的其他通讯。例如网上视频会议、网上视频点播特别适合采用多播方式。</span>IP<span style="font-family:宋体">网络的多播一般通过多播</span>IP<span style="font-family:宋体">地址来实现。多播</span>IP<span style="font-family:宋体">地址就是</span>D<span style="font-family:宋体">类</span>IP<span style="font-family:宋体">地址，即</span>224.0.0.0<span style="font-family:宋体">至</span>239.255.255.255<span style="font-family:宋体">之间的</span>IP<span style="font-family:宋体">地址。多播处于单播和广播之间，帧仅传送给属于多播组的多个主机。</span><span style="font-family:Arial"><br>                </span></span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">组播组可以是永久的也可以是临时的。组播组地址中，有一部分由官方分配的，称为永久组播组。永久组播组保持不变的是它的</span>ip<span style="font-family:宋体">地址，组中的成员构成可以发生变化。永久组播组中成员的数量都可以是任意的，甚至可以为零。那些没有保留下来供永久组播组使用的</span>ip<span style="font-family:宋体">组播地址，可以被临时组播组利用。</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">224.0.0.0</span><span style="font-family:宋体">～</span><span style="font-family:Times New Roman">224.0.0.255</span><span style="font-family:宋体">为预留的组播地址（永久组地址），地址</span><span style="font-family:Times New Roman">224.0.0.0</span><span style="font-family:宋体">保留不做分配，其它地址供路由协议使用；</span><span style="font-family:Times New Roman"> 224.0.1.0</span><span style="font-family:宋体">～</span><span style="font-family:Times New Roman">238.255.255.255</span><span style="font-family:宋体">为用户可用的组播地址（临时组地址），全网范围内有效；</span><span style="font-family:Times New Roman">239.0.0.0</span><span style="font-family:宋体">～</span><span style="font-family:Times New Roman">239.255.255.255</span><span style="font-family:宋体">为本地管理组播地址，仅在特定的本地范围内有效。常用的预留组播地址列表如下：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">224.0.0.0</span><span style="font-family:宋体">基准地址（保留）</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">224.0.0.1 </span><span style="font-family:宋体">所有主机和路由器地址，广播域内</span><span style="font-family:Times New Roman"> </span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">224.0.0.2</span><span style="font-family:宋体">所有组播路由器的地址</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">224.0.0.3</span><span style="font-family:宋体">不分配</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">224.0.0.4dvmrp </span><span style="font-family:宋体">路由器</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">224.0.0.5ospf </span><span style="font-family:宋体">路由器</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">224.0.0.6ospf dr</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">224.0.0.7st </span><span style="font-family:宋体">路由器</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">224.0.0.8st </span><span style="font-family:宋体">主机</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">224.0.0.9rip-2 </span><span style="font-family:宋体">路由器</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">224.0.0.10Eigrp </span><span style="font-family:宋体">路由器</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">224.0.0.11</span><span style="font-family:宋体">活动代理</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">224.0.0.12dhcp </span><span style="font-family:宋体">服务器</span><span style="font-family:Times New Roman">/</span><span style="font-family:宋体">中继代理</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">224.0.0.13</span><span style="font-family:宋体">所有</span><span style="font-family:Times New Roman">pim </span><span style="font-family:宋体">路由器</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">224.0.0.14rsvp </span><span style="font-family:宋体">封装</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">224.0.0.15</span><span style="font-family:宋体">所有</span><span style="font-family:Times New Roman">cbt </span><span style="font-family:宋体">路由器</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">224.0.0.16</span><span style="font-family:宋体">指定</span><span style="font-family:Times New Roman">sbm</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">224.0.0.17</span><span style="font-family:宋体">所有</span><span style="font-family:Times New Roman">sbms</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">224.0.0.18vrrp</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">224.0.0.40cisco</span><span style="font-family:宋体">路由器用于发现</span><span style="font-family:Times New Roman">auto-rp</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体"><strong>多播基本原理</strong></span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Multicast <span style="font-family:宋体">应用在一点对多点、多点对多点的网络传输中，可以大大的减少网络的负载。</span> <span style="font-family:宋体">因此，</span>Multicast <span style="font-family:宋体">广泛地应用在流媒体的传输、远程教学、视频</span>/<span style="font-family:宋体">音频会议等网络应用方面。</span> Multicast <span style="font-family:宋体">采用</span> D <span style="font-family:宋体">类</span> IP <span style="font-family:宋体">地址，即</span> 224.0.0.0~239.255.255.255<span style="font-family:宋体">。其中</span> 224.0.0.0~224.0.0.255 <span style="font-family:宋体">是保留地址，</span>239.0.0.0~239.255.255.255 <span style="font-family:宋体">是私有地址，类似于</span> unicast <span style="font-family:宋体">的私有地址。</span> Multicast<span style="font-family:宋体">的</span> IP <span style="font-family:宋体">地址与</span> MAC<span style="font-family:宋体">地址的映射：</span>MAC <span style="font-family:宋体">地址有</span> 48 <span style="font-family:宋体">位，前面</span> 24 <span style="font-family:宋体">位规定为</span> 01-00-5E<span style="font-family:宋体">，</span> <span style="font-family:宋体">接着一位为</span> 0<span style="font-family:宋体">，后面</span> 23 <span style="font-family:宋体">位是</span> IP <span style="font-family:宋体">地址的后</span> 23 <span style="font-family:宋体">位。</span> <span style="font-family:宋体">路由器间要通过组播协议（如</span> DVMRP<span style="font-family:宋体">、</span>MOSPF<span style="font-family:宋体">、</span>PIM<span style="font-family:宋体">）来建立组播树和转发组播数据</span> <span style="font-family:宋体">包。组播树有两类：源树和共享树。</span> <span style="font-family:宋体">多播时，路由器采用组管理协议</span> IGMP <span style="font-family:宋体">来管理和维护主机参与组播。</span>IGMP <span style="font-family:宋体">协议</span> v1 <span style="font-family:宋体">中，</span> <span style="font-family:宋体">主机发送</span> report <span style="font-family:宋体">包来加入组；路由器发送</span>query <span style="font-family:宋体">包来查询主机（地址是</span> 224.0.0.1<span style="font-family:宋体">），同一个</span> <span style="font-family:宋体">组的同一个子网的主机只有一台主机成员响应，其它主机成员抑制响应。一般路由器要发送</span> 3 <span style="font-family:宋体">次</span> query<span style="font-family:宋体">包，如果</span> 3 <span style="font-family:宋体">次都没响应，才认为组超时（约</span> 3 <span style="font-family:宋体">分钟）。</span>IGMPv2 <span style="font-family:宋体">中，主机可以发送</span> 1 leave <span style="font-family:宋体">信息给路由器（地址</span> 224.0.0.2<span style="font-family:宋体">）；路由器收到信息后，发送一个特别的</span> query <span style="font-family:宋体">包，在</span> 3 <span style="font-family:宋体">秒内没收到组成员响应，就认为组超时。</span> <span style="font-family:宋体">由于组播的</span> MAC <span style="font-family:宋体">不是具体某台主机的</span> MAC<span style="font-family:宋体">，根据交换机的工作原理，交换机会对组播数据包进行广播。因此，对某些不参加组播的主机而言，这些都是不必要的流。为了解决这个问题，</span>cisco <span style="font-family:宋体">公司开发了</span> CGMP <span style="font-family:宋体">协议。该协议用于管理参与组播的主机。每当有主机加入或离开某个组时，路由器就会把该主机的多播</span> IP <span style="font-family:宋体">地址（转换成组播</span> MAC <span style="font-family:宋体">地址）、主机的</span> MAC <span style="font-family:宋体">地址以及消息类型（加入或离开）以</span> CGMP <span style="font-family:宋体">消息告知交换机。交换机根据这些信息就</span> <span style="font-family:宋体">可以建立起组播转发表。</span> <span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Cisco <span style="font-family:宋体">的路由器只支持</span> PIM <span style="font-family:宋体">组播协议。</span>PIM <span style="font-family:宋体">是一种可利用多种单播路由表（如</span> EIGRP<span style="font-family:宋体">、</span> OSPF<span style="font-family:宋体">、</span>BGP <span style="font-family:宋体">和静态路由等）的组播路由协议，它根据这些路由表实现组播数据的转发。尽</span> <span style="font-family:宋体">管它是组播路由协议，然而它实际上只是使用单播路由表来完成</span> RPF <span style="font-family:宋体">检验功能，并没有重</span> <span style="font-family:宋体">新建立组播路由表。不像其他的路由协议，</span>PIM <span style="font-family:宋体">并不会在路由之间收发路由更新信息。</span> PIM<span style="font-family:宋体">分为</span>Dense-mode<span style="font-family:宋体">（</span>PIM-DM<span style="font-family:宋体">）与</span>Sparse-mode<span style="font-family:宋体">（</span>PIM-SM<span style="font-family:宋体">）两种。</span><span style="font-family:Arial"><br>            </span></span></p>
<ol>
<li><div style="background: white"><span style="color:black; font-size:10pt"><span style="font-family:宋体">密集模式的</span><span style="font-family:Arial">PIM</span><span style="font-family:宋体">（</span><span style="font-family:Arial">PIM-DM</span><span style="font-family:宋体">）使用”推”的方</span><span style="font-family:Arial"> </span><span style="font-family:宋体">式，把组播流向网络的各个地方转发，从而把流”推”给不同接收者。这种方式适用于网络</span><span style="font-family:Arial"> </span><span style="font-family:宋体">中的各个子网都有接收者（即接收者密集）的情况。</span><span style="font-family:Arial">PIM-DM</span><span style="font-family:宋体">一开始向网络中的各处发组播流，路由器每隔</span><span style="font-family:Arial">3</span><span style="font-family:宋体">分钟检查一次自己是否还存在”下游”的邻居，如果没有（即它无需转发组播流），就把这个流”剪”掉（即不再转发）。路由器会积累数据流所带有的源和组的信</span><span style="font-family:Arial"> </span><span style="font-family:宋体">息，使得”下游”的路由器可以建立它们的组播转发表。</span><span style="font-family:Arial">PIM-DM</span><span style="font-family:宋体">只支持源树，而无法使用</span><span style="font-family:Arial"> </span><span style="font-family:宋体">共享树。</span><span style="font-family:Arial"> </span><span style="font-family:宋体">密集模式工作过程：</span><span style="font-family:Arial"><br>                </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">邻居发现：使用</span><span style="font-family:Arial">hello</span><span style="font-family:宋体">数据包发现邻居并维护邻居关系，在多点访问的网络中使用</span><span style="font-family:Arial">hello</span><span style="font-family:宋体">包选举</span><span style="font-family:Arial">DR</span><span style="font-family:宋体">，</span><span style="font-family:Arial">DR</span><span style="font-family:宋体">选举依据</span><span style="font-family:Arial">IP</span><span style="font-family:宋体">地址大少比较，大的成为</span><span style="font-family:Arial">DR</span><span style="font-family:宋体">。注意</span><span style="font-family:Arial">DR</span><span style="font-family:宋体">在</span><span style="font-family:Arial">PIM-SM</span><span style="font-family:宋体">模式下才有意义</span></span><span style="font-family:Arial; font-size:10pt"><br>                </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">建立</span>SPT<span style="font-family:宋体">树：当某组播源</span>S<span style="font-family:宋体">开始向组播组</span>G<span style="font-family:宋体">发送数据时，首先根据单播路由表进行</span>RPF<span style="font-family:宋体">检查，如果通过了</span>RPF<span style="font-family:宋体">检查，则创建（</span>S<span style="font-family:宋体">，</span>G<span style="font-family:宋体">）表项，并同时产生（</span>*<span style="font-family:宋体">，</span>G<span style="font-family:宋体">）表项，然后将数据包向下游网络中的</span>PIM-DM<span style="font-family:宋体">节点进行转发。注意在</span>PIM-DM<span style="font-family:宋体">模式中使用（</span>S<span style="font-family:宋体">，</span>G<span style="font-family:宋体">）表项进行数据转发</span></span><span style="font-size:10pt"><br>                </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt">RPF<span style="font-family:宋体">检查</span>:<span style="font-family:宋体">用来确保组播数据流能够沿组播分发树（路径）正确的传输，同时可以避免转发路径上环路的产生。当路由器收到组播数据报文时，通过已有的单播路由信息判断此报文是否在最短返回源路径的接口上。如果不是，则丢弃该报文；如果是，则转发报文到接口或者路由器。</span></span><span style="font-size:10pt">缺省情况下，如果存在多条到达源的等价路<span style="font-family:宋体">由，设备在进行</span>RPF<span style="font-family:宋体">检查时，针对不同的情况会有不同的选路规则：</span></span><span style="font-size:10pt"><br>                </span></span></div>

<p><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">如果这几条等价路由都是来自同一张路由表项，比如单播路由表、组播静态路由表或者</span>MBGP<span style="font-family:宋体">路由表中的一种，则选取下一跳地址最大的路由作为</span>RPF<span style="font-family:宋体">路由。</span></span><span style="font-size:10pt"></span></span></p>
<pre><code>            &lt;/span&gt;&lt;/span&gt;
</code></pre></li>
</ol>
<p><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">如果这几条等价路由来自不同的路由表，首先会比较路由优先级，再比较掩码长度。如果上述都相同，则设备会根据一定的函数计算选取出一条路由作为</span>RPF<span style="font-family:宋体">路由。</span> </span><span style="font-size:10pt"><span style="font-family:宋体">无论上述何种情况，根据</span>RPF<span style="font-family:宋体">检查规则，设备只会选取一条路由作为</span>RPF<span style="font-family:宋体">路由。但是如果配置了组播负载分担之后，当存在多条等价的最优路由时，组播数据将不会按照RPF检查规则只选一条路由作为RPF路由进行转发，而是在这多条路径上按照一定的策略进行分流转发。这样，在一定程度上优化了组播数据在网络上的传输质量<span style="color:#333333">。</span></span></span><span style="color:black; font-size:10pt"><br>                    </span></span></p>
<ol>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">剪枝：当没有接收者的叶节点的路由器向着组播组地址</span>224.0.0.13<span style="font-family:宋体">发送</span>prune<span style="font-family:宋体">消息时进行剪枝。有接收者的叶节点路由器保留</span>SPT<span style="font-family:宋体">，保留接口为转发状态。被</span>prune<span style="font-family:宋体">剪掉的接口处于</span>prune<span style="font-family:宋体">状态，并保持三分钟，超出三分钟后又会变成转发状态。注意</span>prune<span style="font-family:宋体">消息是不可靠的，不会收到回复。</span></span><span style="font-size:10pt"><br>                </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">当处于</span>prune<span style="font-family:宋体">状态的路由器下游接入了接收者，此时接收者通过</span>IGMP<span style="font-family:宋体">协议向最后一跳路由器发送</span>report<span style="font-family:宋体">消息，最后一跳路由器马上向上一级邻居路由器发送单播的</span>Graft<span style="font-family:宋体">消息，并且收到上一级邻居路由器的</span>Graft ACK<span style="font-family:宋体">确认消息。这样一直发送到根，此时路由器的</span>prune<span style="font-family:宋体">接口变为</span>forward<span style="font-family:宋体">状态</span>. <span style="font-family:宋体">注意</span>graft<span style="font-family:宋体">消息是可靠的机制，必须要收到</span>Graft ACK<span style="font-family:宋体">，如果没有收到默认</span>3s<span style="font-family:宋体">重发。</span></span><span style="font-size:10pt"><br>                </span></span></div>
</li>
<li><div style="background: white"><span style="color:black; font-size:10pt"><span style="font-family:宋体">松散模式的</span><span style="font-family:Arial">PIM</span><span style="font-family:宋体">（</span><span style="font-family:Arial">PIM-SM</span><span style="font-family:宋体">）使用”拉”的方式，只有存在接收者的网段才会接收到数据流（即接收者把流”拉”出来）。主要用于组成员分布相对分散、范围较广、大规模网络中。松散模式默认所有主机不需要接收组播包，只向明确需要组播包的主机转发。</span><span style="font-family:Arial">PIM-SM</span><span style="font-family:宋体">模型实现转发的核心任务是构造并维护一颗单向共享树，共享树选择</span><span style="font-family:Arial">PIM</span><span style="font-family:宋体">中某一个路由器作为公用根节点，即汇聚点</span><span style="font-family:Arial">RP</span><span style="font-family:宋体">（</span><span style="font-family:Arial">Rendesvous Point</span><span style="font-family:宋体">）。组播数据通过</span><span style="font-family:Arial">RP</span><span style="font-family:宋体">沿共享树向接受者转发。引入</span><span style="font-family:Arial">RP</span><span style="font-family:宋体">进行组播转发，减少数据报文和控制报文占用的网络带宽，降低路由器的处理开销。在接收的一方，链接信息接收者的路由器向该组播组对应的</span><span style="font-family:Arial">RP</span><span style="font-family:宋体">发送组加入信息，加入消息经过一个个路由器后到达根部（即汇聚点），所经过的路径变成了此共享树的</span><span style="font-family:Arial">RPT</span><span style="font-family:宋体">分支，发送端如果想要往某组播组发送数据包，首先由第一跳路由器向</span><span style="font-family:Arial">RP</span><span style="font-family:宋体">汇聚点注册，注册消息到达</span><span style="font-family:Arial">RP</span><span style="font-family:宋体">后触发源树建立，之后组播源把数据发向</span><span style="font-family:Arial">RP</span><span style="font-family:宋体">汇聚点，当数据到达</span><span style="font-family:Arial">RP</span><span style="font-family:宋体">汇聚点后，组播数据包被复制并沿着</span><span style="font-family:Arial">RPT</span><span style="font-family:宋体">树传给接受者。复制仅仅发生在分法树的分支处，这个过程能自动重复直到数据包最终到达接收者。</span><span style="font-family:Arial">PIM-SM</span><span style="font-family:宋体">的工作过程</span><span style="font-family:Arial">:</span><span style="font-family:宋体">邻居发现，</span><span style="font-family:Arial">DR</span><span style="font-family:宋体">选举、</span><span style="font-family:Arial">RP</span><span style="font-family:宋体">发现、</span><span style="font-family:Arial">RPT</span><span style="font-family:宋体">共享树生成、组播源注册、</span><span style="font-family:Arial">RPT</span><span style="font-family:宋体">向</span><span style="font-family:Arial">SPT</span><span style="font-family:宋体">切换。</span><span style="font-family:Arial"><br>                </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">邻居发现：通过各路由器之间发送</span><span style="font-family:Arial">hello</span><span style="font-family:宋体">包实现的</span></span><span style="font-family:Arial; font-size:10pt"><br>                </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt">DR<span style="font-family:宋体">选举：借助</span>hello<span style="font-family:宋体">消息可以为共享网络（如以太网）选举</span>DR<span style="font-family:宋体">，</span>DR<span style="font-family:宋体">作为本网段中的组播信息唯一转发者。无论是和组播源链接的网络，还是和接收者链接的网络，只要网络为共享媒介则需要选举</span>DR<span style="font-family:宋体">。接收者一方的</span>DR<span style="font-family:宋体">发送</span>Join<span style="font-family:宋体">加入信息到</span>RP<span style="font-family:宋体">，组播源一方的</span>DR<span style="font-family:宋体">向</span>RP<span style="font-family:宋体">发送</span>Register<span style="font-family:宋体">注册信息。</span>Hello<span style="font-family:宋体">消息携带</span>DR<span style="font-family:宋体">优先级选项，拥有高优先级的被选为本网段的</span>DR<span style="font-family:宋体">。假如不支持在</span>Hello<span style="font-family:宋体">包中携带优先级，则拥有最大</span>IP<span style="font-family:宋体">地址的路由器被选举为</span>DR<span style="font-family:宋体">，当</span>DR<span style="font-family:宋体">出现故障时，接受</span>Hello<span style="font-family:宋体">消息将会超时，邻居路由器之间触发新的</span>DR<span style="font-family:宋体">选举。</span></span><span style="font-size:10pt"><br>                </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt">RP<span style="font-family:宋体">发现：</span>RP<span style="font-family:宋体">是</span>PIM-SM<span style="font-family:宋体">域中心的核心路由器，全网的信息转发都依靠它。此时</span>RP<span style="font-family:宋体">就是工作量最大，发负载最大的，为了缓解</span>RP<span style="font-family:宋体">的压力，就需要自举机制来选举</span>RP<span style="font-family:宋体">，此时需要配置自举路由器</span>BSR<span style="font-family:宋体">（</span>Bootstrap Router<span style="font-family:宋体">），</span>BSR<span style="font-family:宋体">是</span>PIM-SM<span style="font-family:宋体">网络的管理核心，负责收集网络中的</span>Candidate-RP<span style="font-family:宋体">（</span>C-RP<span style="font-family:宋体">）发来的</span>Advertisment<span style="font-family:宋体">宣告信息，然后将为每个组播组选择部分</span>C-RP<span style="font-family:宋体">信息以组成</span>RP-Set<span style="font-family:宋体">集</span>(<span style="font-family:宋体">即组播组和</span>RP<span style="font-family:宋体">的映射库</span>),<span style="font-family:宋体">并发布到整个</span>PIM-SM<span style="font-family:宋体">网络，从而网络内所有的路由器都知道</span>RP<span style="font-family:宋体">和</span>BSR<span style="font-family:宋体">位置。一个网络的内部只能选举出一个</span>BSR<span style="font-family:宋体">，但可以配置多个</span>Candidate-BSR<span style="font-family:宋体">（</span>C-BSR<span style="font-family:宋体">），这样一旦</span>BSR<span style="font-family:宋体">发生故障，其余</span>C-BSR<span style="font-family:宋体">能够自动选举出新的</span>BSR<span style="font-family:宋体">。同样一个</span>PIM-SM<span style="font-family:宋体">域内可以有多个</span>C-RP<span style="font-family:宋体">，由</span>BSR<span style="font-family:宋体">机制计算出每个组播组对应的</span>RP<span style="font-family:宋体">。</span></span><span style="font-size:10pt"><br>               </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt">RPT<span style="font-family:宋体">生成：当接收者路由一端向</span>RP<span style="font-family:宋体">发送</span>jion<span style="font-family:宋体">加入信息所经过的每一个路由节点时，都会向转发表中加入（</span><em>,G<span style="font-family:宋体">）表项，这些沿途经过的路由器就形成了</span>RP<span style="font-family:宋体">的共享树（</span>RPT<span style="font-family:宋体">）的一个分支。其中（</span></em><span style="font-family:宋体">，</span>G<span style="font-family:宋体">）表示从任意源来的消息去往组播组</span>G<span style="font-family:宋体">。</span>RPT<span style="font-family:宋体">共享树以</span>RP<span style="font-family:宋体">为根，接收者为叶子。当从组播源发往组播组</span>G<span style="font-family:宋体">的报文流经</span>RP<span style="font-family:宋体">时，报文就会沿着已经建立好的</span>RPT<span style="font-family:宋体">共享树路径到达叶子路由器，进而到达接受者。当某个接受者退出组播组</span>G<span style="font-family:宋体">时，接收者一方的</span>DR<span style="font-family:宋体">会逆着</span>RPT<span style="font-family:宋体">树，朝</span>RP<span style="font-family:宋体">方向逐跳发送</span>Prune<span style="font-family:宋体">剪枝消息。第一个上游路由器接收到该剪枝消息，在其出接口列表中删除链接此下游路由器的接口，并检查下游是否还存在组播组</span>G<span style="font-family:宋体">成员，如果没有则继续向上游转发该剪枝消息。</span></span><span style="font-size:10pt"><br>               </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">组播源注册：为了向</span>RP<span style="font-family:宋体">通知组播源</span>S<span style="font-family:宋体">的存在，当组播源</span>S<span style="font-family:宋体">向组播组</span>G<span style="font-family:宋体">发送的一个组播组报文时，与组播源</span>S<span style="font-family:宋体">直接相连的路由器收到该报文后，就将该报文封装成</span>Register<span style="font-family:宋体">注册报文，并单播发送给对应的</span>RP<span style="font-family:宋体">。当</span>RP<span style="font-family:宋体">收到来自组播组的注册消息后，一方面解除封装注册消息并将组播消息沿着</span>RPT<span style="font-family:宋体">树发到接收者，另一方面朝组播源逐跳发送（</span>S<span style="font-family:宋体">，</span>G<span style="font-family:宋体">）加入消息，从而让</span>RP<span style="font-family:宋体">和组播组</span>S<span style="font-family:宋体">之间的所有路由器都生成（</span>S<span style="font-family:宋体">，</span>G<span style="font-family:宋体">）表项，这些沿途经过的路由就形成了</span>SPT<span style="font-family:宋体">树的一个根，以</span>RP<span style="font-family:宋体">为目的地。组播源</span>S<span style="font-family:宋体">发出的组播信息沿着已经建立好的</span>SPT<span style="font-family:宋体">树到达</span>RP<span style="font-family:宋体">，然后由</span>RP<span style="font-family:宋体">将信息沿着</span>RPT<span style="font-family:宋体">共享树进行转发。当</span>RP<span style="font-family:宋体">收到沿着</span>SPT<span style="font-family:宋体">树转发的组播流量后，向从与组播源的</span>S<span style="font-family:宋体">直连路由器的单播发送注册停止报文。组播源注册过程结束。</span></span><span style="font-size:10pt"><br>               </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt">RPT<span style="font-family:宋体">向</span>SPT<span style="font-family:宋体">切换：</span>PIM-SM<span style="font-family:宋体">通过指定一个利用带宽的</span>SPT<span style="font-family:宋体">阈值可以实现将最后一跳路由器（即离接收者近的</span>DR<span style="font-family:宋体">）从</span>RPT<span style="font-family:宋体">切换为</span>SPT<span style="font-family:宋体">。当最后一跳路由器发现从</span>RP<span style="font-family:宋体">发往组播组</span>G<span style="font-family:宋体">的组播报文速率超过了阈值时，就向单播路由器表中到组播源</span>S<span style="font-family:宋体">的下一跳路由器发送（</span>S<span style="font-family:宋体">，</span>G<span style="font-family:宋体">）加入消息，加入消息经过一个个路由器后到达第一跳路由器（即离组播源最近的</span>DR<span style="font-family:宋体">），沿途经过的所有路由器都拥有了（</span>S<span style="font-family:宋体">，</span>G<span style="font-family:宋体">）表项，从而建立</span>SPT<span style="font-family:宋体">树分支。随后，最后一跳路由器向</span>RP<span style="font-family:宋体">逐跳发送包含</span>RP<span style="font-family:宋体">为的</span>Prune<span style="font-family:宋体">剪枝消息，</span>RP<span style="font-family:宋体">收到消息后向组播源反向转发</span>Prune<span style="font-family:宋体">剪枝消息。从而实现组播信息流从</span>RPT<span style="font-family:宋体">切换到</span>SPT<span style="font-family:宋体">。切换到</span>SPT<span style="font-family:宋体">后，组播源</span>S<span style="font-family:宋体">直接发送信息到接收者。</span></span><span style="font-size:10pt"><br>               </span></span></div>
</li>
<li><div style="background: white"><span style="color:black"><span style="font-family:宋体; font-size:10pt">组播和单播的区别</span><span style="font-size:9pt"><span style="font-family:Arial">: </span><span style="font-family:宋体">为了让网络中的多个主机可以同时接受到相同的报文，如果采用单播的方式，那么源主机必须不停的产生多个相同的报文来进行发送，对于一些对时延很敏感的数据，在源主机要产生多个相同的数据报文后，在产生第二个数据报文，这通常是无法容忍的。而且对于。一台主机来说，同时不停的产生一个报文来说也是一个很大的负担。如果采用组播的方式，源主机可以只需要发送一个报文就可以到达每个需要接受的主机上，这中间还要取决于路由器对组员和组关系的维护和选择。</span></span><span style="font-family:Arial; font-size:10pt"><br>               </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:10pt"><span style="font-family:宋体">组播和广播的区别</span>:</span><span style="font-family:宋体; font-size:9pt">当有多台主机想要接收相同的报文，广播采用的方式是把报文传送到局域网内每个主机上，不管这个主机是否对报文感兴趣。这样做就会造成了带宽的浪费和主机的资源浪费。而组播有一套对组员和组之间关系维护的机制，可以明确的知道在某个子网中，是否有主机对这类组播报文感兴趣，如果没有就不会把报文进行转发，并会通知上游路由器不要再转发这类报文到下游路由器上。</span><span style="font-size:10pt"><br>               </span></span></div></li>
<li><div style="background: white"><span style="color:black; font-size:10pt"><span style="font-family:宋体">组播的优点：</span><br>           </span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-family:宋体; font-size:9pt">需要相同数据流的客户端加入相同的组共享一条数据流，节省了服务器的负载。具备广播所具备的优点。</span><span style="font-family:Arial; font-size:10pt"><br>               </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">由于组播协议是根据接受者的需要对数据流进行复制转发，所以服务端的服务总带宽不受客户接入端带宽的限制。</span>IP<span style="font-family:宋体">协议允许有</span>2<span style="font-family:宋体">亿</span>6<span style="font-family:宋体">千多万个组播，所以其提供的服务可以非常丰富。</span></span><span style="font-size:10pt"><br>               </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">此协议和单播协议一样允许在</span>Internet<span style="font-family:宋体">宽带网上传输。</span></span><span style="font-size:10pt"><br>               </span></span></div></li>
<li><div style="background: white"><span style="color:black; font-size:10pt"><span style="font-family:宋体">组播的缺点：</span><span style="font-family:Arial"><br>               </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">与单播协议相比没有纠错机制，发生丢包错包后难以弥补，但可以通过一定的容错机制和</span><span style="font-family:Arial">QOS</span><span style="font-family:宋体">加以弥补。</span></span><span style="font-family:Arial; font-size:10pt"><br>               </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">现行网络虽然都支持组播的传输，但在客户认证、</span><span style="font-family:Times New Roman">QOS</span><span style="font-family:宋体">等方面还需要完善，这些缺点在理论上都有成熟的解决方案，只是需要逐步推广应用到现存网络当中。</span></span><span style="font-family:Times New Roman; font-size:10pt"><br>               </span></span></div>

</li>
</ol>
<p><span style="color:black"><span style="font-size:12pt"><strong><span style="font-family:宋体">实验一、组播中的</span>IGMP</strong></span><span style="font-family:Arial; font-size:10pt"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> <img src="http://www.madhex.com/wp-content/uploads/2016/05/051016_0624_CCNP1.jpg" alt=""><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC1<span style="font-family:宋体">配置</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Router&gt;en<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Router#conf t<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC2(config)#no ip routing //<span style="font-family:宋体">禁止路由功能，让路由器作为主机</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Router#hostname PC1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC1(config)#ip default-gateway192.168.1.1 //<span style="font-family:宋体">指定网关</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC1(config)#int fa0/0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC1(config-if)#ip add 192.168.1.3255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC1(config-if)#ip igmp join-group224.1.1.1 //<span style="font-family:宋体">利用</span>IGMP<span style="font-family:宋体">协议指定加入组播组的地址</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC1(config-if)#no sh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC1(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC2<span style="font-family:宋体">配置：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Router&gt;en<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Router#conf t<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Router(config)#hostname PC2<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC2(config)#no ip routing<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC2(config)#ip default-gateway192.168.1.1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC2(config)#int fa0/0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC2(config-if)#ip add 192.168.1.2255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC2(config-if)#ip igmp join-group224.1.1.1 <span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC2(config-if)#no sh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC2(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC3<span style="font-family:宋体">配置：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Router&gt;en<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Router#conf t<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Router(config)#hostname PC3<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC3(config)#no ip routing<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC3(config)#ip default-gateway192.168.1.1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC3(config)#int fa0/0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC3(config-if)#ip add 192.168.1.4 255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC3(config-if)#ip igmp join-group224.1.1.1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC3(config-if)#no sh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC3(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">SW<span style="font-family:宋体">配置：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4<span style="font-family:宋体">配置：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Router&gt;en<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Router#conf t<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Router(config)#hostname R4<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#ip multicast-routing //<span style="font-family:宋体">开启组播路由协议</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#int fa0/0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip add 192.168.1.1255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip pim sparse-mode //<span style="font-family:宋体">端口下指定组播路由协议的模式为密集型</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#no sh  <span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5<span style="font-family:宋体">配置</span>:<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Router&gt;en<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Router#conf t<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Router(config)#hostname R5<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#ip multicast-routing<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#int fa0/0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#ip add 192.168.1.5255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#ip pim sparse-mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#no sh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">第一完成配置后查看，主机是否加入了组播组，路由器是否正常</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4#sh ip igmp groups   <span style="color:red"> //R4<span style="font-family:宋体">查看组播组</span><span style="color:black; font-family:Arial"><br>                </span></span></span></p>
<p><span style="color:black; font-size:10pt">IGMP Connected Group Membership<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Group Address    Interface                Uptime    Expires  Last Reporter   Group Accounted<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">224.1.1.1        FastEthernet0/0          00:02:06  00:02:51 192.168.1.3 <span style="color:black">    <span style="font-family:Arial"><br>                </span></span></span></p>
<p><span style="color:black; font-size:10pt">224.0.1.40       FastEthernet0/0          00:14:31  00:02:52 192.168.1.5    <span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4#sh ip igmp interface <span style="color:red"> //<span style="font-family:宋体">查看谁是查询器，谁是</span>DR<span style="font-family:宋体">。</span>IP<span style="font-family:宋体">地址小的成为</span>DR<span style="color:black; font-family:Arial"><br>                </span></span></span></p>
<p><span style="color:black; font-size:10pt">FastEthernet0/0 is up, line protocol isup<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> Internet address is 192.168.1.1/24<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> IGMP is enabled on interface<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> Current IGMP host version is 2<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">  <span style="color:red">Current IGMP router version is 2<span style="color:black; font-family:Arial"><br>                </span></span></span></p>
<p><span style="color:red; font-size:10pt">  IGMP query interval is 60 seconds<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">  IGMP querier timeout is 120 seconds<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">  IGMP max query response time is 10 seconds<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">  Last member query count is 2<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> Last member query response interval is 1000 ms<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> Inbound IGMP access group is not set<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> IGMP activity: 2 joins, 0 leaves<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> Multicast routing is enabled on interface<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> Multicast TTL threshold is 0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> <span style="color:red"> Multicast designatedrouter (DR) is 192.168.1.5   //R5<span style="font-family:宋体">是</span>D5<span style="color:black; font-family:Arial"><br>                </span></span></span></p>
<p><span style="color:red; font-size:10pt">  IGMP querying routeris 192.168.1.1 (this system)     //R4<span style="font-family:宋体">是查询器发送查询报文</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> Multicast groups joined by this system (number of users):<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">     224.0.1.40(1)<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4#debug ip igmp<span style="color:red">//<span style="font-family:宋体">调试</span>IGMP<span style="font-family:宋体">报文</span><span style="color:black; font-family:Arial"><br>                </span></span></span></p>
<p><span style="color:black; font-size:10pt">IGMP debugging is on<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">*Mar  1 00:22:00.683: IGMP(0): Send v2 generalQuery on FastEthernet0/0 // <span style="font-family:宋体">发送查询报文</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:22:00.683: IGMP(0): Set report delay time to 9.8 seconds for224.0.1.40 on FastEthernet0/0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">*Mar  1 00:22:03.663: IGMP(0): Received v2 Reporton FastEthernet0/0 from 192.168.1.3 for 224.1.1.1 //<span style="font-family:宋体">主机发送加入组播组的报文</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:22:03.667: IGMP(0): Received Group record for group 224.1.1.1, mode2 from 192.168.1.3 for 0 sources<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:#171717; font-size:10pt">*Mar  100:22:03.667: IGMP(0): Updating EXCLUDE group timer for 224.1.1.1<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><em>Mar 1 00:22:03.671: IGMP(0): MRT Add/Update FastEthernet0/0 for(</em>,224.1.1.1) by 0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:22:09.403: IGMP(0): Received v2 Report on FastEthernet0/0 from192.168.1.5 for 224.0.1.40<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:22:09.403: IGMP(0): Received Group record for group 224.0.1.40,mode 2 from 192.168.1.5 for 0 sources<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:22:09.403: IGMP(0): Cancel report for 224.0.1.40 on FastEthernet0/0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:22:09.403: IGMP(0): Updating EXCLUDE group timer for 224.0.1.40<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><em>Mar 1 00:22:09.403: IGMP(0): MRT Add/Update FastEthernet0/0 for(</em>,224.0.1.40) by 0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">第二先把</span>PC3<span style="font-family:宋体">离开组播组，观察</span>R4<span style="font-family:宋体">变化</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC3#conf t<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC3(config)#int fa0/0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC3(config-if)#no ip igmp join-group224.1.1.1 //PC3<span style="font-family:宋体">离开组播组</span>224.1.1.1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4#conf t<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4#debug ip igmp //<span style="font-family:宋体">调试</span>R4<span style="font-family:宋体">的</span>IGMP<span style="font-family:宋体">包</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">IGMP debugging is on<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">*Mar  1 01:27:24.091: IGMP(0): Received Leave from192.168.1.4 (FastEthernet0/0) for 224.1.1.1//PC3<span style="font-family:宋体">发给</span>R4<span style="font-family:宋体">离开组播组的报文</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 01:27:24.095: IGMP(0): Received Group record for group 224.1.1.1, mode3 from 192.168.1.4 for 0 sources<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">*Mar  1 01:27:24.095: IGMP(0): Lower expirationtimer to 2000 msec for 224.1.1.1 on FastEthernet0/0//<span style="color:#464646"><span style="font-family:宋体">将组播组</span><span style="font-family:Times New Roman">224.1.1.1</span><span style="font-family:宋体">的超时时间设置为</span><span style="font-family:Times New Roman">2000msec</span><span style="font-family:宋体">，</span><span style="color:black; font-family:Arial"><br>                </span></span></span></p>
<p><span style="color:red; font-size:10pt"> <span style="color:#c00000">*Mar  1 01:27:24.095: IGMP(0): Send v2 Query onFastEthernet0/0 for group 224.1.1.1<span style="color:black; font-family:Arial"><br>                </span></span></span></p>
<p><span style="color:#c00000; font-size:10pt">*Mar  1 01:27:25.099: IGMP(0): Send v2 Query onFastEthernet0/0 for group 224.1.1.1<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:#c00000; font-size:10pt">*Mar  1 01:27:26.099: IGMP(0): Switching to INCLUDEmode for 224.1.1.1 on FastEthernet0/0<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">//R4<span style="color:#464646"><span style="font-family:宋体">连续发了两个特定组查询消息（</span><span style="font-family:Times New Roman">Group-Specific Query</span><span style="font-family:宋体">），试图通过这种方式确认</span><span style="font-family:Times New Roman">224.1.1.1</span><span style="font-family:宋体">组中是否有其他组员了，并且将组播组转换到收录模式</span><span style="color:black; font-family:Arial"><br>                </span></span></span></p>
<p><span style="color:#0070c0; font-size:10pt">*Mar  1 01:27:26.575: IGMP(0): Received v2 Reporton FastEthernet0/0 from 192.168.1.3 for 224.1.1.1<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:#0070c0; font-size:10pt">*Mar  1 01:27:26.575: IGMP(0): Received Grouprecord for group 224.1.1.1, mode 2 from 192.168.1.3 for 0 sources<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:#0070c0; font-size:10pt">*Mar  1 01:27:26.579: IGMP(0): WAVL Insert group:224.1.1.1 interface: FastEthernet0/0Successful<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:#0070c0; font-size:10pt">*Mar  1 01:27:26.579: IGMP(0): Switching to EXCLUDEmode for 224.1.1.1 on FastEthernet0/0<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:#0070c0; font-size:10pt">*Mar  1 01:27:26.583: IGMP(0): Updating EXCLUDEgroup timer for 224.1.1.1<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:#0070c0; font-size:10pt"><em>Mar  1 01:27:26.583: IGMP(0): MRT Add/UpdateFastEthernet0/0 for (</em>,224.1.1.1) by 0<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:#0070c0; font-size:10pt">//<span style="font-family:宋体">一个成员回复了查询以便通告自己的存在。</span><span style="font-family:Times New Roman">R4</span><span style="font-family:宋体">知道组</span><span style="font-family:Times New Roman">224.1.1.1</span><span style="font-family:宋体">里仍有组成员存在，马上回复组播组到正常状态。</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">第三</span><span style="font-family:Times New Roman">IGMPSnooping</span><span style="font-family:宋体">限制交换机网络中多播的流量。对交换机的工作模式是它会学习接收到的所有帧的源</span>MAC<span style="font-family:宋体">地址，并存入交换机的</span>MAC<span style="font-family:宋体">地址表，而多播</span>MAC<span style="font-family:宋体">地址永远不会作为一个数据包的源</span>MAC<span style="font-family:宋体">地址（一般都是作为目的</span>MAC<span style="font-family:宋体">地址）所以交换机永远不会将多播</span>MAC<span style="font-family:宋体">地址存入</span>MAC<span style="font-family:宋体">地址表中，所以，每次收到的多播流量都会以泛洪的形式发送出去。由于默认情况下，局域网交换机会在广播域中泛洪多播流量，这会消耗大量的带宽。</span>Cisco Group Management Protocol (<strong>CGMP</strong>)<span style="font-family:宋体">和</span> Internet GroupManagement Protocol (<strong>IGMP</strong>) <strong>snooping </strong><span style="font-family:宋体">主要是用来限制交换机网络中多播的流量。</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">解决交换机的带宽问题有</span>3<span style="font-family:宋体">种方法：</span><span style="font-family:Arial"><br>            </span></span></p>
<ol>
<li><div style="background: white"><span style="color:black; font-size:10pt"><span style="font-family:宋体">在交换机上配置静态的多播</span><span style="font-family:Arial">MAC</span><span style="font-family:宋体">地址到用户接口的映射</span><span style="font-family:Arial"><br>                </span></span></div></li>
<li><div style="background: white"><span style="color:black; font-size:10pt"><span style="font-family:宋体">使用</span>CGMP<span style="font-family:宋体">，运行</span>CGMP<span style="font-family:宋体">的多播路由器能够将用户发送给自己的</span>IGMP<span style="font-family:宋体">报文再通知给交换机</span><br>            </span></div></li>
<li><div style="background: white"><span style="color:black; font-size:10pt"><span style="font-family:宋体">使用</span>IGMPSnooping<span style="font-family:宋体">，在这种模式下交换机会自己截取客户发送的</span>IGMP<span style="font-family:宋体">消息，并根据</span>IGMP<span style="font-family:宋体">消息更新自己的</span>MAC<span style="font-family:宋体">地址表</span><br>            </span></div></li>
<li><div style="background: white"><span style="color:black; font-size:10pt"><span style="font-family:宋体">使用</span>IGMPproxy<span style="font-family:宋体">的二层网络设备，对用户侧承担</span>Server<span style="font-family:宋体">的角色，定期查询用户信息，对于网络路由侧又承担</span>Client<span style="font-family:宋体">的角色，在需要时将当前的用户信息发送给网络</span>.<span style="font-family:宋体">不仅能够达到抑制二层组播泛滥的目的更能有效地获取和控制用户信息</span>,<span style="font-family:宋体">同时在减少网络侧协议消息以降低网络负荷方面起到一定作用<span style="color:#333333">。</span></span><span style="color:black"><br>                </span></span></div>

</li>
</ol>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">IGMP</span><span style="font-family:宋体">运行于主机和与主机直连的路由器之间，其实现的功能是双向的：一方面，主机通过</span><span style="font-family:Times New Roman">IGMP</span><span style="font-family:宋体">通知路由器希望接收某个特定组播组的信息；另一方面，路由器通过</span><span style="font-family:Times New Roman">IGMP</span><span style="font-family:宋体">周期性地查询局域网内的组播组成员是否处于活动状态，实现所连网段组成员关系的收集与维护。总之：</span><span style="font-family:Times New Roman">IGMP</span><span style="font-family:宋体">是</span><span style="font-family:Times New Roman">TCP/IP</span><span style="font-family:宋体">协议族中负责</span><span style="font-family:Times New Roman">IP</span><span style="font-family:宋体">组播组成员管理的协议，用来在</span><span style="font-family:Times New Roman">IP</span><span style="font-family:宋体">主机和与其直接相邻的组播路由器之间建立、维护组播组成员关系。</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">IGMP Snooping</span><span style="font-family:宋体">是运行在二层设备上的组播约束机制，用于管理和控制组播组。运行</span><span style="font-family:Times New Roman">IGMP Snooping</span><span style="font-family:宋体">的二层设备通过对收到的</span><span style="font-family:Times New Roman">IGMP</span><span style="font-family:宋体">报文进行分析，为二层端口和组播</span><span style="font-family:Times New Roman">MAC</span><span style="font-family:宋体">地址建立起映射关系，并根据这个映射关系转发组播数据。</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">在传统的组播点播方式下，当连接在二层设备上、属于不同</span><span style="font-family:Times New Roman">VLAN</span><span style="font-family:宋体">的用户分别进行组播点播时，三层组播设备需要向该二层设备的每个</span><span style="font-family:Times New Roman">VLAN</span><span style="font-family:宋体">分别发送一份组播数据；而当二层设备运行了组播</span><span style="font-family:Times New Roman">VLAN</span><span style="font-family:宋体">之后，三层组播设备只需向该二层设备的组播</span><span style="font-family:Times New Roman">VLAN</span><span style="font-family:宋体">发送一份组播数据即可，从而既避免了带宽的浪费，也减轻了三层组播设备的负担。</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black"><span style="font-size:14pt"><strong><span style="font-family:宋体">实验二、组播的</span>PIM-DM<span style="font-family:宋体">模式</span>(Dense-mode)</strong></span><span style="font-family:Arial; font-size:10pt"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> <img src="http://www.madhex.com/wp-content/uploads/2016/05/051016_0624_CCNP2.jpg" alt=""><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Server<span style="font-family:宋体">配置：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Server#conf t<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Server(config)#no ip routing<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Server(config)#ip default-gateway 192.168.5.1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Server(config)#int e0/0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Server(config-if)#ip add 192.168.5.2255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Server(config-if)#no sh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Server(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5<span style="font-family:宋体">配置：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5#conf t<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#ip multicast-routing<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#int e0/0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#ip add 12.168.5.1 255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#ippim dense-mode                               <span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#no sh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#int e0/1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#ip add 192.168.51.5255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">tR5(config-if)#ip pim dense-mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#no sh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#int e0/2<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#ip add 192.168.52.5255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#ip pim dense-mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#no sh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#router ospf 1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config-router)#net 0.0.0.0 0.0.0.0 area 0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config-router)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R1<span style="font-family:宋体">配置：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R1#conf t<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#ip multicast-routing<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#int e0/0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip add 192.168.51.1255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip pim dens<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip pim dense-mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#no sh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#int e0/1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip add 192.168.13.1255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip pim den<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip pim dense-mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#no sh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#router ospf 1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R1(config-router)#net 0.0.0.0 0.0.0.0 area 0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R1(config-router)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2<span style="font-family:宋体">配置：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2#conf t<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#ip multicast-routing<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#int e0/0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ip add 192.168.52.2255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ip pim den<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ip pim dense-mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#no sh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#int e0/1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ip add 192.168.24.2255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ip pim dense-mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#no sh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#router ospf 1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config-router)#net 0.0.0.0 0.0.0.0 area 0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config-router)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3<span style="font-family:宋体">配置：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3#conf t<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#ip multicast-routing<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#int e0/1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip add 192.168.13.3255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip pim dense-mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#no sh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#int e0/0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip add 192.168.0.1255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip pim dense-mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#no sh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#router ospf 1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#net 0.0.0.0 0.0.0.0 area 0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">配置</span>R4<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4#conf t<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#ip multicast-routing<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#int e0/0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip add 192.168.0.2255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip pim dense-mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#no sh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#int e0/1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip add 192.168.24.4255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip pim den<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip pim dense-mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#no sh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#int e0/2<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip add 192.168.46.4255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip pim dense-mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#no sh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#router ospf 1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-router)#net 0.0.0.0 0.0.0.0 area 0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-router)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">配置</span>R6<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6#conf t<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config)#ip multicast-routing<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config)#int e0/0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config-if)#ip add 192.168.46.6255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config-if)#ip pim dense-mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config-if)#no sh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config)#router ospf 1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config-router)#net 0.0.0.0 0.0.0.0 area 0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config-router)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC1<span style="font-family:宋体">配置：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC1#conf t<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC1(config)#no ip routing<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC1(config)#ip default-gateway 192.168.0.1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC1(config)#int e0/0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC1(config-if)#ip add 192.168.0.5255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC1(config-if)#ip igmp join-group 224.1.1.1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC1(config-if)#no sh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC1(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">完成以上配置后：所有路由器的多播路由表如下：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2#sh ip mroute<strong> //PIM-DM</strong><span style="color:#333333"><span style="font-family:微软雅黑">需要有组播流才形成树</span><span style="color:black; font-family:Arial"><br>                </span></span></span></p>
<p><span style="color:black; font-size:10pt">IP Multicast Routing Table<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Flags: D - Dense, S - Sparse, B - BidirGroup, s - SSM Group, C - Connected,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">      L - Local, P - Pruned, R - RP-bit set, F - Register flag,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">      T - SPT-bit set, J - Join SPT, M - MSDP created entry,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       X - Proxy Join Timer Running, A - Candidatefor MSDP Advertisement,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">      U - URD, I - Received Source Specific Host Report,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">      Z - Multicast Tunnel, z - MDT-data group sender,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">      Y - Joined MDT-data group, y - Sending to MDT-data group<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Outgoing interface flags: H - Hardwareswitched, A - Assert winner<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> Timers: Uptime/Expires<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> Interface state: Interface, Next-Hop or VCD,State/Mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">(*, 224.0.1.40), 00:33:39/00:02:51, RP0.0.0.0, flags: DCL<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> Incoming interface: Null, RPF nbr 0.0.0.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">  Outgoinginterface list:<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">   Ethernet0/1, Forward/Dense, 00:27:46/00:00:00<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">   Ethernet0/0, Forward/Dense, 00:33:39/00:00:00<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">接着在</span>Server<span style="font-family:宋体">端</span>Ping 224.1.1.1  <span style="font-family:宋体">组播组，发现变化</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Server#ping224.1.1.1 repeat 100 <span style="color:red">//<span style="font-family:宋体">注意有了组播源才有路，</span>ping<span style="font-family:宋体">结束后路也消失</span><span style="color:black; font-family:Arial"><br>                </span></span></span></p>
<p><span style="color:black; font-size:10pt">Type escapesequence to abort.<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Sending 100,100-byte ICMP Echos to 224.1.1.1, timeout is 2 seconds:<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">………………………………………<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Reply torequest 45 from 192.168.0.5, 264 ms<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Reply torequest 46 from 192.168.0.5, 248 ms<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Reply torequest 47 from 192.168.0.5, 204 ms<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R1#sh ipmroute //<span style="color:red">R1<span style="font-family:宋体">没有</span>SPT<span style="color:black; font-family:Arial"><br>                </span></span></span></p>
<p><span style="color:black; font-size:10pt">IP MulticastRouting Table<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Flags: D -Dense, S - Sparse, B - Bidir Group, s - SSM Group, C - Connected,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       L - Local, P - Pruned, R - RP-bit set, F- Register flag,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       T - SPT-bit set, J - Join SPT, M - MSDPcreated entry,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       X - Proxy Join Timer Running, A -Candidate for MSDP Advertisement,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       U - URD, I - Received Source SpecificHost Report,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       Z - Multicast Tunnel, z - MDT-data groupsender,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       Y - Joined MDT-data group, y - Sendingto MDT-data group<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Outgoinginterface flags: H - Hardware switched, A - Assert winner<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> Timers: Uptime/Expires<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> Interface state: Interface, Next-Hop or VCD,State/Mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">(*,224.0.1.40), 00:39:13/00:02:24, RP 0.0.0.0, flags: DCL<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">  Incoming interface: Null, RPF nbr 0.0.0.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">  Outgoing interface list:<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">    Ethernet0/1, Forward/Dense,00:33:20/00:00:00<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Ethernet0/0,Forward/Dense, 00:39:13/00:00:00<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2#sh ipmroute <span style="color:red">//R2<span style="font-family:宋体">生成了</span>SPT<span style="color:black; font-family:Arial"><br>                </span></span></span></p>
<p><span style="color:black; font-size:10pt">IP MulticastRouting Table<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Flags: D -Dense, S - Sparse, B - Bidir Group, s - SSM Group, C - Connected,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       L - Local, P - Pruned, R - RP-bit set, F- Register flag,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       T - SPT-bit set, J - Join SPT, M - MSDPcreated entry,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       X - Proxy Join Timer Running, A -Candidate for MSDP Advertisement,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       U - URD, I - Received Source SpecificHost Report,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       Z- Multicast Tunnel, z - MDT-data group sender,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       Y - Joined MDT-data group, y - Sendingto MDT-data group<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Outgoinginterface flags: H - Hardware switched, A - Assert winner<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> Timers: Uptime/Expires<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> Interface state: Interface, Next-Hop or VCD,State/Mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">(*, 224.1.1.1), 00:06:24/stopped,RP 0.0.0.0, flags: D<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"> Incoming interface: Null, RPF nbr 0.0.0.0<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"> Outgoing interface list:<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">   Ethernet0/1, Forward/Dense, 00:06:24/00:00:00<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">Ethernet0/0,Forward/Dense, 00:06:24/00:00:00<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">(192.168.5.2, 224.1.1.1), 00:06:24/00:00:09,flags: T<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"> Incoming interface: Ethernet0/0, RPF nbr 192.168.52.5<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"> Outgoing interface list:<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">   Ethernet0/1, Forward/Dense, 00:06:27/00:00:00<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">(*,224.0.1.40), 00:32:25/00:02:34, RP 0.0.0.0, flags: DCL<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">  Incoming interface: Null, RPF nbr 0.0.0.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">  Outgoing interface list:<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">    Ethernet0/1, Forward/Dense,00:25:04/00:00:00<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Ethernet0/0,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> Forward/Dense, 00:32:25/00:00:00<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4#sh ipmroute<span style="color:red"> //R4<span style="font-family:宋体">链接</span>R6<span style="font-family:宋体">的接口会剪枝</span><span style="color:black; font-family:Arial"><br>                </span></span></span></p>
<p><span style="color:black; font-size:10pt">IP MulticastRouting Table<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Flags: D -Dense, S - Sparse, B - Bidir Group, s - SSM Group, C - Connected,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       L - Local, P - Pruned, R - RP-bit set, F- Register flag,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       T - SPT-bit set, J - Join SPT, M - MSDPcreated entry,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       X - Proxy Join Timer Running, A -Candidate for MSDP Advertisement,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       U - URD, I - Received Source SpecificHost Report,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       Z - Multicast Tunnel, z - MDT-data groupsender,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       Y - Joined MDT-data group, y - Sendingto MDT-data group<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Outgoinginterface flags: H - Hardware switched, A - Assert winner<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> Timers: Uptime/Expires<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> Interface state: Interface, Next-Hop or VCD,State/Mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">(*,224.1.1.1), 01:25:39/stopped, RP 0.0.0.0, flags: D<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">  Incoming interface: Null, RPF nbr 0.0.0.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">  Outgoing interface list:<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">    Ethernet0/2, Forward/Dense,01:25:39/00:00:00<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">    Ethernet0/1, Forward/Dense,01:25:39/00:00:00<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">    Ethernet0/0, Forward/Dense,01:25:39/00:00:00<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">(192.168.5.2,224.1.1.1), 00:00:04/00:02:55, flags: T<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">  Incoming interface: Ethernet0/1, RPF nbr192.168.24.2<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">  Outgoing interface list:<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">    Ethernet0/0, Forward/Dense,00:00:08/00:00:00<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">    <span style="color:red">Ethernet0/2, Prune/Dense, 00:00:08/00:02:54<span style="color:black; font-family:Arial"><br>                </span></span></span></p>
<p><span style="color:black; font-size:10pt">(*,224.0.1.40), 01:32:39/00:02:37, RP 0.0.0.0, flags: DCL<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">  Incoming interface: Null, RPF nbr 0.0.0.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">  Outgoing interface list:<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">    Ethernet0/2, Forward/Dense,01:28:28/00:00:00<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">    Ethernet0/1, Forward/Dense,01:32:08/00:00:00<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">    Ethernet0/0, Forward/Dense,01:32:39/00:00:00<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black"><span style="font-size:14pt"><strong><span style="font-family:宋体">实验三、组播</span>PIM-SM<span style="font-family:宋体">（静态</span>RP<span style="font-family:宋体">、</span>SPT<span style="font-family:宋体">自动切换</span>RPT<span style="font-family:宋体">）</span></strong></span><span style="font-family:Arial; font-size:10pt"><br>            </span></span></p>
<p><img src="http://www.madhex.com/wp-content/uploads/2016/05/051016_0624_CCNP3.jpg" alt=""><span style="color:black; font-family:Arial; font-size:10pt"><br>        </span></p>
<p><span style="color:black; font-size:10pt">Server<span style="font-family:宋体">配置：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Server#conft<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Server(config)#noip routing<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Server(config)#ipdefault-gateway 192.168.0.1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Server(config)#inte0/0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Server(config-if)#ipadd 192.168.0.2 255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Server(config-if)#nosh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Server(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2<span style="font-family:宋体">配置：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2#conf t<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#ipmulticast-routing<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#ippim rp-address 3.3.3.3<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#inte0/0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ipadd 192.168.0.1 255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ippim sparse-mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#nosh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#inte0/1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ipadd 192.168.23.2 255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ippim sparse-mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#nosh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#inte0/2<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ipadd 192.168.25.2 255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#nosh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#routerospf 1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config-router)#net0.0.0.0 0.0.0.0 area 0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R2(config-router)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3<span style="font-family:宋体">配置：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3#conf t<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#ipmulticast-routing<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#ippim rp-address 3.3.3.3<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#intlo0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ipadd 3.3.3.3 255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ippim sparse-mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#inte0/0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ipadd 192.168.23.3 255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ippim sparse-mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#nosh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#inte0/1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ipadd 192.168.34.3 255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ippim sparse-mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#nosh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#routerospf 1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#net0.0.0.0 0.0.0.0 area 0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4<span style="font-family:宋体">配置：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4#conf t<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#ipmulticast-routing<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#ippim rp-address 3.3.3.3<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#inte0/0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ipadd 192.168.34.4 255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ippim sparse-mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#nosh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#inte0/1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ipadd 192.168.46.4 255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ippim sparse-mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#nosh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#routerospf 1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-router)#net0.0.0.0 0.0.0.0 area 0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4(config-router)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5<span style="font-family:宋体">配置：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5#conf t<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#ipmulticast-routing<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#ippim rp-address 3.3.3.3<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#inte0/0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#ipadd 192.168.25.5 255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#nosh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#inte0/1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#ipadd 192.168.56.5 255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#nosh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#routerospf 1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config-router)#net0.0.0.0 0.0.0.0 area 0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R5(config-router)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6<span style="font-family:宋体">配置：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6#conf t<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config)#ipmulticast-routing<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config)#ippim rp-address 3.3.3.3<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config)#inte0/1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config-if)#ipadd 192.168.56.6 255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config-if)#nosh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config)#inte0/0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config-if)#ipadd 192.168.46.6 255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config-if)#ippim sparse-mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config-if)#nosh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config)#inte0/1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config)#inte0/2<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config-if)#ipadd 192.168.2.1 255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config-if)#ippim sparse-mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config-if)#nosh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config-if)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config)#routerospf 1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config-router)#net0.0.0.0 0.0.0.0 area 0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6(config-router)#exit<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC<span style="font-family:宋体">配置：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC#conf t<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC(config)#noip routing<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC(config)#ipdefault-gateway 192.168.2.1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC(config)#inte0/0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC(config-if)#ipadd 192.168.2.2 255.255.255.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC(config-if)#ipigmp join-group 224.1.1.1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC(config-if)#nosh<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">PC(config-if)#<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">完成以上配置后，在</span>Server<span style="font-family:宋体">端</span>ping 224.1.1.1<span style="font-family:宋体">的组播组地址，进行</span>RP<span style="font-family:宋体">注册，然后查看</span>R3<span style="font-family:宋体">与</span>R6<span style="font-family:宋体">的多播路由：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Server#ping224.1.1.1 repeat  100<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Type escapesequence to abort.<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Sending 100,100-byte ICMP Echos to 224.1.1.1, timeout is 2 seconds:<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Reply torequest 0 from 192.168.2.2, 168 ms<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Reply torequest 1 from 192.168.2.2, 180 ms<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3#sh ip mr<span style="color:red"> //RP<span style="font-family:宋体">中的注册信息</span><span style="color:black; font-family:Arial"><br>                </span></span></span></p>
<p><span style="color:black; font-size:10pt">IP MulticastRouting Table<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Flags: D -Dense, S - Sparse, B - Bidir Group, s - SSM Group, C - Connected,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       L - Local, P - Pruned, R - RP-bit set, F- Register flag,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       T - SPT-bit set, J - Join SPT, M - MSDPcreated entry,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       X - Proxy Join Timer Running, A -Candidate for MSDP Advertisement,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       U - URD, I - Received Source SpecificHost Report,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       Z - Multicast Tunnel, z - MDT-data groupsender,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       Y - Joined MDT-data group, y - Sendingto MDT-data group<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Outgoinginterface flags: H - Hardware switched, A - Assert winner<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> Timers: Uptime/Expires<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> Interface state: Interface, Next-Hop or VCD,State/Mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">(*, 224.1.1.1), 00:17:50/stopped,RP 3.3.3.3, flags: S<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"> Incoming interface: Null, RPF nbr 0.0.0.0<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"> Outgoing interface list:<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">   Ethernet0/1, Forward/Sparse, 00:06:51/00:02:35<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">(192.168.0.2, 224.1.1.1),00:17:50/00:03:24, flags: T<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"> Incoming interface: Ethernet0/0, RPF nbr 192.168.23.2<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"> Outgoing interface list:<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">   Ethernet0/1, Forward/Sparse, 00:06:51/00:02:35<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">(192.168.46.6, 224.1.1.1),00:00:37/00:02:52, flags: PTX<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"> Incoming interface: Ethernet0/1, RPF nbr 192.168.34.4<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"> Outgoing interface list: Null<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">(*,224.0.1.40), 00:55:31/00:02:46, RP 3.3.3.3, flags: SJCL<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">  Incoming interface: Null, RPF nbr 0.0.0.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">  Outgoing interface list:<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">    Ethernet0/1, Forward/Sparse,00:06:53/00:02:55<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">    Ethernet0/0, Forward/Sparse,00:31:20/00:02:43<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Loopback0,Forward/Sparse, 00:55:33/00:02:44<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R6#sh ip mroute<span style="color:red"> //<span style="font-family:宋体">得到</span>RPT<span style="font-family:宋体">表项，收到第一个组播数据后，就切换了自动切换到</span>SPT<span style="color:black; font-family:Arial"><br>                </span></span></span></p>
<p><span style="color:black; font-size:10pt">IP MulticastRouting Table<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Flags: D -Dense, S - Sparse, B - Bidir Group, s - SSM Group, C - Connected,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       L - Local, P - Pruned, R - RP-bit set, F- Register flag,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       T - SPT-bit set, J - Join SPT, M - MSDPcreated entry,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       X - Proxy Join Timer Running, A -Candidate for MSDP Advertisement,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       U - URD, I - Received Source SpecificHost Report,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       Z - Multicast Tunnel, z - MDT-data groupsender,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       Y - Joined MDT-data group, y - Sendingto MDT-data group<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Outgoinginterface flags: H - Hardware switched, A - Assert winner<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> Timers: Uptime/Expires<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> Interface state: Interface, Next-Hop or VCD,State/Mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">(*, 224.1.1.1), 00:44:24/stopped,RP 3.3.3.3, flags: SJCF   //RPT <span style="font-family:宋体">次优路径</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"> Incoming interface: Ethernet0/0, RPF nbr 192.168.46.4<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"> Outgoing interface list:<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">Ethernet0/2, Forward/Sparse,00:01:30/00:02:30<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">(192.168.0.2, 224.1.1.1),00:02:45/00:00:14, flags: J   //SPT <span style="font-family:宋体">最优路径</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"> Incoming interface: Null, RPF nbr 192.168.56.5<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"> Outgoing interface list:<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">   Ethernet0/2, Forward/Sparse, 00:01:30/00:02:30<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">(*,224.0.1.40), 00:51:02/00:02:41, RP 3.3.3.3, flags: SJPCL<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">  Incoming interface: Ethernet0/0, RPF nbr192.168.46.4<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">  Outgoing interface list: Null<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:#464646; font-size:10pt"><span style="font-family:Times New Roman">  RP</span><span style="font-family:宋体">认为是共享树的根，这和有源树不同，有源树的根一般是组播源所在。在稀疏模式下，所有的组播源数据都会通过</span><span style="font-family:Times New Roman">Register</span><span style="font-family:宋体">消息向</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">注册，注册后，所有该组播源的数据都发给</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">；然后，所有接收者都会发送</span><span style="font-family:Times New Roman">Join</span><span style="font-family:宋体">消息到</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">，来选择加入哪个组播组接收组播数据。另外</span><span style="font-family:Times New Roman">PIM-SM</span><span style="font-family:宋体">还可以在以</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">为</span><span style="font-family:Times New Roman">root</span><span style="font-family:宋体">建立共享树的同时，每一台</span><span style="font-family:Times New Roman">PIM-SM</span><span style="font-family:宋体">路由器都会在自己和组播源之间建立一个</span><span style="font-family:Times New Roman">SPT</span><span style="font-family:宋体">，最短路径树，也就是我们在</span><span style="font-family:Times New Roman">show ip mroute</span><span style="font-family:宋体">里看到的（</span><span style="font-family:Times New Roman">S</span><span style="font-family:宋体">，</span><span style="font-family:Times New Roman">G</span><span style="font-family:宋体">）表项。<span style="color:black">但是<span style="color:#464646">静态</span></span></span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">需要在每台</span><span style="font-family:Times New Roman">PIM</span><span style="font-family:宋体">路由器上配置，</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">也需要配置，因为要让每台路由器都知道谁是</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">，但是这种方式不能提供冗余功能的</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">，当配置的</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">失效后，必须手工更改，否则组播将不能通信。</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:black"><span style="font-size:14pt"><strong><span style="font-family:宋体">实验四、思科私有协议</span>PIM-Spare-Dense-Mode<span style="font-family:宋体">（动态</span>Auto-RP<span style="font-family:宋体">）</span></strong></span><span style="font-family:Arial; font-size:10pt"><br>            </span></span></p>
<p><img src="http://www.madhex.com/wp-content/uploads/2016/05/051016_0624_CCNP4.jpg" alt=""><span style="color:black; font-family:Arial; font-size:10pt"><br>        </span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">CISCO Auto-RP</span><span style="font-family:宋体">可以解决静态</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">选择不灵活且没有冗余的问题</span><span style="font-family:Times New Roman">(</span><span style="font-family:宋体">有备份</span><span style="font-family:Times New Roman">RP)</span><span style="font-family:宋体">。要配置</span><span style="font-family:Times New Roman">Auto-RP</span><span style="font-family:宋体">的有需要两个角色：</span><span style="font-family:Times New Roman">candidate RP(RP</span><span style="font-family:宋体">候选者</span><span style="font-family:Times New Roman">)</span><span style="font-family:宋体">、</span><span style="font-family:Times New Roman">mapping agents</span><span style="font-family:宋体">收集</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">地址信息并向外发送。</span><span style="font-family:Times New Roman"> RP</span><span style="font-family:宋体">候选者以</span><span style="font-family:Times New Roman">224.0.0.39</span><span style="font-family:宋体">的多播地址向外宣告自己为</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">。</span><span style="font-family:Times New Roman">mapping agents</span><span style="font-family:宋体">监听这个地址。</span><span style="font-family:Times New Roman">mapping agents</span><span style="font-family:宋体">以</span><span style="font-family:Times New Roman">224.0.0.40</span><span style="font-family:宋体">向外宣告究竟谁是</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">。在</span><span style="font-family:Times New Roman">3</span><span style="font-family:宋体">分钟之内如果没有收到任何</span><span style="font-family:Times New Roman"> rp announce</span><span style="font-family:宋体">，则认为这个网络没有</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">或者</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">不可用。过程：</span><span style="font-family:Arial"><br>            </span></span></p>
<ol>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:Arial">candidate rp</span><span style="font-family:Times New Roman"> </span><span style="font-family:宋体">宣告自己要做某个组的</span><span style="font-family:Arial">rp</span><span style="font-family:宋体">，通告出去采用的</span><span style="font-family:Arial">ip</span><span style="font-family:宋体">地址</span><span style="font-family:Arial">224.0.1.39</span><span style="font-family:宋体">（默认每</span><span style="font-family:Arial">60s</span><span style="font-family:宋体">泛洪一次）（只有</span><span style="font-family:Arial">MA</span><span style="font-family:宋体">监听</span><span style="font-family:Arial">224.0.1.39</span><span style="font-family:宋体">这个组播地址）</span></span><span style="font-family:Arial; font-size:10pt"><br>                </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt">MA (mapping agents)<span style="font-family:Times New Roman"> </span><span style="font-family:宋体">它去决定那个做那个组的</span>rp<span style="font-family:宋体">（看</span>ip<span style="font-family:宋体">地址那个大，但是</span>MA<span style="font-family:宋体">本身没有选举机制，可以存在多个，因为他们选出的</span>RP<span style="font-family:宋体">是一致的，不会影响。），再</span><span style="font-family:Times New Roman"> </span><span style="font-family:宋体">以</span><span style="font-family:Times New Roman">224.0.1.40 </span><span style="font-family:宋体">的多播组地址通告候选</span><span style="font-family:Times New Roman"> RP </span><span style="font-family:宋体">的信息。末端路由器接收到这个</span><span style="font-family:Times New Roman"> 224.0.1.40 </span><span style="font-family:宋体">多播组的信息后就可以知道有哪些</span><span style="font-family:Times New Roman"> RP</span><span style="font-family:宋体">，并且这些</span><span style="font-family:Times New Roman"> RP </span><span style="font-family:宋体">对应哪些多播组，从而可以自动发现</span><span style="font-family:Times New Roman"> RP</span><span style="font-family:宋体">。</span><span style="font-family:Times New Roman"> </span><span style="font-family:宋体">（所有运行组播的路由器都监听</span>224.0.1.40<span style="font-family:宋体">这个组，默认每</span>60S<span style="font-family:宋体">一次，</span><span style="font-family:Times New Roman"> </span>holdtime=3x interval<span style="font-family:宋体">）</span></span><span style="font-size:10pt"><br>                </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:Times New Roman"> </span><span style="font-family:宋体">候选</span><span style="font-family:Times New Roman"> RP </span><span style="font-family:宋体">和</span><span style="font-family:Times New Roman"> RP </span><span style="font-family:宋体">映射代理可以相互独立，不一定属于同一台路由器。但为了可靠起见，而通常将它们合为一体。</span></span><span style="font-size:10pt"><br>                </span></span></div></li>
<li><div style="background: white"><span style="color:#494949"><span style="font-size:9pt"><span style="font-family:Times New Roman">Auto-rp</span><span style="font-family:宋体">中没有对丢失数据包的检测和重传机制，所以</span><span style="font-family:Times New Roman">auto-rp</span><span style="font-family:宋体">发现消息的传输是不可靠的。所以一般可以使用多个</span><span style="font-family:Times New Roman">MA</span><span style="font-family:宋体">来提供冗余。</span></span><span style="color:black; font-size:10pt"><br>                </span></span></div>

<p><span style="color:black; font-size:10pt">RP<span style="font-family:宋体">的选举规则</span></span></p>
<pre><code>        &lt;/span&gt;
</code></pre></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">如果</span><span style="font-family:Arial">RP</span><span style="font-family:宋体">服务的组播地址完全冲突，（不同</span><span style="font-family:Arial">RP</span><span style="font-family:宋体">服务的组播地址范围完全一样）选举</span><span style="font-family:Arial">ip</span><span style="font-family:宋体">地址大的为</span><span style="font-family:Arial">RP</span><span style="font-family:宋体">。</span></span><span style="font-family:Arial; font-size:10pt"><br>                </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">如果</span>RP<span style="font-family:宋体">服务的组播地址不完全冲突，（不同</span>RP<span style="font-family:宋体">服务的组播地址范围不完全一样）此时</span>acl<span style="font-family:宋体">定义的服务范围小的</span>RP<span style="font-family:Times New Roman"> </span><span style="font-family:宋体">优先。</span></span><span style="font-size:10pt"><br>                </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">对于多个</span>RP MA<span style="font-family:宋体">，不用选举主</span>MA<span style="font-family:宋体">，对于普通路由器，来自</span>MA<span style="font-family:宋体">的消息可以相互覆盖。反正都是一样的。</span></span><span style="font-size:10pt"><br>                </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt">auto rp<span style="font-family:Times New Roman"> </span><span style="font-family:宋体">必须运行在</span>sparse-dense-mode<span style="font-family:宋体">模式下，这是</span>cisco<span style="font-family:宋体">的私有标准，如果运行在</span>sparse-mode<span style="font-family:宋体">需要配置</span>ip pim autorp listener<span style="font-family:宋体">。</span></span><span style="font-size:10pt"><br>                </span></span></div>

</li>
</ol>
<p><span style="color:black; font-size:10pt">Server<span style="font-family:宋体">配置：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">Server#conft</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">Server(config)#noip routing</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">Server(config)#ipdefault-gateway 192.168.1.1</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">Server(config)#inte0/0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">Server(config-if)#ipadd 192.168.1.2 255.255.255.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">Server(config-if)#nosh</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">Server(config-if)#exit</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R1</span><span style="font-family:宋体">配置：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R1#conf t</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R1(config)#int e0/0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R1(config-if)#exit</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R1(config)#ip multicast-routing</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R1(config)#int e0/0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R1(config-if)#ip add 192.168.1.1 255.255.255.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R1(config-if)#ip pim sparse-dense-mode</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R1(config-if)#no sh</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R1(config-if)#exit</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R1(config)#int e0/1</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R1(config-if)#ip add 192.168.12.1 255.255.255.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R1(config-if)#ip pim sparse-dense-mode</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R1(config-if)#no sh</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R1(config-if)#exit</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R1(config)#int e0/2</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R1(config-if)#ip add 192.168.13.1 255.255.255.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R1(config-if)#ip pim sparse-dense-mode</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R1(config-if)#no sh</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R1(config-if)#exit</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R1(config)#router ospf 1</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R1(config-router)#net 0.0.0.0 0.0.0.0 area 0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R1(config-router)#exit</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R2</span><span style="font-family:宋体">配置：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R2#conf t</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R2(config)#ip multicast-routing</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R2(config)#int e0/0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R2(config-if)#ip add 192.168.12.2 255.255.255.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R2(config-if)#ip pim sparse-dense-mode</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R2(config-if)#no sh</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R2(config-if)#exit</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R2(config)#int e0/1</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R2(config-if)#ip add 192.168.24.2 255.255.255.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R2(config-if)#ip pim sparse-dense-mode</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R2(config-if)#no sh</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R2(config-if)#exit</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R2(config)#int lo0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R2(config-if)#ip add 2.2.2.2 255.255.255.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R2(config-if)#ip pim sparse-dense-mode</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R2(config-if)#exit</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R2(config)#ip pim send-rp-announce loopback 0scope 20</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R2(config)#ip pim send-rp-discovery loopback 0scope 20</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R2(config)#router ospf 1</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R2(config-router)#net 0.0.0.0 0.0.0.0 area 0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R2(config-router)#exit</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3</span><span style="font-family:宋体">配置：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3#conf t</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config)#ip multicast-routing</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config)#int e0/0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config-if)#ip add 192.168.13.3 255.255.255.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config-if)#ip pim sparse-dense-mode</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config-if)#no sh</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config-if)#exit</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config)#int e0/1</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config-if)#ip add 192.168.34.3 255.255.255.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config-if)#ip pim sparse-dense-mode</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config-if)#no sh</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config-if)#exit</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config-if)#ip add 3.3.3.3 255.255.255.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config-if)#ip pim sparse-dense-mode</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config-if)#exit</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config)#ip pim send-rp-announce loopback 0scope 20</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config)#ip pim send-rp-discovery loopback 0scope 20</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config)#router ospf 1</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config-router)#net 0.0.0.0 0.0.0.0 area 0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config-router)#exit</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R4</span><span style="font-family:宋体">配置：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R4#conf t</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R4(config)#ip multicast-routing</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R4(config)#int e0/0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R4(config-if)#ip add 192.168.24.4 255.255.255.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R4(config-if)#ip pim sparse-dense-mode</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R4(config-if)#no sh</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R4(config-if)#exit</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R4(config)#int e0/1</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R4(config-if)#ip add 192.168.34.4 255.255.255.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R4(config-if)#ip pim sparse-dense-mode</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R4(config-if)#no sh</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R4(config-if)#exit</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R4(config)#int e0/2</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R4(config-if)#ip add 192.168.0.1 255.255.255.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R4(config-if)#ip pim sparse-dense-mode</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R4(config-if)#no sh</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R4(config-if)#exit</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R4(config)#router ospf 1</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R4(config-router)#net 0.0.0.0 0.0.0.0 area 0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R4(config-router)#exit</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">PC</span><span style="font-family:宋体">配置：</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">PC#conf t</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">PC(config)#no ip routing</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">PC(config)#ip default-gateway 192.168.0.1</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">PC(config)#int e0/0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">PC(config-if)#ip add 192.168.0.2 255.255.255.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">PC(config-if)#ip igmp join-</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">PC(config-if)#ip igmp join-group 224.1.1.1</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">PC(config-if)#no sh</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">配置完成检查全网互通，查看</span><span style="font-family:Times New Roman">R2</span><span style="font-family:宋体">、</span><span style="font-family:Times New Roman">R3</span><span style="font-family:宋体">、</span><span style="font-family:Times New Roman">R4</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R2#sh ip mr<span style="color:red"> //RP</span></span><span style="font-family:宋体">与</span><span style="color:red"><span style="font-family:Times New Roman">MA</span><span style="font-family:宋体">同体</span><span style="color:black; font-family:Arial"><br>                </span></span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">IP Multicast Routing Table</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">Flags: D - Dense, S - Sparse, B - Bidir Group, s- SSM Group, C - Connected,</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">       L -Local, P - Pruned, R - RP-bit set, F - Register flag,</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">       T -SPT-bit set, J - Join SPT, M - MSDP created entry,</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">       X -Proxy Join Timer Running, A - Candidate for MSDP Advertisement,</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">       U -URD, I - Received Source Specific Host Report,</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">       Z -Multicast Tunnel, z - MDT-data group sender,</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">       Y -Joined MDT-data group, y - Sending to MDT-data group</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">Outgoing interface flags: H - Hardware switched,A - Assert winner</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman"> Timers:Uptime/Expires</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman"> Interfacestate: Interface, Next-Hop or VCD, State/Mode</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">(*, 224.0.1.39), 00:24:12/stopped, RP 0.0.0.0,flags: DCL</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Incominginterface: Null, RPF nbr 0.0.0.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Outgoinginterface list:</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Loopback0, Forward/Sparse-Dense, 00:23:37/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/1, Forward/Sparse-Dense, 00:23:37/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/0, Forward/Sparse-Dense, 00:24:12/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">(2.2.2.2, 224.0.1.39), 00:24:12/00:01:59, flags:LT</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Incominginterface: Loopback0, RPF nbr 0.0.0.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Outgoinginterface list:</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/1, Forward/Sparse-Dense, 00:23:38/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">    Ethernet0/0, Forward/Sparse-Dense,00:24:14/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">(3.3.3.3, 224.0.1.39), 00:10:15/00:02:30, flags:LT</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Incominginterface: Ethernet0/1, RPF nbr 192.168.24.4</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Outgoinginterface list:</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/0, Forward/Sparse-Dense, 00:10:15/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Loopback0, Forward/Sparse-Dense, 00:10:15/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">(*, 224.0.1.40), 00:26:14/stopped, RP 0.0.0.0,flags: DCL</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Incominginterface: Null, RPF nbr 0.0.0.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Outgoinginterface list:</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/1, Forward/Sparse-Dense, 00:11:50/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Loopback0, Forward/Sparse-Dense, 00:23:40/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/0, Forward/Sparse-Dense, 00:26:14/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">(2.2.2.2, 224.0.1.40), 00:23:14/00:02:11, flags:LT</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Incominginterface: Loopback0, RPF nbr 0.0.0.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Outgoinginterface list:</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/1, Forward/Sparse-Dense, 00:11:50/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/0, Forward/Sparse-Dense, 00:23:14/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">(3.3.3.3, 224.0.1.40), 00:10:17/00:02:09, flags:LT</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Incominginterface: Ethernet0/1, RPF nbr 192.168.24.4</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Outgoinginterface list:</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/0, Forward/Sparse-Dense, 00:10:17/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Loopback0, Forward/Sparse-Dense, 00:10:17/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3#sh ip mroute<span style="color:red"> //RP</span></span><span style="font-family:宋体">与</span><span style="color:red"><span style="font-family:Times New Roman">MA</span><span style="font-family:宋体">同体，同时是组播组</span><span style="font-family:Times New Roman">224.1.1.1</span><span style="font-family:宋体">的</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">，收到的注册信息</span><span style="color:black; font-family:Arial"><br>                </span></span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">IP Multicast Routing Table</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">Flags: D - Dense, S - Sparse, B - Bidir Group, s- SSM Group, C - Connected,</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">       L -Local, P - Pruned, R - RP-bit set, F - Register flag,</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">       T -SPT-bit set, J - Join SPT, M - MSDP created entry,</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">       X -Proxy Join Timer Running, A - Candidate for MSDP Advertisement,</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">       U -URD, I - Received Source Specific Host Report,</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">       Z -Multicast Tunnel, z - MDT-data group sender,</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">       Y -Joined MDT-data group, y - Sending to MDT-data group</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">Outgoing interface flags: H - Hardware switched,A - Assert winner</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman"> Timers:Uptime/Expires</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman"> Interfacestate: Interface, Next-Hop or VCD, State/Mode</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"><span style="font-family:Times New Roman">(*, 224.1.1.1), 00:10:07/00:03:13, RP3.3.3.3, flags: S</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"><span style="font-family:Times New Roman"> Incoming interface: Null, RPF nbr 0.0.0.0</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"><span style="font-family:Times New Roman"> Outgoing interface list:</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/1, Forward/Sparse-Dense, 00:10:07/00:03:13</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">(*, 224.0.1.39), 00:18:46/stopped, RP 0.0.0.0,flags: DCL</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Incominginterface: Null, RPF nbr 0.0.0.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Outgoinginterface list:</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Loopback0, Forward/Sparse-Dense, 00:18:13/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/1, Forward/Sparse-Dense, 00:18:15/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/0, Forward/Sparse-Dense, 00:18:47/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">(2.2.2.2, 224.0.1.39), 00:12:45/00:02:33, flags:LT</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Incominginterface: Ethernet0/1, RPF nbr 192.168.34.4</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Outgoinginterface list:</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/0, Prune/Sparse-Dense, 00:02:35/00:00:24</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Loopback0, Forward/Sparse-Dense, 00:12:45/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">(3.3.3.3, 224.0.1.39), 00:18:26/00:02:51, flags:LT</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Incominginterface: Loopback0, RPF nbr 0.0.0.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Outgoinginterface list:</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/1, Forward/Sparse-Dense, 00:18:16/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/0, Forward/Sparse-Dense, 00:18:26/00:00:00, A</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">(*, 224.0.1.40), 00:19:40/stopped, RP 0.0.0.0,flags: DCL</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Incominginterface: Null, RPF nbr 0.0.0.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Outgoinginterface list:</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/1, Forward/Sparse-Dense, 00:13:57/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Loopback0, Forward/Sparse-Dense, 00:18:16/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/0, Forward/Sparse-Dense, 00:19:40/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">(2.2.2.2, 224.0.1.40), 00:14:52/00:02:42, flags:LT</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Incominginterface: Ethernet0/1, RPF nbr 192.168.34.4</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Outgoinginterface list:</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/0, Prune/Sparse-Dense, 00:00:25/00:02:34</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Loopback0, Forward/Sparse-Dense, 00:14:52/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">(3.3.3.3, 224.0.1.40), 00:17:25/00:02:26, flags:LT</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Incominginterface: Loopback0, RPF nbr 0.0.0.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Outgoinginterface list:</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/1, Forward/Sparse-Dense, 00:13:57/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">Ethernet0/0,Prune/Sparse-Dense, 00:00:33/00:02:26, A</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R4#sh ip pim rp <span style="color:red">//R3</span></span><span style="font-family:宋体">为</span><span style="color:red"><span style="font-family:Times New Roman">RP</span><span style="color:black; font-family:Arial"><br>                </span></span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">Group: 224.1.1.1, RP: 3.3.3.3, v2, v1, uptime00:15:13, expires 00:02:42</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R4#sh ip mroute //</span><span style="font-family:宋体">查看</span><span style="font-family:Times New Roman">R4</span><span style="font-family:宋体">组播路由表</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">IP Multicast Routing Table</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">Flags: D - Dense, S - Sparse, B - Bidir Group, s- SSM Group, C - Connected,</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">       L -Local, P - Pruned, R - RP-bit set, F - Register flag,</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">       T -SPT-bit set, J - Join SPT, M - MSDP created entry,</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">       X -Proxy Join Timer Running, A - Candidate for MSDP Advertisement,</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">       U -URD, I - Received Source Specific Host Report,</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">       Z -Multicast Tunnel, z - MDT-data group sender,</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">       Y -Joined MDT-data group, y - Sending to MDT-data group</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">Outgoing interface flags: H - Hardware switched,A - Assert winner</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman"> Timers:Uptime/Expires</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman"> Interfacestate: Interface, Next-Hop or VCD, State/Mode</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"><span style="font-family:Times New Roman">(*, 224.1.1.1), 00:28:35/stopped, RP3.3.3.3, flags: SJC  //RPT</span><span style="font-family:宋体">树，</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">为</span><span style="font-family:Times New Roman">R3</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"><span style="font-family:Times New Roman"> Incoming interface: Ethernet0/1, RPF nbr 192.168.34.3</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"><span style="font-family:Times New Roman"> Outgoing interface list:</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/2, Forward/Sparse-Dense, 00:28:35/00:02:26</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"><span style="font-family:Times New Roman">(192.168.1.2, 224.1.1.1),00:04:16/00:02:08, flags: T  //SPT</span><span style="font-family:宋体">树</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"><span style="font-family:Times New Roman"> Incoming interface: Ethernet0/0, RPF nbr 192.168.24.2</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"><span style="font-family:Times New Roman"> Outgoing interface list:</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"><span style="font-family:Times New Roman">Ethernet0/2,Forward/Sparse-Dense, 00:04:16/00:02:26</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">(*, 224.0.1.39), 00:32:51/stopped, RP 0.0.0.0,flags: DC</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Incominginterface: Null, RPF nbr 0.0.0.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Outgoinginterface list:</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/1, Forward/Sparse-Dense, 00:03:58/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/0, Forward/Sparse-Dense, 00:32:51/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">(2.2.2.2, 224.0.1.39), 00:03:51/00:02:17, flags:T</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Incominginterface: Ethernet0/0, RPF nbr 192.168.24.2</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Outgoinginterface list:</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/1, Forward/Sparse-Dense, 00:03:58/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">(3.3.3.3, 224.0.1.39), 00:03:30/00:02:40, flags:T</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Incominginterface: Ethernet0/1, RPF nbr 192.168.34.3</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Outgoinginterface list:</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/0, Forward/Sparse-Dense, 00:03:30/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">(*, 224.0.1.40), 00:33:00/stopped, RP 0.0.0.0,flags: DCL</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Incominginterface: Null, RPF nbr 0.0.0.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Outgoinginterface list:</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/1, Forward/Sparse-Dense, 00:04:05/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/0, Forward/Sparse-Dense, 00:33:00/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">(2.2.2.2, 224.0.1.40), 00:32:27/00:02:30, flags:LT</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Incominginterface: Ethernet0/0, RPF nbr 192.168.24.2</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Outgoinginterface list:</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/1, Forward/Sparse-Dense, 00:04:05/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">(3.3.3.3, 224.0.1.40), 00:04:04/00:02:53, flags:LT</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Incominginterface: Ethernet0/1, RPF nbr 192.168.34.3</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Outgoinginterface list:</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/0, Forward/Sparse-Dense, 00:04:04/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">然后把</span><span style="font-family:Times New Roman">R3</span><span style="font-family:宋体">的物理接口都关闭，等收敛完成后查看</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">有没有自动切换到</span><span style="font-family:Times New Roman">R2</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3#conf t //</span><span style="font-family:宋体">关闭端口</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config)#int e0/0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config-if)#shu</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config-if)#shutdown</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config-if)#exit</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config)#int e0/1</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config-if)#shutdown</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R3(config-if)#exit</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R4#sh ip pim rp //</span><span style="font-family:宋体">注册到</span><span style="font-family:Times New Roman">R2</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">Group: 224.1.1.1, RP: 2.2.2.2, v2, v1, uptime00:00:13, expires 00:02:46</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">R2#sh ip mr //</span><span style="font-family:宋体">成为</span><span style="font-family:Times New Roman">RP</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">IP Multicast Routing Table</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">Flags: D - Dense, S - Sparse, B - Bidir Group, s- SSM Group, C - Connected,</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">       L -Local, P - Pruned, R - RP-bit set, F - Register flag,</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">       T -SPT-bit set, J - Join SPT, M - MSDP created entry,</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">       X -Proxy Join Timer Running, A - Candidate for MSDP Advertisement,</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">       U -URD, I - Received Source Specific Host Report,</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">       Z -Multicast Tunnel, z - MDT-data group sender,</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">       Y -Joined MDT-data group, y - Sending to MDT-data group</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">Outgoing interface flags: H - Hardware switched,A - Assert winner</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman"> Timers: Uptime/Expires</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman"> Interfacestate: Interface, Next-Hop or VCD, State/Mode</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"><span style="font-family:Times New Roman">(*, 224.1.1.1), 00:05:36/00:03:28, RP2.2.2.2, flags: S  //RPT</span><span style="font-family:宋体">树，</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">为</span><span style="font-family:Times New Roman">R2</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"><span style="font-family:Times New Roman"> Incoming interface: Null, RPF nbr 0.0.0.0</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"><span style="font-family:Times New Roman"> Outgoing interface list:</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/1, Forward/Sparse-Dense, 00:00:01/00:03:28</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">(192.168.1.2, 224.1.1.1), 00:05:36/00:01:14,flags: T</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Incominginterface: Ethernet0/0, RPF nbr 192.168.12.1</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Outgoinginterface list:</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/1, Forward/Sparse-Dense, 00:05:36/00:03:28</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">(*, 224.0.1.39), 00:37:52/stopped, RP 0.0.0.0,flags: DCL</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Incominginterface: Null, RPF nbr 0.0.0.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Outgoinginterface list:</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Loopback0, Forward/Sparse-Dense, 00:37:16/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/1, Forward/Sparse-Dense, 00:37:16/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/0, Forward/Sparse-Dense, 00:37:52/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">(2.2.2.2, 224.0.1.39), 00:37:52/00:02:32, flags:LT</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Incominginterface: Loopback0, RPF nbr 0.0.0.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Outgoinginterface list:</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/1, Forward/Sparse-Dense, 00:37:54/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/0, Forward/Sparse-Dense, 00:38:29/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">(*, 224.0.1.40), 00:40:28/stopped, RP 0.0.0.0,flags: DCL</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Incominginterface: Null, RPF nbr 0.0.0.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Outgoinginterface list:</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/1, Forward/Sparse-Dense, 00:26:04/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Loopback0, Forward/Sparse-Dense, 00:37:54/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/0, Forward/Sparse-Dense, 00:40:28/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">(2.2.2.2, 224.0.1.40), 00:37:28/00:02:19, flags:LT</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Incominginterface: Loopback0, RPF nbr 0.0.0.0</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">  Outgoinginterface list:</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/1, Forward/Sparse-Dense, 00:26:04/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">   Ethernet0/0, Forward/Sparse-Dense, 00:37:28/00:00:00</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:#323e32"><span style="font-family:宋体; font-size:14pt"><strong>实验五、</strong></span><span style="color:#464646"><span style="font-size:14pt"><strong><span style="font-family:Times New Roman">Bootstrap Router<span style="color:#323e32">  </span></span><span style="font-family:宋体">（</span></strong></span><span style="color:#323e32"><span style="font-size:14pt"><strong><span style="font-family:Times New Roman">BSR</span><span style="font-family:宋体">业界标准协议）</span></strong></span><span style="color:black; font-family:Arial; font-size:10pt"><br>                    </span></span></span></span></p>
<p><img src="http://www.madhex.com/wp-content/uploads/2016/05/051016_0624_CCNP5.jpg" alt=""><span style="color:black; font-family:Arial; font-size:10pt"><br>        </span></p>
<p><span style="color:black"><span style="font-family:宋体; font-size:9pt">在采用自举路由器（BootStrap Router）方式配置汇集点(Rendezvous Point)的方法中，一组路由器被配置为候选自举路由器(C-BSRs)，一组路由器被配置为候选汇集点（C-RPs），通常建议这两组路由器是同样的路由器。候选汇集点会定期把候选汇集点通告消息（C-RP-Advs）以单播的形式发送到自举路由器；汇集点通告消息是一种PIM消息，它包括通告候选汇集点的地址、可选的组播组地址和一个掩码长度域（组的前缀）；</span><span style="font-family:Arial; font-size:10pt"><br>            </span></span></p>
<p><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">自举路由器收集这些通告消息并产生相应的自举消息，自举消息也是一种PIM消息，它包括候选RP和相应的组前缀（i</span>p<span style="font-family:宋体">为</span>224.0.0.13<span style="font-family:宋体">即所有使能</span>pim<span style="font-family:宋体">的路由器，每</span>60s<span style="font-family:宋体">泛洪一次。让其他路由器知道</span><span style="font-family:Times New Roman"> </span>BSR<span style="font-family:宋体">的位置。</span> <span style="font-family:宋体">同时也是通过这样的方式把</span>RP<span style="font-family:宋体">信息发送出去），自举消息主要用于自举路由器的选择和分发RP点信息。自举消息支持一个简单的机制以便于侯选自举路由器之间选择出活跃的自举路由器，一般是优先级最高的自举路由器被选择为活跃的自举路由器。</span>BSR<span style="font-family:宋体">不决定</span>RP<span style="font-family:宋体">，只是收集</span>RP<span style="font-family:宋体">候选信息并通告这些信息。多个</span>BSR<span style="font-family:宋体">存在选举原则</span></span><span style="font-family:Arial; font-size:10pt"><br>            </span></span></p>
<ol>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">优先级默认为</span><span style="font-family:Arial">0</span><span style="font-family:宋体">，值越小越优先，越有可能成为</span></span><span style="font-family:Arial"><span style="font-size:9pt">Active BSR</span><span style="font-size:10pt"><br>                    </span></span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">优先级相同（默认</span>0<span style="font-family:宋体">），</span>ip<span style="font-family:宋体">地址值越大越优，越可能成为</span>active BSR</span><span style="font-size:10pt"><br>                </span></span></div>

<p><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">为获得RP信息，所有普通路由器都要收集自举（Bootstrap）消息，即普通路由器接收并保存由自举路由器发送来的自举消息，它采用在自举消息中发布的一组可用汇集点来获得合适的组播组到汇集点的映射。所有路由器采用散列函数来计算组播组和汇集点的映射关系，散列函数的算法是把组播组地址和候选汇集点的地址作为输入值，从而得到一个组播组的实际RP地址。</span> <span style="font-family:宋体">其他路由器收到信息后会选择自己的</span>RP,<span style="font-family:宋体">依据原则选择</span>RP<span style="font-family:宋体">为：</span></span><span style="font-size:10pt"></span></span></p>
<pre><code>            &lt;/span&gt;&lt;/span&gt;
</code></pre><ol>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">最长匹配组（</span><span style="font-family:Arial">acl</span><span style="font-family:宋体">覆盖的范围小的优先）</span></span><span style="font-family:Arial; font-size:10pt"><br>                    </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt">RP<span style="font-family:宋体">优先级数值低的</span></span><span style="font-size:10pt"><br>                    </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt">bsr<span style="font-family:宋体">的哈希值，可以做到冗余处理</span></span><span style="font-size:10pt"><br>                    </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt">ip<span style="font-family:宋体">地址大的</span></span><span style="font-size:10pt"><br>                    </span></span></div>

</li>
</ol>
<p><span style="color:black; font-size:10pt">Server<span style="font-family:宋体">配置：</span></span></p>
<pre><code>                &lt;/span&gt;
</code></pre><p><span style="color:black; font-size:10pt">Server#conft<br></span></p>
<p><span style="color:black; font-size:10pt">Server(config)#noip routing<br></span></p>
<p><span style="color:black; font-size:10pt">Server(config)#ipdefault-gateway 192.168.1.1<br></span></p>
<p><span style="color:black; font-size:10pt">Server(config)#inte0/0<br></span></p>
<p><span style="color:black; font-size:10pt">Server(config-if)#ipadd 192.168.1.2 255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">Server(config-if)#nosh<br></span></p>
<p><span style="color:black; font-size:10pt">Server(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R1<span style="font-family:宋体">配置：</span></span></p>
<pre><code>                &lt;/span&gt;
</code></pre><p><span style="color:black; font-size:10pt">R1#conf t<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#ip multicast-routing<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#int e0/0<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip add 192.168.1.1255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#int e0/1<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip add 192.168.12.1255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#int e0/2<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip add 192.168.13.1255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#router ospf 1<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-router)#net 0.0.0.0 0.0.0.0area 0<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-router)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R2<span style="font-family:宋体">配置：</span></span></p>
<pre><code>                &lt;/span&gt;
</code></pre><p><span style="color:black; font-size:10pt">R2#conf t<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#ip multicast-routing<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#int e0/0<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ip add 192.168.12.2255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#int e0/1<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ip add 192.168.25.2255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#int lo0<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ip add 2.2.2.2255.255.255.255<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#ip pim bsr-candidate loopback0<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#ip pim rp-candidate loopback0<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#router ospf 1<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-router)#net 0.0.0.0 0.0.0.0area 0<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-router)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R3<span style="font-family:宋体">配置：</span></span></p>
<pre><code>                &lt;/span&gt;
</code></pre><p><span style="color:black; font-size:10pt">R3#conf t<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#ip multi<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#ip multicast-routing<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#int e0/0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip add 192.168.13.3255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#int e0/1<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip add 192.168.34.3255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#router ospf 1<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#net 0.0.0.0 0.0.0.0area 0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R4<span style="font-family:宋体">配置</span>;<br></span></p>
<p><span style="color:black; font-size:10pt">R4#conf t<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#ip multicast-routing<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#int e0/0<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip add 192.168.34.4255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#int e0/1<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip add 192.168.45.4255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#int lo0<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip add 4.4.4.4255.255.255.255<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#ip pim bsr-candidate loopback0<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#ip pim rp-candidate loopback0<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#router ospf 1<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-router)#net 0.0.0.0 0.0.0.0area 0<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-router)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R5<span style="font-family:宋体">配置：</span></span></p>
<pre><code>                &lt;/span&gt;
</code></pre><p><span style="color:black; font-size:10pt">R5#conf t<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#ip multicast-routing<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#int e0/0<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#ip add 192.168.25.5255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#int e0/1<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#ip add 192.168.45.5255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#int e0/2<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#ip add 192.168.0.1255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#router ospf 1<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-router)#net 0.0.0.0 0.0.0.0area 0<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-router)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">PC<span style="font-family:宋体">配置：</span></span></p>
<pre><code>                &lt;/span&gt;
</code></pre><p><span style="color:black; font-size:10pt">PC#conf t<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config)#no ip routing<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config)#ip default-gateway192.168.0.1<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config)#int e0/0<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config-if)#ip add 192.168.0.2255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config-if)#ip igmp join-group224.1.1.1<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">完成以上配置查看</span>R5<span style="font-family:宋体">、</span>R2<span style="font-family:宋体">、</span>R4<br></span></p>
<p><span style="color:black; font-size:10pt">R5#sh ip pim bsr-router /<span style="color:red">/<span style="font-family:宋体">活动</span>BSR<span style="font-family:宋体">为</span>R4<span style="color:black"></span></span></span></p>
<pre><code>                        &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
</code></pre><p><span style="color:black; font-size:10pt">PIMv2 Bootstrap information<br></span></p>
<p><span style="color:black; font-size:10pt"> BSR address: 4.4.4.4 (?)<br></span></p>
<p><span style="color:black; font-size:10pt"> Uptime:      00:00:32, BSRPriority: 0, Hash mask length: 0<br></span></p>
<p><span style="color:black; font-size:10pt"> Expires:     00:01:37<br></span></p>
<p><span style="color:black; font-size:10pt">R2#sh ip mroute <span style="color:red">//R2<span style="font-family:宋体">不是</span>RP<span style="font-family:宋体">没有收到注册信息</span><span style="color:black"></span></span></span></p>
<pre><code>                        &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
</code></pre><p><span style="color:black; font-size:10pt">IP Multicast Routing Table<br></span></p>
<p><span style="color:black; font-size:10pt">Flags: D - Dense, S - Sparse, B - BidirGroup, s - SSM Group, C - Connected,<br></span></p>
<p><span style="color:black; font-size:10pt">      L - Local, P - Pruned, R - RP-bit set, F - Register flag,<br></span></p>
<p><span style="color:black; font-size:10pt">      T - SPT-bit set, J - Join SPT, M - MSDP created entry,<br></span></p>
<p><span style="color:black; font-size:10pt">      X - Proxy Join Timer Running, A - Candidate for MSDP Advertisement,<br></span></p>
<p><span style="color:black; font-size:10pt">      U - URD, I - Received Source Specific Host Report,<br></span></p>
<p><span style="color:black; font-size:10pt">      Z - Multicast Tunnel, z - MDT-data group sender,<br></span></p>
<p><span style="color:black; font-size:10pt">      Y - Joined MDT-data group, y - Sending to MDT-data group<br></span></p>
<p><span style="color:black; font-size:10pt">Outgoing interface flags: H - Hardwareswitched, A - Assert winner<br></span></p>
<p><span style="color:black; font-size:10pt"> Timers: Uptime/Expires<br></span></p>
<p><span style="color:black; font-size:10pt"> Interface state: Interface, Next-Hop or VCD,State/Mode<br></span></p>
<p><span style="color:black; font-size:10pt">(*, 224.0.1.40), 00:27:56/00:02:40, RP0.0.0.0, flags: DCL<br></span></p>
<p><span style="color:black; font-size:10pt"> Incoming interface: Null, RPF nbr 0.0.0.0<br></span></p>
<p><span style="color:black; font-size:10pt"> Outgoing interface list:<br></span></p>
<p><span style="color:black; font-size:10pt">Ethernet0/0,Forward/Sparse, 00:27:56/00:02:40<br></span></p>
<p><span style="color:black; font-size:10pt">R4#sh ip mroute /<span style="color:red">/R4<span style="font-family:宋体">有注册信息，说明它被选为</span>RP<span style="color:black"></span></span></span></p>
<pre><code>                        &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
</code></pre><p><span style="color:black; font-size:10pt">IP Multicast Routing Table<br></span></p>
<p><span style="color:black; font-size:10pt">Flags: D - Dense, S - Sparse, B - BidirGroup, s - SSM Group, C - Connected,<br></span></p>
<p><span style="color:black; font-size:10pt">      L - Local, P - Pruned, R - RP-bit set, F - Register flag,<br></span></p>
<p><span style="color:black; font-size:10pt">      T - SPT-bit set, J - Join SPT, M - MSDP created entry,<br></span></p>
<p><span style="color:black; font-size:10pt">      X - Proxy Join Timer Running, A - Candidate for MSDP Advertisement,<br></span></p>
<p><span style="color:black; font-size:10pt">      U - URD, I - Received Source Specific Host Report,<br></span></p>
<p><span style="color:black; font-size:10pt">      Z - Multicast Tunnel, z - MDT-data group sender,<br></span></p>
<p><span style="color:black; font-size:10pt">      Y - Joined MDT-data group, y - Sending to MDT-data group<br></span></p>
<p><span style="color:black; font-size:10pt">Outgoing interface flags: H - Hardware switched,A - Assert winner<br></span></p>
<p><span style="color:black; font-size:10pt"> Timers: Uptime/Expires<br></span></p>
<p><span style="color:black; font-size:10pt"> Interface state: Interface, Next-Hop or VCD,State/Mode<br></span></p>
<p><span style="color:red; font-size:10pt">(*, 224.1.1.1),00:12:29/00:02:49, RP 4.4.4.4, flags: S<span style="color:black"></span></span></p>
<pre><code>                    &lt;/span&gt;&lt;/span&gt;
</code></pre><p><span style="color:red; font-size:10pt">  Incoming interface: Null, RPF nbr 0.0.0.0<span style="color:black"></span></span></p>
<pre><code>                    &lt;/span&gt;&lt;/span&gt;
</code></pre><p><span style="color:red; font-size:10pt">  Outgoing interface list:<span style="color:black"></span></span></p>
<pre><code>                    &lt;/span&gt;&lt;/span&gt;
</code></pre><p><span style="color:black; font-size:10pt">   Ethernet0/1, Forward/Sparse, 00:12:29/00:02:49<br></span></p>
<p><span style="color:black; font-size:10pt">(*, 224.0.1.40), 00:22:23/00:02:35, RP0.0.0.0, flags: DCL<br></span></p>
<p><span style="color:black; font-size:10pt"> Incoming interface: Null, RPF nbr 0.0.0.0<br></span></p>
<p><span style="color:black; font-size:10pt"> Outgoing interface list:<br></span></p>
<p><span style="color:black; font-size:10pt">   Ethernet0/0, Forward/Sparse, 00:22:23/00:02:35<br></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">从</span>Server<span style="font-family:宋体">端</span>ping 224.1.1.1<span style="font-family:宋体">，检查变化：</span></span></p>
<pre><code>                &lt;/span&gt;
</code></pre><p><span style="color:black; font-size:10pt">Server#ping 224.1.1.1 repeat 100<br></span></p>
<p><span style="color:black; font-size:10pt">Type escape sequence to abort.<br></span></p>
<p><span style="color:black; font-size:10pt">Sending 100, 100-byte ICMP Echos to224.1.1.1, timeout is 2 seconds:<br></span></p>
<p><span style="color:black; font-size:10pt">..<br></span></p>
<p><span style="color:black; font-size:10pt">Reply to request 2 from 192.168.0.2, 112ms<br></span></p>
<p><span style="color:black; font-size:10pt">Reply to request 3 from 192.168.0.2, 96ms<br></span></p>
<p><span style="color:black; font-size:10pt">R4#sh ip mroute<br></span></p>
<p><span style="color:black; font-size:10pt">IP Multicast Routing Table<br></span></p>
<p><span style="color:black; font-size:10pt">Flags: D - Dense, S - Sparse, B - BidirGroup, s - SSM Group, C - Connected,<br></span></p>
<p><span style="color:black; font-size:10pt">      L - Local, P - Pruned, R - RP-bit set, F - Register flag,<br></span></p>
<p><span style="color:black; font-size:10pt">      T - SPT-bit set, J - Join SPT, M - MSDP created entry,<br></span></p>
<p><span style="color:black; font-size:10pt">      X - Proxy Join Timer Running, A - Candidate for MSDP Advertisement,<br></span></p>
<p><span style="color:black; font-size:10pt">      U - URD, I - Received Source Specific Host Report,<br></span></p>
<p><span style="color:black; font-size:10pt">      Z - Multicast Tunnel, z - MDT-data group sender,<br></span></p>
<p><span style="color:black; font-size:10pt">      Y - Joined MDT-data group, y - Sending to MDT-data group<br></span></p>
<p><span style="color:black; font-size:10pt">Outgoing interface flags: H - Hardwareswitched, A - Assert winner<br></span></p>
<p><span style="color:black; font-size:10pt"> Timers: Uptime/Expires<br></span></p>
<p><span style="color:black; font-size:10pt"> Interface state: Interface, Next-Hop or VCD,State/Mode<br></span></p>
<p><span style="color:red; font-size:10pt">(*, 224.1.1.1),00:14:59/stopped, RP 4.4.4.4, flags: S //RPT<span style="font-family:宋体">树</span><span style="color:black"></span></span></p>
<pre><code>                    &lt;/span&gt;&lt;/span&gt;
</code></pre><p><span style="color:red; font-size:10pt">  Incoming interface: Null, RPF nbr 0.0.0.0<span style="color:black"></span></span></p>
<pre><code>                    &lt;/span&gt;&lt;/span&gt;
</code></pre><p><span style="color:red; font-size:10pt">  Outgoing interface list:<span style="color:black"></span></span></p>
<pre><code>                    &lt;/span&gt;&lt;/span&gt;
</code></pre><p><span style="color:red; font-size:10pt">    Ethernet0/1, Forward/Sparse,00:14:59/00:03:17<span style="color:black"></span></span></p>
<pre><code>                    &lt;/span&gt;&lt;/span&gt;
</code></pre><p><span style="color:red; font-size:10pt">(192.168.1.2,224.1.1.1), 00:00:04/00:02:59, flags: PTX //<span style="font-family:宋体">切换到</span>SPT<span style="font-family:宋体">树</span><span style="color:black"></span></span></p>
<pre><code>                    &lt;/span&gt;&lt;/span&gt;
</code></pre><p><span style="color:red; font-size:10pt">  Incoming interface: Ethernet0/1, RPF nbr192.168.45.5<span style="color:black"></span></span></p>
<pre><code>                    &lt;/span&gt;&lt;/span&gt;
</code></pre><p><span style="color:red; font-size:10pt">  Outgoing interface list: Null<span style="color:black"></span></span></p>
<pre><code>                    &lt;/span&gt;&lt;/span&gt;
</code></pre><p><span style="color:black; font-size:10pt">(*, 224.0.1.40), 00:24:53/00:02:03, RP0.0.0.0, flags: DCL<br></span></p>
<p><span style="color:black; font-size:10pt"> Incoming interface: Null, RPF nbr 0.0.0.0<br></span></p>
<p><span style="color:black; font-size:10pt"> Outgoing interface list:<br></span></p>
<p><span style="color:black; font-size:10pt">   Ethernet0/0, Forward/Sparse, 00:24:55/00:02:01<br></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">关闭</span>R4<span style="font-family:宋体">的两个物理端口，查看</span>RP<span style="font-family:宋体">是否会自动切换到</span>2.2.2.2<br></span></p>
<p><span style="color:black; font-size:10pt">R4#conf t <span style="color:red">//<span style="font-family:宋体">关闭</span>R4<span style="font-family:宋体">端口</span><span style="color:black"></span></span></span></p>
<pre><code>                        &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
</code></pre><p><span style="color:black; font-size:10pt">R4(config)#int e0/0<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#shutdown<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#int e0/1<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#shutdown<br></span></p>
<p><span style="color:black; font-size:10pt">R5#sh ip pim bsr <span style="color:red">//<span style="font-family:宋体">活动</span>BSR<span style="font-family:宋体">变为</span>R2<span style="color:black"></span></span></span></p>
<pre><code>                        &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
</code></pre><p><span style="color:black; font-size:10pt">R5#sh ip pim bsr-router<br></span></p>
<p><span style="color:black; font-size:10pt">PIMv2 Bootstrap information<br></span></p>
<p><span style="color:black; font-size:10pt"> BSR address: 2.2.2.2 (?)<br></span></p>
<p><span style="color:black; font-size:10pt"> Uptime:      00:03:17, BSRPriority: 0, Hash mask length: 0<br></span></p>
<p><span style="color:black; font-size:10pt"> Expires:     00:01:52<br></span></p>
<p><span style="color:black; font-size:10pt">R5#sh ip mroute <span style="color:red">//RP<span style="font-family:宋体">切换到</span>R2<span style="font-family:宋体">上</span><span style="color:black"></span></span></span></p>
<pre><code>                        &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
</code></pre><p><span style="color:black; font-size:10pt">IP Multicast Routing Table<br></span></p>
<p><span style="color:black; font-size:10pt">Flags: D - Dense, S - Sparse, B - BidirGroup, s - SSM Group, C - Connected,<br></span></p>
<p><span style="color:black; font-size:10pt">      L - Local, P - Pruned, R - RP-bit set, F - Register flag,<br></span></p>
<p><span style="color:black; font-size:10pt">      T - SPT-bit set, J - Join SPT, M - MSDP created entry,<br></span></p>
<p><span style="color:black; font-size:10pt">      X - Proxy Join Timer Running, A - Candidate for MSDP Advertisement,<br></span></p>
<p><span style="color:black; font-size:10pt">      U - URD, I - Received Source Specific Host Report,<br></span></p>
<p><span style="color:black; font-size:10pt">      Z - Multicast Tunnel, z - MDT-data group sender,<br></span></p>
<p><span style="color:black; font-size:10pt">      Y - Joined MDT-data group, y - Sending to MDT-data group<br></span></p>
<p><span style="color:black; font-size:10pt">Outgoing interface flags: H - Hardwareswitched, A - Assert winner<br></span></p>
<p><span style="color:black; font-size:10pt"> Timers: Uptime/Expires<br></span></p>
<p><span style="color:black; font-size:10pt"> Interface state: Interface, Next-Hop or VCD,State/Mode<br></span></p>
<p><span style="color:red; font-size:10pt">(*, 224.1.1.1),00:23:01/00:02:57, RP 2.2.2.2, flags: SJC<span style="color:black"></span></span></p>
<pre><code>                    &lt;/span&gt;&lt;/span&gt;
</code></pre><p><span style="color:red; font-size:10pt">  Incoming interface: Ethernet0/0, RPF nbr192.168.25.2<span style="color:black"></span></span></p>
<pre><code>                    &lt;/span&gt;&lt;/span&gt;
</code></pre><p><span style="color:red; font-size:10pt">  Outgoing interface list:<span style="color:black"></span></span></p>
<pre><code>                    &lt;/span&gt;&lt;/span&gt;
</code></pre><p><span style="color:red; font-size:10pt">    Ethernet0/2, Forward/Sparse,00:23:01/00:02:57<span style="color:black"></span></span></p>
<pre><code>                    &lt;/span&gt;&lt;/span&gt;
</code></pre><p><span style="color:black; font-size:10pt">(*, 224.0.1.40), 00:27:21/00:02:30, RP0.0.0.0, flags: DCL<br></span></p>
<p><span style="color:black; font-size:10pt"> Incoming interface: Null, RPF nbr 0.0.0.0<br></span></p>
<p><span style="color:black; font-size:10pt"> Outgoing interface list:<br></span></p>
<p><span style="color:black; font-size:10pt">   Ethernet0/0, Forward/Sparse, 00:27:21/00:02:30<br></span></p>
<p><span style="color:black"><span style="font-family:宋体; font-size:14pt"><strong>实验六、组播双向树</strong></span><span style="font-size:10pt"></span></span></p>
<pre><code>                    &lt;/span&gt;&lt;/span&gt;
</code></pre><p><img src="http://www.madhex.com/wp-content/uploads/2016/05/051016_0624_CCNP6.jpg" alt=""><span style="color:black; font-family:宋体; font-size:10pt"></span></p>
<pre><code>                &lt;/span&gt;

5.  &lt;div style=&quot;background: white&quot;&gt;&lt;span style=&quot;color:black; font-family:宋体; font-size:10pt&quot;&gt;PIM Sparse-Mode (PIM-SM)是单向树的转发，初始组播流量从源发送到RP，然后由RP使用共享树转发给接收者；如果RP不在最短路径树上，会发生自动的从源到接受者的最短路径树的计算，进而生成源树路由条目（S,G）；这样的行为可能导致路由器维护比较多的源树路由条目（S,G），造成一定的系统和网络资源的占用。Bidirectional PIM (Bidir-PIM)即双向PIM属于PIM-SM的一个分支和扩展技术，能够优化PIM-SM单向树所导致的资源占用问题。
</code></pre><p></p>
<p><span style="color:black; font-family:宋体"><span style="font-size:10pt">在Bidir-PIM运行模式下，无需建立任何源树条目（S，G），所有的组播流量都使用共享树转发（*，G），在该模式下，没有任何源注册消息，组播源和接收者都加入到同一棵共享树。</span><span style="font-size:12pt"> Bidir-PI基本術語</span><span style="font-size:10pt"></span></span></p>
<pre><code>                    &lt;/span&gt;&lt;/span&gt;
</code></pre></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:Arial">MulticastRouting Information Base (MRIB)pim</span><span style="font-family:宋体">协议根据单播路由表计算的到</span><span style="font-family:Arial">RP</span><span style="font-family:宋体">的组播共享树路径。</span></span><span style="font-family:Arial; font-size:10pt"><br>                </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt">RendezvousPoint Address (RPA)</span><span style="font-size:10pt"><br>                </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt">RendezvousPoint Link (RPL)<span style="font-family:宋体">，即</span>RP<span style="font-family:宋体">的直连链路</span></span><span style="font-size:10pt"><br>                </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:Arial">DesignatedForwarder (DF)   </span><span style="font-family:宋体">替代了</span><span style="font-family:Arial">DR</span><span style="font-family:宋体">，同时也是一种防环机制</span><span style="font-family:Arial"> </span><span style="font-family:宋体">除了</span><span style="font-family:Arial">RPL</span><span style="font-family:宋体">外（</span><span style="font-family:Arial">RPL</span><span style="font-family:宋体">不选举</span><span style="font-family:Arial">DF</span><span style="font-family:宋体">）</span><span style="font-family:Arial">,</span><span style="font-family:宋体">在组播域中的每条链路都会自动选举一个唯一的</span><span style="font-family:Arial">DF</span><span style="font-family:宋体">路由器，选举原则为对比同一条链路的每个接口到</span><span style="font-family:Arial">RP</span><span style="font-family:宋体">的单播路径，</span><span style="font-family:Arial"> </span><span style="font-family:宋体">具有最佳路径的接口的路由器被选为</span><span style="font-family:Arial">DF</span><span style="font-family:宋体">。</span><span style="font-family:Arial">DF</span><span style="font-family:宋体">负责转发该链路</span><span style="font-family:Arial"> </span><span style="font-family:宋体">的组播流量，也负责处理来自下游路由器的共享树加入消息</span></span><span style="font-family:Arial; font-size:10pt"><br>                </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:Arial">RPFInterface  :</span><span style="font-family:宋体">每个路由器去往</span><span style="font-family:Arial">RP</span><span style="font-family:宋体">的最佳路径的接口，是与</span><span style="font-family:Arial">DF</span><span style="font-family:宋体">直连的接口。</span></span><span style="font-family:Arial; font-size:10pt"><br>                </span></span></div>

<p><span style="color:black; font-size:10pt">Bidir-PIM<span style="font-family:宋体">组播路由的状态对于每个特定的组和</span>RP<span style="font-family:宋体">，在每个路由器建立以下的组播转发路径：</span></span></p>
<pre><code>        &lt;/span&gt;
</code></pre></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">从组播源到</span><span style="font-family:Arial">RP</span><span style="font-family:宋体">的转发路径，沿着</span><span style="font-family:Arial">RPF</span><span style="font-family:宋体">接口转发到</span><span style="font-family:Arial">RP</span><span style="font-family:宋体">。</span></span><span style="font-family:Arial; font-size:10pt"><br>                </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">从</span>RP<span style="font-family:宋体">到组播接收者的转发路径，或者从组播源直接转发到接收者的路径</span></span><span style="font-size:10pt"><br>                </span></span></div>

<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">按照以上方法建立转发路径，组播路由表项：</span></span></p>
<pre><code>        &lt;/span&gt;
</code></pre></li>
<li><div style="background: white"><span style="color:black"><span style="font-family:宋体; font-size:9pt">仅仅有（*，G），falg为B</span><span style="font-family:Arial; font-size:10pt"><br>                </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-family:宋体; font-size:9pt">没有入接口，只有Bidir-Upstream，去往RP</span><span style="font-family:Arial; font-size:10pt"><br>                </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-family:宋体; font-size:9pt">出站接口列表：forward代表把流量转发给接收者；Bidir-Upstream代表拷贝自上行流量接口。</span><span style="font-family:Arial; font-size:10pt"><br>                </span></span></div>

<p><span style="color:black; font-size:10pt"><span style="font-family:Arial">Bidir-PIM</span><span style="font-family:宋体">的对组播包的转发</span><span style="font-family:Arial"></span></span></p>
<pre><code>            &lt;/span&gt;&lt;/span&gt;
</code></pre><ol>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">仅仅当一个数据包是来自</span><span style="font-family:Arial">RPF</span><span style="font-family:宋体">接口（从源到</span><span style="font-family:Arial">RP</span><span style="font-family:宋体">方向），或者来自</span><span style="font-family:Arial">DF</span><span style="font-family:宋体">路由器的接口（从</span><span style="font-family:Arial">RP</span><span style="font-family:宋体">到接收者方向）；路由器才会接收该数据包。</span></span><span style="font-family:Arial; font-size:10pt"><br>                    </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-family:宋体; font-size:9pt">路由器开始构建数据包的转发出口，从所有的出站接口列表中删除入站接口，如果出站接口列表不为空，将数据包转发给其它所有的出站接口。</span><span style="font-size:10pt"><br>                    </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">如果源与</span>RP<span style="font-family:宋体">在同一侧，直接发送给接受者</span></span><span style="font-size:10pt"><br>                    </span></span></div>

</li>
</ol>
<p><span style="color:black; font-size:10pt">Server1<span style="font-family:宋体">配置：</span></span></p>
<pre><code>                &lt;/span&gt;
</code></pre><p><span style="color:black; font-size:10pt">Server#conf t<br></span></p>
<p><span style="color:black; font-size:10pt">Server(config)#no ip routiiing<br></span></p>
<p><span style="color:black; font-size:10pt">Server(config)#ip default-gateway 192.168.1.1<br></span></p>
<p><span style="color:black; font-size:10pt">Server(config)#int e0/0<br></span></p>
<p><span style="color:black; font-size:10pt">Server(config-if)#ip add 192.168.1.2 255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">Server(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">Server(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R1<span style="font-family:宋体">配置：</span></span></p>
<pre><code>                &lt;/span&gt;
</code></pre><p><span style="color:black; font-size:10pt">R1#conf t<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#ip multicast-routing<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#ip pim bidir-enable<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#ip pim rp-address 3.3.3.3 bidir<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#int e0/0<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip add 192.168.1.1255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#exitp<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#int e0/1<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip add 192.168.12.1255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#int e0/2<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip add 192.168.13.1255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#router ospf 1<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-router)#net 0.0.0.0 0.0.0.0 area 0<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-router)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R2<span style="font-family:宋体">配置：</span></span></p>
<pre><code>                &lt;/span&gt;
</code></pre><p><span style="color:black; font-size:10pt">R2#conf t<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#ip multicast-routing<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#ip pim bidir-enable<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#ip pim rp-address 3.3.3.3 bidir<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#int e0/0<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ip add 192.168.12.2255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#int e0/1<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ip add 192.168.24.2 255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#router ospf 1<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-router)#net 0.0.0.0 0.0.0.0 area 0<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-router)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R3<span style="font-family:宋体">配置：</span></span></p>
<pre><code>                &lt;/span&gt;
</code></pre><p><span style="color:black; font-size:10pt">R3#conf t<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#ip multicast-routing<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#ip pim bidir-enable<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#ip pim rp-address 3.3.3.3 bidir<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#int e0/0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip add 192.168.13.3255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#int e0/1<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip add 192.168.34.3255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#int lo0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip add 3.3.3.3 255.255.255.255<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#router ospf 1<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#net 0.0.0.0 0.0.0.0 area 0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R4<span style="font-family:宋体">配置：</span></span></p>
<pre><code>                &lt;/span&gt;
</code></pre><p><span style="color:black; font-size:10pt">R4#conf t<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#ip multicast-routing<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#ip pim bidir-enable<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#ip pim rp-address 3.3.3.3 bidir<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#int e0/0<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip add 192.168.24.4255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#int e0/1<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip add 192.168.34.4255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#int e0/2<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip add 192.168.0.1255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#router ospf 1<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-router)#net 0.0.0.0 0.0.0.0 area 0<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-router)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">PC<span style="font-family:宋体">配置：</span></span></p>
<pre><code>                &lt;/span&gt;
</code></pre><p><span style="color:black; font-size:10pt">PC#conf t<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config)#no ip routing<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config)#ip default-gateway 192.168.0.1<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config)#int e0/0<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config-if)#ip add 192.168.0.2255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config-if)#ip igmp join-group 224.1.1.1<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config-if)#exit<br></span></p>
</li>
</ol>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">配置完成后观察</span>R3<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3# debug ip pim<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><em>Mar 1 00:09:36.027: PIM(0): Join-list: (</em>, 224.1.1.1), RPT-bit set, WC-bitset<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><em>Mar 1 00:09:36.031: PIM(0): Check RP 3.3.3.3 into the (</em>, 224.1.1.1) entry<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><em>Mar 1 00:09:36.031: PIM(0): Add Ethernet0/1/192.168.34.4 to (</em>, 224.1.1.1),Forward state, by PIM *G Join<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:12:38.171: PIM(0): Received v2 Join/Prune on Ethernet0/0 from192.168.13.1, to us<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><em>Mar 1 00:12:38.171: PIM(0): Join-list: (</em>, 224.0.1.40), RPT-bit set, WC-bitset, S-bit set<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><em>Mar 1 00:12:38.171: PIM(0): Update Ethernet0/0/192.168.13.1 to (</em>,224.0.1.40), Forward state, by PIM *G Join<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:10:34.471: PIM(0): Received v2 Join/Prune on Ethernet0/1 from192.168.34.4, to us<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><em>Mar 1 00:10:34.471: PIM(0): Join-list: (</em>, 224.1.1.1), RPT-bit set, WC-bitset, S-bit set<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><em>Mar 1 00:10:34.475: PIM(0): Update Ethernet0/1/192.168.34.4 to (</em>,224.1.1.1), Forward state, by PIM *G Join<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:10:34.795: PIM(0): Building Periodic Join/Prune message for224.1.1.1<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R3#ship mroute<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">IPMulticast Routing Table<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Flags:D - Dense, S - Sparse, B - Bidir Group, s - SSM Group, C - Connected,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       L - Local, P - Pruned, R - RP-bit set, F- Register flag,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       T - SPT-bit set, J - Join SPT, M - MSDPcreated entry,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       X - Proxy Join Timer Running, A -Candidate for MSDP Advertisement,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       U - URD, I - Received Source SpecificHost Report,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       Z - Multicast Tunnel, z - MDT-data groupsender,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       Y - Joined MDT-data group, y - Sendingto MDT-data group<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Outgoinginterface flags: H - Hardware switched, A - Assert winner<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> Timers: Uptime/Expires<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> Interface state: Interface, Next-Hop or VCD,State/Mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">(*, 224.1.1.1),00:05:49/00:02:35, RP 3.3.3.3, flags: B<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">  Bidir-Upstream: Null, RPF nbr 0.0.0.0<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">  Outgoing interface list:<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">    Ethernet0/1, Forward/Sparse,00:05:49/00:02:35<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">(*,224.0.1.40), 00:14:17/00:02:41, RP 3.3.3.3, flags: BCL<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">  Bidir-Upstream: Null, RPF nbr 0.0.0.0<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">  Outgoing interface list:<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">    Ethernet0/1, Forward/Sparse,00:09:11/00:02:41<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Ethernet0/0, Forward/Sparse,00:13:16/00:02:38<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">R4#ship mroute<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">IPMulticast Routing Table<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Flags:D - Dense, S - Sparse, B - Bidir Group, s - SSM Group, C - Connected,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       L - Local, P - Pruned, R - RP-bit set, F- Register flag,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       T - SPT-bit set, J - Join SPT, M - MSDPcreated entry,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       X - Proxy Join Timer Running, A -Candidate for MSDP Advertisement,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       U - URD, I - Received Source SpecificHost Report,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       Z - Multicast Tunnel, z - MDT-data groupsender,<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">       Y - Joined MDT-data group, y - Sendingto MDT-data group<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Outgoinginterface flags: H - Hardware switched, A - Assert winner<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> Timers: Uptime/Expires<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"> Interface state: Interface, Next-Hop or VCD,State/Mode<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">(*, 224.1.1.1),00:07:23/00:02:35, RP 3.3.3.3, flags: BC<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">  Bidir-Upstream: Ethernet0/1, RPF nbr192.168.34.3<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">  Outgoing interface list:<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">    Ethernet0/2, Forward/Sparse,00:07:23/00:02:35<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:red; font-size:10pt">    Ethernet0/1, Bidir-Upstream/Sparse,00:07:23/00:00:00<span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">(*,224.0.1.40), 00:12:13/00:02:25, RP 3.3.3.3, flags: BCL<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">  Bidir-Upstream: Ethernet0/1, RPF nbr192.168.34.3<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">  Outgoing interface list:<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">    Ethernet0/0, Forward/Sparse,00:10:48/00:02:22<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Ethernet0/1, Bidir-Upstream/Sparse,00:10:49/00:00:00<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Server#ping224.1.1.1 repeat 100<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Typeescape sequence to abort.<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Sending100, 100-byte ICMP Echos to 224.1.1.1, timeout is 2 seconds:<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">..<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Replyto request 2 from 192.168.0.2, 104 ms<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Replyto request 3 from 192.168.0.2, 144 ms<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Replyto request 4 from 192.168.0.2, 164 ms<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt">Replyto request 5 from 192.168.0.2, 128 ms<span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">在</span>Bidir-PIM<span style="font-family:宋体">模式下，所有的组播路由器首先以</span>RP<span style="font-family:宋体">为根构建一棵共享树，连接组播接收者的路由器动态的沿着</span>RPF<span style="font-family:宋体">路径向</span>RP<span style="font-family:宋体">发送加入或修剪消息，将动态的生成一个用于流量转发的子树（是共享树的一个子集），任何的组播源都可以直接将流量转发给</span>RP<span style="font-family:宋体">，或者一个下游邻居（下游邻居必须先加入到共享树），除了</span>RP<span style="font-family:宋体">路由器外，其它路由器都在每条链路上选举</span>DF<span style="font-family:宋体">路由器，最终每个路由器都根据流量的入站接口，动态计算一个出站接口列表，实现准确的组播数据包的转发。</span> <span style="font-family:宋体">在所有的组播路由器上，不使用也不建立任何的源树转发条目（</span>S,G<span style="font-family:宋体">），减少了组播路由协议对系统和网络资源的占用。</span><span style="font-family:Arial"><br>            </span></span></p>
<p><span style="color:#0d0d0d"><span style="font-size:14pt"><strong><span style="font-family:宋体">实验七、</span>PIM-SSM<span style="font-family:宋体">（指定信源组播）</span></strong></span><span style="color:black; font-family:Arial; font-size:10pt"><br>            </span></span></p>
<p><img src="http://www.madhex.com/wp-content/uploads/2016/05/051016_0624_CCNP7.jpg" alt=""><span style="color:black; font-family:Arial; font-size:10pt"><br>        </span></p>
<p><span style="color:#0d0d0d; font-size:10pt">SSM<span style="font-family:宋体">（</span>Source-Specific Multicast<span style="font-family:宋体">，指定信源组播）模型和</span>ASM<span style="font-family:宋体">（</span>Any-Source Multicast<span style="font-family:宋体">，任意信源组播）模型是两个完全对等的模型。目前，</span>ASM<span style="font-family:宋体">模型包括</span>PIM-DM<span style="font-family:宋体">和</span>PIM-SM<span style="font-family:宋体">两种模式；</span>SSM<span style="font-family:宋体">模型能够借助</span>PIM-SM<span style="font-family:宋体">的部分技术来实现。</span>SSM<span style="font-family:宋体">模型为指定源组播提供了解决方案，通过</span>IGMPv3<span style="font-family:宋体">来维护主机与路由器之间的关系。鉴于</span>PIM-DM<span style="font-family:宋体">模式以扩散</span>/<span style="font-family:宋体">剪枝方式构建以组播源为根的</span>SPT<span style="font-family:宋体">，虽然</span>SPT<span style="font-family:宋体">的路径最短，但是分发树的建立过程效率较低，不适合大中型网络。在实际应用中，通常采用PIM-SM模式的一部分技术来实现SSM模型。由于接收者已经通过其它渠道（如广告咨询等）知道了组播源的具体位置，因此在SSM模型中无需RP，无需构建RPT，无需源注册过程，也无需通过MSDP（Multicast Source Discovery Protocol，组播源发现协议）来发现其它PIM域内的组播源。因此PIM-SSM适合于点到多点的服务</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<p><span style="color:#0d0d0d; font-size:10pt"><span style="font-family:宋体">与ASM模型相比，SSM模型仅需要IGMPv3和PIM-SM部分子集的支持。构建为PIM-SM服务的RPT，还是构建为PIM-SSM服务的SPT，关键在于接收者准备加入的组播组是否属于SSM组地址范围（默认为232.0.0.0～232.255.255.255）。如果用户对组播源S的信息感兴趣，则借助IGMPv3的报告报文向最近的DR路由器报告自己对特定源S的信息感兴趣，标记为（include S，G）；或报告对除特定源S外的其它组播源的信息感兴趣，则标记为（exclude S，G）。无论如何描述，都表示特定源S的位置对接收者是明确指定的。接收到该报文的DR先判断该报文中的组地址是否在SSM组地址范围内：如果在范围内则构建PIM-SSM，并向特定源S逐跳发送通道的订阅报文。沿途所有路由器上都创建（Include S，G）或（ExcludeS，G）表项，从而在网络内构建了一棵以指定组播源S为根，以接收者为叶子节点的SPT，该树就是PIM-SSM中的传输通道；如果不在范围内，则仍旧按照PIM-SM的流程进行后续处理，此时DR需要向RP发送（*，G）加入报文，同时需要进行组播源的注册。在配置过程中，请注意以下几点：</span><span style="color:black; font-family:Arial"><br>            </span></span></p>
<ol>
<li><div style="background: white"><span style="color:#0d0d0d; font-size:10pt"><span style="font-family:宋体">如果没有配置SSM的组地址，默认为232.0.0.0～232.255.255.255；</span><span style="color:black; font-family:Arial"><br>                </span></span></div></li>
<li><div style="background: white"><span style="color:#0d0d0d; font-size:10pt"><span style="font-family:宋体">必须使用IGMPv3指定源加入；</span><span style="color:black"><br>                </span></span></div></li>
<li><div style="background: white"><span style="color:#0d0d0d; font-size:10pt"><span style="font-family:宋体">目前不支持以exclude模式加入组</span><span style="color:black"><br>                </span></span></div>

</li>
</ol>
<p><span style="color:black; font-size:10pt">Server1<span style="font-family:宋体">配置：</span><br>                </span></p>
<p><span style="color:black; font-size:10pt">Server1#conf t<br></span></p>
<p><span style="color:black; font-size:10pt">Server1(config)#no ip routing<br></span></p>
<p><span style="color:black; font-size:10pt">Server1(config)#int e0/0<br></span></p>
<p><span style="color:black; font-size:10pt">Server1(config-if)#ip add 192.168.1.2255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">Server1(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">Server1(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">Server1(config)#ip default-gateway192.168.1.1<br></span></p>
<p><span style="color:black; font-size:10pt">Server2<span style="font-family:宋体">配置：</span><br>                </span></p>
<p><span style="color:black; font-size:10pt">Server2#conf<br></span></p>
<p><span style="color:black; font-size:10pt">Server2(config)#no ip routing<br></span></p>
<p><span style="color:black; font-size:10pt">Server2(config)#ip default-gateway192.168.2.1<br></span></p>
<p><span style="color:black; font-size:10pt">Server2(config)#int e0/0<br></span></p>
<p><span style="color:black; font-size:10pt">Server2(config-if)#ip add 192.168.2.2255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">Server2(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">Server2(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R3<span style="font-family:宋体">配置：</span><br>                </span></p>
<p><span style="color:black; font-size:10pt">R3#conf t<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#ip multicast-routing<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#ip pim ssm default<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#int e0/0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip add 192.168.1.1255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip igmp version 3<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#int e0/1<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip add 192.168.2.1255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip igmp ver 3<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#int e0/2<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip add 192.168.34.1255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip igmp ver 3<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#router ospf 1<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#net 0.0.0.0 0.0.0.0area 0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R4<span style="font-family:宋体">配置：</span><br>                </span></p>
<p><span style="color:black; font-size:10pt">R4#conf t<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#ip multicast-routing<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#ip pim ssm default //<span style="font-family:宋体">开启指定信源组播模式</span><br>                </span></p>
<p><span style="color:black; font-size:10pt">R4(config)#access-list 1 permit232.1.1.1 //<span style="font-family:宋体">标记组播组地址</span><br>                </span></p>
<p><span style="color:black; font-size:10pt">R4(config)#ip igmp ssm-map enable //<span style="font-family:宋体">开启</span>SSM<span style="font-family:宋体">映射功能</span><br>                </span></p>
<p><span style="color:black; font-size:10pt">R4(config)#ip igmp ssm-map static 1192.168.1.2//<span style="font-family:宋体">建立组播组与信源的映射</span><br>                </span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip add 192.168.34.4255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip igmp ver 3<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#int e0/1<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip add 192.168.0.1255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip pim sparse-moder<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip igmp ver 3<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#router ospf 1<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-router)#net 0.0.0.0 0.0.0.0area 0<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-router)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">PC<span style="font-family:宋体">配置：</span><br>                </span></p>
<p><span style="color:black; font-size:10pt">PC#conf t<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config)#no ip routing<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config)#ip default-gateway192.168.0.1<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config)#int e0/0<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config-if)#ip add 192.168.0.2255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config-if)#ip igmp join-group232.1.1.1 source 192.168.1.2 //<span style="font-family:宋体">加入组播组，并指定组播信源</span><br>                </span></p>
<p><span style="color:black; font-size:10pt">PC(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">检查网络联通性，然后观察</span>R4<br></span></p>
<p><span style="color:black; font-size:10pt">R4#sh ip mroute<br></span></p>
<p><span style="color:black; font-size:10pt">IP Multicast Routing Table<br></span></p>
<p><span style="color:black; font-size:10pt">Flags: D - Dense, S - Sparse, B - BidirGroup, s - SSM Group, C - Connected,<br></span></p>
<p><span style="color:black; font-size:10pt">      L - Local, P - Pruned, R - RP-bit set, F - Register flag,<br></span></p>
<p><span style="color:black; font-size:10pt">      T - SPT-bit set, J - Join SPT, M - MSDP created entry,<br></span></p>
<p><span style="color:black; font-size:10pt">      X - Proxy Join Timer Running, A - Candidate for MSDP Advertisement,<br></span></p>
<p><span style="color:black; font-size:10pt">      U - URD, I - Received Source Specific Host Report,<br></span></p>
<p><span style="color:black; font-size:10pt">      Z - Multicast Tunnel, z - MDT-data group sender,<br></span></p>
<p><span style="color:black; font-size:10pt">      Y - Joined MDT-data group, y - Sending to MDT-data group<br></span></p>
<p><span style="color:black; font-size:10pt">Outgoing interface flags: H - Hardwareswitched, A - Assert winner<br></span></p>
<p><span style="color:black; font-size:10pt"> Timers: Uptime/Expires<br></span></p>
<p><span style="color:black; font-size:10pt"> Interface state: Interface, Next-Hop or VCD,State/Mode<br></span></p>
<p><span style="color:red; font-size:10pt">(192.168.1.2,232.1.1.1), 00:04:04/00:02:57, flags: sTI<span style="color:black"><br>                    </span></span></p>
<p><span style="color:red; font-size:10pt">  Incoming interface: Ethernet0/0, RPF nbr192.168.34.1<span style="color:black"><br>                    </span></span></p>
<p><span style="color:red; font-size:10pt">  Outgoing interface list:<span style="color:black"><br>                    </span></span></p>
<p><span style="color:red; font-size:10pt">    Ethernet0/1, Forward/Sparse,00:04:04/00:02:57<span style="color:black"><br>                    </span></span></p>
<p><span style="color:black; font-size:10pt">(*, 224.0.1.40), 00:16:11/00:02:28, RP0.0.0.0, flags: DCL<br></span></p>
<p><span style="color:black; font-size:10pt"> Incoming interface: Null, RPF nbr 0.0.0.0<br></span></p>
<p><span style="color:black; font-size:10pt"> Outgoing interface list:<br></span></p>
<p><span style="color:black; font-size:10pt">   Ethernet0/0, Forward/Sparse, 00:16:11/00:02:28<br></span></p>
<p><span style="color:black; font-size:10pt">R4#sh ip igmp groups<br></span></p>
<p><span style="color:black; font-size:10pt">IGMP Connected Group Membership<br></span></p>
<p><span style="color:black; font-size:10pt">Group Address    Interface                Uptime    Expires  Last Reporter   Group Accounted<br></span></p>
<p><span style="color:black; font-size:10pt">232.1.1.1        Ethernet0/1              00:03:04  00:02:03 192.168.0.2<br></span></p>
<p><span style="color:black; font-size:10pt">224.0.1.40       Ethernet0/0              00:09:16  00:02:31 192.168.34.4<br></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">接着在</span>Server1 <span style="font-family:宋体">和</span>Server2<span style="font-family:宋体">分别</span>ping 232.1.1.1<span style="font-family:宋体">组播组地址观察结果：</span><br>                </span></p>
<p><span style="color:black; font-size:10pt">Server1#ping 232.1.1.1 repeat 100<span style="color:red"> //Server1 <span style="font-family:宋体">可以通信</span><span style="color:black"><br>                        </span></span></span></p>
<p><span style="color:black; font-size:10pt">Type escape sequence to abort.<br></span></p>
<p><span style="color:black; font-size:10pt">Sending 100, 100-byte ICMP Echos to232.1.1.1, timeout is 2 seconds:<br></span></p>
<p><span style="color:black; font-size:10pt">Reply to request 0 from 192.168.0.2, 76ms<br></span></p>
<p><span style="color:black; font-size:10pt">Reply to request 1 from 192.168.0.2, 56ms<br></span></p>
<p><span style="color:black; font-size:10pt">Server2#ping 232.1.1.1 repeat 100 <span style="color:red">//Server2<span style="font-family:宋体">不可以</span><span style="color:black"><br>                        </span></span></span></p>
<p><span style="color:black; font-size:10pt">Type escape sequence to abort.<br></span></p>
<p><span style="color:black; font-size:10pt">Sending 100, 100-byte ICMP Echos to232.1.1.1, timeout is 2 seconds:<br></span></p>
<p><span style="color:black; font-size:10pt">…………………………………………..<br></span></p>
<p><span style="color:black"><span style="font-size:14pt"><strong><span style="font-family:宋体">实验八、域间组播</span>PIM-SM<span style="font-family:宋体">结合</span>MSDP<span style="font-family:宋体">与</span>MBGP</strong></span><span style="font-size:10pt"><br>                    </span></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">  当网络跨越了公网，或者网络需要各自独立时，如果每个独立的网络，或者是每个</span>AS<span style="font-family:宋体">之间都需要组播通信的情况下，我们需要在不影响网络独立的前提下连通网络间的组播。各个独立的网络中，又希望自己的组播路由器可以由自己完全控制，那么就需要将各个网络配置成独立的</span>PIM-SM<span style="font-family:宋体">域。要将不同的</span>PIM-SM<span style="font-family:宋体">域之间连通组播，就必须先有正常的组播树，而</span>PIM-SM<span style="font-family:宋体">组播树的建立，必须了解到网络中的</span>RP<span style="font-family:宋体">信息，以及组播源的位置。   此时</span>MSDP<span style="font-family:宋体">出现了，</span>MSDP<span style="font-family:宋体">组播源发现协议</span>(MulticastSourceDiscoveryProtocol)<span style="font-family:宋体">描述了一种连接多</span>PIM-SM(PIM-SM<span style="font-family:宋体">：</span>PIMSparseMode)<span style="font-family:宋体">域的机制。每种</span>PIM-SM<span style="font-family:宋体">域都使用自己独立的</span>RP<span style="font-family:宋体">，它并不依赖于其它域内的</span>RP<span style="font-family:宋体">。</span>PIM-SM<span style="font-family:宋体">域内的</span>MSDP<span style="font-family:宋体">发话路由器与其它域内的</span>MSDP<span style="font-family:宋体">对等设备之间存在一种</span>MSDP<span style="font-family:宋体">对等关系，这种关系通过</span>TCP<span style="font-family:宋体">连接形成，在其中控制信息进行交换。每个域都有一个或多个连接到这个虚拟拓扑结构。这种拓朴结构使得域能从其它域发现组播源。如果组播源想知道含有接收端的域，那么</span>PIM-SM<span style="font-family:宋体">中的标准源树建立机制就会被用于在域内分配树上传送组播数据。</span>MSDP<span style="font-family:宋体">使用</span>TCP639<span style="font-family:宋体">端口建立对等连接</span>(<span style="font-family:宋体">高</span>ip<span style="font-family:宋体">侦听，低</span>ip<span style="font-family:宋体">连接</span>)<span style="font-family:宋体">，和</span>BGP<span style="font-family:宋体">一样，对等间连接必须明确配置，当</span>PIMDR<span style="font-family:宋体">在</span>RP<span style="font-family:宋体">注册源时，</span>RP<span style="font-family:宋体">向所有的</span>MSDP<span style="font-family:宋体">对等体发送源激活消息，然后其他</span>MSDP<span style="font-family:宋体">路由器将</span>SA<span style="font-family:宋体">泛洪。域内的组播路由和组播源信息收集工作由</span> PIM-SM <span style="font-family:宋体">完成，</span> MBGP  <span style="font-family:宋体">负责域间传播具有组播拓扑的信息，</span>MSDP <span style="font-family:宋体">负责传播组播源信息。这种方案要求所有的自治域都支持</span>  PIM-SM<span style="font-family:宋体">、</span>MBGP<span style="font-family:宋体">和</span>MSDP<span style="font-family:宋体">。在</span>PIM-SM  /  MBGP  /  MSDP  <span style="font-family:宋体">组合方案中，自治域边界路由器之间配置外部</span>  MBGP <span style="font-family:宋体">对等，</span>RP <span style="font-family:宋体">之间配置外部</span> MSDP <span style="font-family:宋体">对等；自治域内部路由器之间根据需要配置内部</span> MBGP <span style="font-family:宋体">对等；内部</span> RP<span style="font-family:宋体">之间配置内部</span>  MSDP  <span style="font-family:宋体">对等，实现</span>Anycast  RP<span style="font-family:宋体">。该优点在於</span><br>                </span></p>
<ol>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">不存在第三方</span>(Third-party)<span style="font-family:宋体">资源依赖域内</span>RP<span style="font-family:宋体">。</span> <span style="font-family:Times New Roman">msdp</span><span style="font-family:宋体">使得一个</span><span style="font-family:Times New Roman">pim-sm</span><span style="font-family:宋体">域不需要依赖另一个</span><span style="font-family:Times New Roman">pim-sm</span><span style="font-family:宋体">域内的</span><span style="font-family:Times New Roman">rp</span><span style="font-family:宋体">，因为在得到另一个</span><span style="font-family:Times New Roman">pim-sm</span><span style="font-family:宋体">域内的组播源信息之后，一个</span><span style="font-family:Times New Roman">pim-sm</span><span style="font-family:宋体">域里的接收者可以不通过另一</span><span style="font-family:Times New Roman">pim-sm</span><span style="font-family:宋体">域里的</span><span style="font-family:Times New Roman">rp</span><span style="font-family:宋体">而直接加入到这个域内组播源的</span><span style="font-family:Times New Roman">spt</span><span style="font-family:宋体">上。</span></span><span style="font-size:10pt"><br>                </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt">PIM-SM<span style="font-family:宋体">域只依靠本身的</span>RP<span style="font-family:宋体">。</span> </span><span style="font-size:10pt"><br>                </span></span></div></li>
<li><div style="background: white"><span style="color:black"><span style="font-size:9pt"><span style="font-family:宋体">接收端域：只带接受端的域可以获取数据而不用全局通告组成员。</span>MSDP<span style="font-family:宋体">可以和其它非</span>PIM-SM<span style="font-family:宋体">协议一起使用。</span></span><span style="font-size:10pt"><br>                </span></span></div>

<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">在不同的</span>PIM-SM<span style="font-family:宋体">域之间建立</span>MSDP<span style="font-family:宋体">连接时，是使用</span>TCP 639<span style="font-family:宋体">，</span><span style="font-family:Times New Roman"> </span>IP<span style="font-family:宋体">地址高的初始化</span>TCP<span style="font-family:宋体">连接，</span>60<span style="font-family:宋体">秒一次</span>keepalive,75<span style="font-family:宋体">秒后没数据或</span>keepalive<span style="font-family:宋体">则重建</span>TCP<span style="font-family:宋体">。建立连接的双方均是各自区域的</span>RP<span style="font-family:宋体">，组播源向</span>RP<span style="font-family:宋体">注册之后，那么</span>RP<span style="font-family:宋体">将这些源信息通过在</span>MSDP<span style="font-family:宋体">连接上发送</span>Source-Active (SA)<span style="font-family:宋体">到远程</span>RP<span style="font-family:宋体">，以提供组播源的信息。因为</span>RP<span style="font-family:宋体">收到</span>Source-Active (SA)<span style="font-family:宋体">后，也是要做</span>RPF<span style="font-family:宋体">检测的，检测是根据</span>BGP<span style="font-family:宋体">来做的，在这里，需要使用</span>MBGP<span style="font-family:宋体">之组播协议，组成员的网络信息和建立</span>MSDP<span style="font-family:宋体">连接的</span>peer<span style="font-family:宋体">地址理论上都需要在</span>MBGP<span style="font-family:宋体">中进行通告，一是防止</span>RPF<span style="font-family:宋体">检测失败，二是由此来决定组播数据的传递，所以十分重要。</span><span style="font-family:Times New Roman">MBGP</span><span style="font-family:宋体">（多协议边界网关协议）增加了</span><span style="font-family:Times New Roman"> BGP </span><span style="font-family:宋体">的性能，使其能在整个因特网上组播路由策略，并能够在</span><span style="font-family:Times New Roman"> BGP </span><span style="font-family:宋体">自治系统内或之间连接组播拓朴。换句话说，</span><span style="font-family:Times New Roman"> MBGP </span><span style="font-family:宋体">可以说是增强版的携带</span><span style="font-family:Times New Roman"> IP </span><span style="font-family:宋体">组播路由的</span><span style="font-family:Times New Roman"> BGP</span><span style="font-family:宋体">（不仅限于此）。</span><span style="font-family:Times New Roman">BGP </span><span style="font-family:宋体">携带了两组路由，一组是提供单播路由，另一组是提供组播路由。协议独立组播（</span><span style="font-family:Times New Roman">PIM</span><span style="font-family:宋体">）使用连接组播路由的路由器建立数据分配树。当需要链接仅用于组播通信，或限制通信的资源使用时；也可能当网络访问点需要交换所有的组播通信时，</span><span style="font-family:Times New Roman">MBGP </span><span style="font-family:宋体">都是非常有用的。</span><span style="font-family:Times New Roman">MBGP </span><span style="font-family:宋体">允许单播路由拓朴不同于组播路由拓朴。</span></span></p>
<pre><code>        &lt;/span&gt;
</code></pre></li>
</ol>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman"> </span><span style="font-family:宋体">但是在</span>PIM-SM<span style="font-family:宋体">域之间没有开启</span>MBGP<span style="font-family:宋体">，就会有</span>RPF<span style="font-family:宋体">检测失败的危险，失败后，</span>Source-Active (SA)<span style="font-family:宋体">将被丢弃，所以要想在不开启</span>MBGP<span style="font-family:宋体">的情况下，又要接收所有的</span>Source-Active (SA)<span style="font-family:宋体">，则将接收端配置成</span>default MSDP,<span style="font-family:宋体">那么该域将接收任何</span>SA<span style="font-family:宋体">信息。在配置</span>default MSDP<span style="font-family:宋体">时，需要指定从何处接收</span>SA<span style="font-family:宋体">，就需要指定对端</span>MSDP peer<span style="font-family:宋体">，使用</span>ip msdp default-peer<span style="font-family:宋体">指定，之后从对端过来的</span>SA<span style="font-family:宋体">将不做</span>RPF<span style="font-family:宋体">检测而完全被接收。</span><br>                </span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">在配置</span>MSDP peer<span style="font-family:宋体">时，可以指定</span>originator-id<span style="font-family:宋体">，此</span>ID<span style="font-family:宋体">即在</span>SA<span style="font-family:宋体">中写出</span>RP<span style="font-family:宋体">的地址，也可以不配。必须的配置只是</span>msdp peer<span style="font-family:宋体">，且</span><span style="font-family:Verdana"> MSDP</span><span style="font-family:宋体">对等体的接口地址与建立</span><span style="font-family:Verdana">MBGP</span><span style="font-family:宋体">对等体的接口地址相同。</span><span style="color:red">MSDP<span style="font-family:宋体">只能在</span>PIM-SM<span style="font-family:宋体">下使用，并且域间建立</span>peer<span style="font-family:宋体">的</span>RP<span style="font-family:宋体">应该是直连的<span style="color:black">。当两个远程网络需要使用组播时，由于中间可以隔了多个网络，也可以利用</span></span>MSDP<span style="color:black"><span style="font-family:宋体">连接在不需要中间网络支持组播的情况下，连通远程网络的组播，所以</span>MSDP<span style="font-family:宋体">类似于组播</span>VPN<span style="font-family:宋体">。但需要解决直连问题，解决的方法可以配置</span>tunnel<span style="font-family:宋体">。</span><br>                        </span></span></span></p>
<p><span style="color:black; font-size:10pt">   <span style="font-family:Times New Roman">  </span><span style="font-family:宋体">在不同的域中配置的</span>RP<span style="font-family:宋体">，被称为<a href="http://www.cisco.com/en/US/docs/ios/12_0t/12_0t7/feature/guide/msdp.html" target="_blank"></a></span>LogicalRP<span style="font-family:Times New Roman"> </span><span style="font-family:宋体">，但在网络中也可以配置多个</span>RP<span style="font-family:宋体">，如果将多个</span>RP<span style="font-family:宋体">配置成同一个地址时，那么多个具有相同地址的</span>RP<span style="font-family:宋体">被称为</span>Anycast RP<span style="font-family:宋体">，而且</span>Anycast RP<span style="font-family:宋体">必须是</span>32<span style="font-family:宋体">位掩码的地址，且需要在单播里通告，各个源和组成员均选用离自己最近的</span>RP,<span style="font-family:Times New Roman"> </span><span style="font-family:宋体">从而提供冗余功能。所有</span>Anycast RP<span style="font-family:宋体">都要配置成</span>MSDP peers,<span style="font-family:宋体">每个注册的消息，都传给所有</span>RP<br></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman">msdp</span><span style="font-family:宋体">另一个应用是</span><span style="font-family:Times New Roman">anycast rp</span><span style="font-family:宋体">。在一个域内，用同一个</span><span style="font-family:Times New Roman">ip</span><span style="font-family:宋体">地址配置不同的路由器上的某一接口（通常是</span><span style="font-family:Times New Roman">loopback</span><span style="font-family:宋体">接口），同时，配置这些路由器上这个接口为候选</span><span style="font-family:Times New Roman">rp</span><span style="font-family:宋体">，并在这些</span><span style="font-family:Times New Roman">rp</span><span style="font-family:宋体">之间建立</span><span style="font-family:Times New Roman">msdp</span><span style="font-family:宋体">对等体关系。单播路由收敛后，组播源可以选择最近的</span><span style="font-family:Times New Roman">rp</span><span style="font-family:宋体">注册，接收者也可以选择最近的</span><span style="font-family:Times New Roman">rp</span><span style="font-family:宋体">加入其</span><span style="font-family:Times New Roman">rpt</span><span style="font-family:宋体">。这些</span><span style="font-family:Times New Roman">rp</span><span style="font-family:宋体">之间通过</span><span style="font-family:Times New Roman">msdp</span><span style="font-family:宋体">对等体了解对方的注册源信息，最终每个</span><span style="font-family:Times New Roman">rp</span><span style="font-family:宋体">了解到整个域内的所有组播源，这样，每个</span><span style="font-family:Times New Roman">rp</span><span style="font-family:宋体">上的接收者就可以接收到整个域内的所有组播源发出的组播数据。通过向就近的</span><span style="font-family:Times New Roman">rp</span><span style="font-family:宋体">发起注册和</span><span style="font-family:Times New Roman">rpt</span><span style="font-family:宋体">加入，实现</span><span style="font-family:Times New Roman">rp</span><span style="font-family:宋体">的负载分担；一个</span><span style="font-family:Times New Roman">rp</span><span style="font-family:宋体">失效后，其原来注册的源和加入者，又会选择另一个就近的</span><span style="font-family:Times New Roman">rp</span><span style="font-family:宋体">注册和加入，实现了</span><span style="font-family:Times New Roman">rp</span><span style="font-family:宋体">的冗余备份。另外，</span><span style="font-family:Times New Roman">msdp</span><span style="font-family:宋体">通过</span><span style="font-family:Times New Roman">rpf</span><span style="font-family:宋体">检查机制，只接受从正确路径上接收到的</span><span style="font-family:Times New Roman">sa</span><span style="font-family:宋体">消息，避免接受冗余的</span><span style="font-family:Times New Roman">sa</span><span style="font-family:宋体">消息；可以通过配置</span><span style="font-family:Times New Roman">mesh</span><span style="font-family:宋体">全连接组来避免</span><span style="font-family:Times New Roman">sa</span><span style="font-family:宋体">消息在</span><span style="font-family:Times New Roman">msdp</span><span style="font-family:宋体">对等体之间泛滥。</span><br>                </span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:Times New Roman"> </span><span style="font-family:宋体">在</span><span style="font-family:Times New Roman">Anycast RP</span><span style="font-family:宋体">中，</span><span style="font-family:Times New Roman">2</span><span style="font-family:宋体">个或多个</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">在其</span><span style="font-family:Times New Roman">Loopback</span><span style="font-family:宋体">接口上配置相同的</span><span style="font-family:Times New Roman">IP</span><span style="font-family:宋体">地址。</span><span style="font-family:Times New Roman">Anycast RP Loopback</span><span style="font-family:宋体">地址应该配置为</span><span style="font-family:Times New Roman">32</span><span style="font-family:宋体">位掩码，其他路由器必须”知道”这个</span><span style="font-family:Times New Roman">Anycast RP Loopback</span><span style="font-family:宋体">地址是它们的</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">。当然在一台路由器上，</span><span style="font-family:Times New Roman">IP</span><span style="font-family:宋体">路由协议将会自动选择离它最近的</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">；假设网络中的组播源是均匀分布的，那么这些组播源也将均匀地注册到每个</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">上。由于组播源可能注册到一个</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">，而接收方却注册到另一个</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">，我们就需要使用</span><span style="font-family:Times New Roman">MSDP</span><span style="font-family:宋体">在</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">之间交换活动组播源的信息。在</span><span style="font-family:Times New Roman">Anycast RP</span><span style="font-family:宋体">中，所有</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">之间必须配置为</span><span style="font-family:Times New Roman">MSDP</span><span style="font-family:宋体">对等体。当一个组播源向某个</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">注册时，该</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">将通过</span><span style="font-family:Times New Roman">MSDP</span><span style="font-family:宋体">的</span><span style="font-family:Times New Roman">SA</span><span style="font-family:宋体">消息通告给其他</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">，从而使得其他的</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">都知道这个组播源的信息。若某个</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">故障，当</span><span style="font-family:Times New Roman">IP</span><span style="font-family:宋体">路由协议收敛后，其他</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">将会成为该区域新的</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">。而新的组播源将会将会注册到备份</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">（即新的</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">）；同样地，接收方也将使用新的</span><span style="font-family:Times New Roman">RP</span><span style="font-family:宋体">，从而保证连通性。</span><br>                </span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体"> 单个域内的</span>PIM-SM<span style="font-family:宋体">要通信，是建立的（</span>*<span style="font-family:宋体">，</span>G<span style="font-family:宋体">）条目，如果</span>PIM-SM<span style="font-family:宋体">域之间要通信，建立的是</span>(S<span style="font-family:宋体">，</span>G)<span style="font-family:宋体">条目，相当于是距离矢量的路径方式</span><br>                </span></p>
<ol>
<li><div style="background: white"><img src="http://www.madhex.com/wp-content/uploads/2016/05/051016_0624_CCNP8.jpg" alt=""><span style="color:black; font-size:10pt"><br>            </span></div>

</li>
</ol>
<p><span style="color:black; font-size:10pt"><span style="font-family:Arial; background-color:white">                     Server</span><span style="font-family:宋体; background-color:white">配置：</span></span><span style="font-family:宋体; font-size:12pt"><br>        </span></p>
<ol>
<li><div style="background: white"><span style="color:black; font-size:10pt">Server#conf t<br></span></div>

<p><span style="color:black; font-size:10pt">Server(config)#no ip routing<br></span></p>
</li>
</ol>
<p><span style="color:black; font-size:10pt">Server(config)#ip default-gateway192.168.1.1<br></span></p>
<p><span style="color:black; font-size:10pt">Server(config)#int e0/0<br></span></p>
<p><span style="color:black; font-size:10pt">Server(config-if)#ip add 192.168.1.2255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">Server(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">Server(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R1<span style="font-family:宋体">配置：</span><br>                </span></p>
<p><span style="color:black; font-size:10pt">R1#conf t<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#ip multicast-routing<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#int e0/0<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip add 192.168.1.1255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#int e0/1<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip add 192.168.12.1255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#int lo 0<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip add 1.1.1.1255.255.255.255<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#int lo 10<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip add 10.10.10.10255.255.255.255<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#router ospf 1<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-router)#router-id 1.1.1.1<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-router)#net 1.1.1.1 0.0.0.0area 0<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-router)# network 10.10.10.100.0.0.0 area 0<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-router)#net 192.168.12.0255.255.255.0 area 0<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-router)#net 192.168.1.0255.255.255.0 area 0<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-router)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#router bgp 65501<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-router)#bgp router-id 1.1.1.1<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-router)#net 192.168.1.0 mask255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-router)#net 192.168.12.0 mask255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-router)#neighbor 2.2.2.2remote-as 65501 nlri unicast multicast<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-router)#neighbor 2.2.2.2update-source loopback 0<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-router)#neighbor 3.3.3.3remote-as 65501 nlri unicast multicast<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-router)#neighbor 3.3.3.3update-source loopback 0<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config-router)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#ip pim bsr-candidate loopback10<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#ip pim rp-candidate loopback10<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#ip msdp peer 2.2.2.2connect-source loopback 0<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#ip msdp peer 3.3.3.3connect-source loopback 0<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#ip msdp mesh-group anycast-rp2.2.2.2<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#ip msdp mesh-group anycast-rp3.3.3.3<br></span></p>
<p><span style="color:black; font-size:10pt">R1(config)#ip msdp originator-idloopback 0<br></span></p>
<p><span style="color:black; font-size:10pt">R2<span style="font-family:宋体">配置：</span><br>                </span></p>
<p><span style="color:black; font-size:10pt">R2#conf t<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#ip multicast-routing<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#int e0/0<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ip add 192.168.12.2255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#int e0/1<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ip add 192.168.23.2255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#int lo 0<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ip add 2.2.2.2255.255.255.255<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#in lo 10<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ip add 10.10.10.10255.255.255.255<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#router ospf 1<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-router)#router-id 2.2.2.2<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-router)#net 2.2.2.2 0.0.0.0area 0<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-router)#net 10.10.10.100.0.0.0 area 0<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-router)#net 192.168.12.0255.255.255.0 area 0<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-router)#net 192.168.23.0255.255.255.0 area 0<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-router)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#router bgp 65501<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-router)#bgp router-id 2.2.2.2<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-router)#net 192.168.12.0 mask255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-router)#net 192.168.23.0 mask255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-router)#nei 1.1.1.1 remote-as65501 nlri unicast multicast<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-router)#nei 1.1.1.1update-source loopback 0<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-router)#nei 3.3.3.3 remote-as65501 nlri unicast multicast<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-router)#nei 3.3.3.3update-source loopback 0<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config-router)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)# ip pim bsr-candidateloopback 10<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#ip pim rp-candidate loopback10<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#ip msdp peer 1.1.1.1connect-source loopback 0<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#ip msdp peer 3.3.3.3 connect-sourceloopback 0<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#ip msdp mesh-group anycast-rp1.1.1.1<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#ip msdp mesh-group anycast-rp3.3.3.3<br></span></p>
<p><span style="color:black; font-size:10pt">R2(config)#ip msdp originator-idloopback 0<br></span></p>
<p><span style="color:black; font-size:10pt">R3<span style="font-family:宋体">配置：</span><br>                </span></p>
<p><span style="color:black; font-size:10pt">R3#conf t<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#ip multicast-routing<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#int e0/0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip add 192.168.23.3255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#int e0/1<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip add 192.168.34.3255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#int lo 0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip add 3.3.3.3255.255.255.255<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#int lo 10<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip add 10.10.10.10255.255.255.255<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#router ospf 1<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#router-id 3.3.3.3<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#net 3.3.3.3 0.0.0.0 area0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#net 10.10.10.100.0.0.0 area 0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#net 192.168.23.0255.255.255.0 area 0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#net 192.168.34.0255.255.255.0 area 0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#router bgp 65501<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#bgp router-id 3.3.3.3<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#net 192.168.23.0 mask255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#net 192.168.34.0 mask255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#net 10.10.10.10 mask255.255.255.255<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#nei 1.1.1.1 remote-as65501 nlri unicast multicast<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#nei 1.1.1.1update-source loopback 0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#nei 2.2.2.2 remote-as65501 nlri unicast multicast<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#nei 2.2.2.2update-source loopback 0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#nei 192.168.34.4remote-as 65502 nlri unicast multicast<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config-router)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#ip pim bsr-candidate loopback10<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#ip pim rp-candidate loopback10<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#ip msdp peer 1.1.1.1connect-source loopback 0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#ip msdp peer 2.2.2.2 connect-sourceloopback 0<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)# ip msdp peer 192.168.34.4connect-source ethernet 0/1 remote-as 65502<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#ip msdp mesh-group anycast-rp1.1.1.1<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#ip msdp mesh-group anycast-rp2.2.2.2<br></span></p>
<p><span style="color:black; font-size:10pt">R3(config)#ip msdp originator-idloopback 0<br></span></p>
<p><span style="color:black; font-size:10pt">R4<span style="font-family:宋体">配置：</span><br>                </span></p>
<p><span style="color:black; font-size:10pt">R4#conf t<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#ip multicast-routing<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#int e0/0<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip add 192.168.34.4255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#int e0/1<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip add 192.168.45.4255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#int lo 0<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip add 4.4.4.4255.255.255.255<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#int lo 20<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip add 20.20.20.20255.255.255.255<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#router eigrp 1<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-router)#no au<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-router)#net 0.0.0.0 0.0.0.0<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-router)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#router bgp 65502<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-router)#bgp router-id 4.4.4.4<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-router)#net 192.168.34.0 mask255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-router)#net 192.168.45.0 mask255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-router)#net 20.20.20.20 mask255.255.255.255<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-router)#nei 192.168.34.3remote-as 65501 nlri unicast multicast<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-router)#nei 5.5.5.5 remote-as65502 nlri unicast multicast<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-router)#nei 5.5.5.5update-source loopback 0<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config-router)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#ip pim rp-address 20.20.20.20<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)# ip msdp peer 192.168.34.3connect-source Ethernet 0/0 remote-as 65501<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#ip msdp peer 5.5.5.5connect-source loopback 0<br></span></p>
<p><span style="color:black; font-size:10pt">R4(config)#ip msdp originator-idloopback 0<br></span></p>
<p><span style="color:black; font-size:10pt">R5<span style="font-family:宋体">配置：</span><br>                </span></p>
<p><span style="color:black; font-size:10pt">R5#conf t<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#ip multicast-routing<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#int e0/0<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#ip add 192.168.45.5255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#int e0/1<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#ip add 192.168.0.1255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#int lo 0<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#ip add 5.5.5.5255.255.255.255<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#int lo 20<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#ip add 20.20.20.20255.255.255.255<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#ip pim sparse-mode<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-if)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#router eigrp 1<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-router)#no au<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-router)#net 0.0.0.0 0.0.0.0<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-router)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#router bgp 65502<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-router)#bgp router-id 5.5.5.5<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-router)#net 192.168.45.0 mask255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-router)#net 192.168.0.0 mask255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-router)#nei 4.4.4.4 remote-as65502 nlri unicast multicast<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-router)#nei 4.4.4.4update-source loopback 0<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config-router)#exit<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#ip pim rp-address 20.20.20.20<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#ip msdp peer 4.4.4.4connect-source loopback 0<br></span></p>
<p><span style="color:black; font-size:10pt">R5(config)#ip msdp originator-idloopback 0<br></span></p>
<p><span style="color:black; font-size:10pt">PC<span style="font-family:宋体">配置：</span><br>                </span></p>
<p><span style="color:black; font-size:10pt">PC#conf t<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config)#no ip routing<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config)#ip default-gateway192.168.0.1<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config)#int e0/0<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config-if)#ip add 192.168.0.2255.255.255.0<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config-if)#ip igmp join-group224.1.1.1<br></span></p>
<p><span style="color:black; font-size:10pt">PC(config-if)#no sh<br></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">此时在</span>Server<span style="font-family:宋体">端</span>ping 224.1.1.1 <span style="font-family:宋体">，并调试</span>R3<span style="font-family:宋体">和</span>R4 <span style="font-family:宋体">变化：</span><br>                </span></p>
<p><span style="color:black; font-size:10pt">Server#ping 224.1.1.1 repeat 100<br></span></p>
<p><span style="color:black; font-size:10pt">Type escape sequence to abort.<br></span></p>
<p><span style="color:black; font-size:10pt">Sending 100, 100-byte ICMP Echos to224.1.1.1, timeout is 2 seconds:<br></span></p>
<p><span style="color:black; font-size:10pt">.<br></span></p>
<p><span style="color:black; font-size:10pt">Reply to request 1 from 192.168.0.2, 184ms<br></span></p>
<p><span style="color:black; font-size:10pt">Reply to request 2 from 192.168.0.2, 188ms<br></span></p>
<p><span style="color:black; font-size:10pt">Reply to request 3 from 192.168.0.2, 184ms<br></span></p>
<p><span style="color:black; font-size:10pt">R3#debug ip msdp  detail<br></span></p>
<p><span style="color:black; font-size:10pt">MSDP Detail debugging is on<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:02:30.503: %PIM-5-NBRCHG: neighbor 192.168.34.4 UP on interfaceEthernet0/1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:02:30.519: %PIM-5-DRCHG: DR change from neighbor 192.168.34.3 to192.168.34.4 on interface Ethernet0/1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:03:01.683: %BGP-5-ADJCHANGE: neighbor 192.168.34.4 Up<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:03:05.383: %MSDP-5-PEER_UPDOWN: Session to peer 192.168.34.4 goingup<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:03:07.327: MSDP(0): start_index = 0, sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:03:07.327: MSDP(0): Sent entire sa-cache, sa_cache_index = 0, Qlen= 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:03:31.071: MSDP(0): Received 3-byte TCP segment from 192.168.34.4<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:03:31.071: MSDP(0): Append 3 bytes to 0-byte msg 0 from192.168.34.4, qs 1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:03:48.295: %PIM-5-NBRCHG: neighbor 192.168.23.2 UP on interface Ethernet0/0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:03:56.027: %OSPF-5-ADJCHG: Process 1, Nbr 2.2.2.2 on Ethernet0/0from LOADING to FULL, Loading Done<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:04:00.331: MSDP(0): start_index = 0, sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:04:00.331: MSDP(0): Sent entire sa-cache, sa_cache_index = 0, Qlen= 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:04:22.979: %BGP-5-ADJCHANGE: neighbor 2.2.2.2 Up<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:04:31.067: MSDP(0): Received 3-byte TCP segment from 192.168.34.4<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:04:31.067: MSDP(0): Append 3 bytes to 0-byte msg 1 from192.168.34.4, qs 1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:04:46.851: %MSDP-5-PEER_UPDOWN: Session to peer 1.1.1.1 going up<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:04:47.715: MSDP(0): Received 3-byte TCP segment from 1.1.1.1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:04:47.715: MSDP(0): Append 3 bytes to 0-byte msg 2 from 1.1.1.1, qs1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:04:47.779: %MSDP-5-PEER_UPDOWN: Session to peer 2.2.2.2 going up<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:04:48.335: MSDP(0): start_index = 0, sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:04:48.339: MSDP(0): Sent entire sa-cache, sa_cache_index = 0, Qlen= 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:04:48.943: MSDP(0): Received 3-byte TCP segment from 2.2.2.2<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:04:48.947: MSDP(0): Append 3 bytes to 0-byte msg 3 from 2.2.2.2, qs1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:04:49.343: MSDP(0): start_index = 0, sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:04:49.343: MSDP(0): Sent entire sa-cache, sa_cache_index = 0, Qlen= 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:04:51.763: %BGP-5-ADJCHANGE: neighbor 1.1.1.1 Up<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:05:00.343: MSDP(0): start_index = 0, sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar 1 00:05:00.343: MSDP(0): Sent entire sa-cache, sa_cache_index = 0, Qlen= 0<br></span></p>
<p><span style="color:red; font-size:10pt">*Mar  1 00:05:39.539: MSDP(0): Received 120-byteTCP segment from 1.1.1.1<span style="color:black"><br>                    </span></span></p>
<p><span style="color:red; font-size:10pt">*Mar  1 00:05:39.539: MSDP(0): Append 120 bytes to0-byte msg 5 from 1.1.1.1, qs 1<span style="color:black"><br>                    </span></span></p>
<p><span style="color:red; font-size:10pt">*Mar  1 00:05:39.539: MSDP(0): WAVL Insert SASource 192.168.1.2 Group 224.1.1.1 RP 1.1.1.1 Successful<span style="color:black"><br>                    </span></span></p>
<p><span style="color:black; font-size:10pt">R4#debugip msdp de<br></span></p>
<p><span style="color:black; font-size:10pt">MSDPDetail debugging is on<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:00:33.651: %PIM-5-NBRCHG: neighbor192.168.34.3 UP on interface Ethernet0/0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:00:35.487: %BGP-5-ADJCHANGE: neighbor192.168.34.3 Up<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:00:39.235: %MSDP-5-PEER_UPDOWN: Sessionto peer 192.168.34.3 going up<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:00:40.175: MSDP(0): Received 3-byte TCPsegment from 192.168.34.3<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:00:40.175: MSDP(0): Append 3 bytes to0-byte msg 0 from 192.168.34.3, qs 1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:00:40.871: MSDP(0): start_index = 0,sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:00:40.871: MSDP(0): Sent entiresa-cache, sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:01:24.255: %PIM-5-NBRCHG: neighbor192.168.45.5 UP on interface Ethernet0/1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:01:24.271: %PIM-5-DRCHG: DR change fromneighbor 192.168.45.4 to 192.168.45.5 on interface Ethernet0/1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:01:25.887: %DUAL-5-NBRCHANGE:IP-EIGRP(0) 1: Neighbor 192.168.45.5 (Ethernet0/1) is up: new adjacency<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:01:34.947: %MSDP-5-PEER_UPDOWN: Sessionto peer 5.5.5.5 going up<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:01:36.879: MSDP(0): start_index = 0,sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:01:36.879: MSDP(0): Sent entiresa-cache, sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:01:38.883: MSDP(0): start_index = 0,sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:01:38.883: MSDP(0): Sent entiresa-cache, sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:01:39.251: %BGP-5-ADJCHANGE: neighbor5.5.5.5 Up<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:01:40.183: MSDP(0): Received 3-byte TCPsegment from 192.168.34.3<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:01:40.183: MSDP(0): Append 3 bytes to0-byte msg 1 from 192.168.34.3, qs 1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:02:25.027: MSDP(0): Received 3-byte TCPsegment from 5.5.5.5<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:02:25.031: MSDP(0): Append 3 bytes to0-byte msg 2 from 5.5.5.5, qs 1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:02:29.883: MSDP(0): start_index = 0,sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:02:29.883: MSDP(0): Sent entiresa-cache, sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:02:38.883: MSDP(0): start_index = 0,sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:02:38.883: MSDP(0): Sent entiresa-cache, sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:02:40.183: MSDP(0): Received 3-byte TCPsegment from 192.168.34.3<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:02:40.183: MSDP(0): Append 3 bytes to0-byte msg 3 from 192.168.34.3, qs 1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:03:13.379: MSDP(0): Received 120-byteTCP segment from 192.168.34.3<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:03:13.379: MSDP(0): Append 120 bytes to0-byte msg 4 from 192.168.34.3, qs 1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:03:24.883: MSDP(0): start_index = 0,sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:03:24.883: MSDP(0): Sent entiresa-cache, sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:03:25.015: MSDP(0): Received 3-byte TCPsegment from 5.5.5.5<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:03:25.015: MSDP(0): Append 3 bytes to0-byte msg 5 from 5.5.5.5, qs 1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:03:30.887: MSDP(0): start_index = 0,sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:03:30.887: MSDP(0): Sent entiresa-cache, sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:red; font-size:10pt">*Mar  1 00:03:32.159: MSDP(0): Received 20-byte TCPsegment from 192.168.34.3<span style="color:black"><br>                    </span></span></p>
<p><span style="color:red; font-size:10pt">*Mar  1 00:03:32.163: MSDP(0): Append 20 bytes to0-byte msg 6 from 192.168.34.3, qs 1<span style="color:black"><br>                    </span></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:04:20.895: MSDP(0): start_index = 0,sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:04:25.027: MSDP(0): Received 3-byte TCPsegment from 5.5.5.5<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:04:25.031: MSDP(0): Append 3 bytes to0-byte msg 7 from 5.5.5.5, qs 1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:04:25.899: MSDP(0): start_index = 0,sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:04:25.899: MSDP(0): Sent entiresa-cache, sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:04:29.183: MSDP(0): Received 20-byte TCPsegment from 192.168.34.3<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:04:29.187: MSDP(0): Append 20 bytes to0-byte msg 8 from 192.168.34.3, qs 1<br></span></p>
<p><span style="color:black; font-size:10pt">R4#debugip msdp de<br></span></p>
<p><span style="color:black; font-size:10pt">MSDPDetail debugging is on<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:00:33.651: %PIM-5-NBRCHG: neighbor192.168.34.3 UP on interface Ethernet0/0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:00:35.487: %BGP-5-ADJCHANGE: neighbor192.168.34.3 Up<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:00:39.235: %MSDP-5-PEER_UPDOWN: Sessionto peer 192.168.34.3 going up<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:00:40.175: MSDP(0): Received 3-byte TCPsegment from 192.168.34.3<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:00:40.175: MSDP(0): Append 3 bytes to0-byte msg 0 from 192.168.34.3, qs 1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:00:40.871: MSDP(0): start_index = 0,sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:00:40.871: MSDP(0): Sent entiresa-cache, sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:01:24.255: %PIM-5-NBRCHG: neighbor192.168.45.5 UP on interface Ethernet0/1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:01:24.271: %PIM-5-DRCHG: DR change fromneighbor 192.168.45.4 to 192.168.45.5 on interface Ethernet0/1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:01:25.887: %DUAL-5-NBRCHANGE: IP-EIGRP(0)1: Neighbor 192.168.45.5 (Ethernet0/1) is up: new adjacency<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:01:34.947: %MSDP-5-PEER_UPDOWN: Sessionto peer 5.5.5.5 going up<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:01:36.879: MSDP(0): start_index = 0,sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:01:36.879: MSDP(0): Sent entiresa-cache, sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:01:38.883: MSDP(0): start_index = 0,sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:01:38.883: MSDP(0): Sent entiresa-cache, sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:01:39.251: %BGP-5-ADJCHANGE: neighbor 5.5.5.5Up<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:01:40.183: MSDP(0): Received 3-byte TCPsegment from 192.168.34.3<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:01:40.183: MSDP(0): Append 3 bytes to0-byte msg 1 from 192.168.34.3, qs 1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:02:25.027: MSDP(0): Received 3-byte TCPsegment from 5.5.5.5<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:02:25.031: MSDP(0): Append 3 bytes to0-byte msg 2 from 5.5.5.5, qs 1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:02:29.883: MSDP(0): start_index = 0,sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:02:29.883: MSDP(0): Sent entiresa-cache, sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:02:38.883: MSDP(0): start_index = 0,sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:02:38.883: MSDP(0): Sent entiresa-cache, sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:02:40.183: MSDP(0): Received 3-byte TCPsegment from 192.168.34.3<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:02:40.183: MSDP(0): Append 3 bytes to0-byte msg 3 from 192.168.34.3, qs 1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:03:13.379: MSDP(0): Received 120-byteTCP segment from 192.168.34.3<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:03:13.379: MSDP(0): Append 120 bytes to0-byte msg 4 from 192.168.34.3, qs 1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:03:24.883: MSDP(0): start_index = 0, sa_cache_index= 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:03:24.883: MSDP(0): Sent entiresa-cache, sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:03:25.015: MSDP(0): Received 3-byte TCPsegment from 5.5.5.5<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:03:25.015: MSDP(0): Append 3 bytes to0-byte msg 5 from 5.5.5.5, qs 1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:03:30.887: MSDP(0): start_index = 0,sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:03:30.887: MSDP(0): Sent entiresa-cache, sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:03:32.159: MSDP(0): Received 20-byte TCPsegment from 192.168.34.3<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:03:32.163: MSDP(0): Append 20 bytes to0-byte msg 6 from 192.168.34.3, qs 1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:04:20.895: MSDP(0): start_index = 0,sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:04:20.895: MSDP(0): Sent entiresa-cache, sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:04:25.027: MSDP(0): Received 3-byte TCPsegment from 5.5.5.5<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:04:25.031: MSDP(0): Append 3 bytes to0-byte msg 7 from 5.5.5.5, qs 1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:04:25.899: MSDP(0): start_index = 0,sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:04:25.899: MSDP(0): Sent entire sa-cache,sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:04:29.183: MSDP(0): Received 20-byte TCPsegment from 192.168.34.3<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:04:29.187: MSDP(0): Append 20 bytes to0-byte msg 8 from 192.168.34.3, qs 1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:05:20.903: MSDP(0): start_index = 0,sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:05:20.903: MSDP(0): Sent entiresa-cache, sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:05:23.903: MSDP(0): start_index = 0,sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:05:23.903: MSDP(0): Sent entiresa-cache, sa_cache_index = 0, Qlen = 0<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:05:24.999: MSDP(0): Received 3-byte TCPsegment from 5.5.5.5<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:05:25.003: MSDP(0): Append 3 bytes to0-byte msg 9 from 5.5.5.5, qs 1<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:05:28.207: MSDP(0): Received 20-byte TCPsegment from 192.168.34.3<br></span></p>
<p><span style="color:black; font-size:10pt">*Mar  1 00:05:28.207: MSDP(0): Append 20 bytes to0-byte msg 10 from 192.168.34.3, qs 1<br></span></p>
<p><span style="color:black; font-size:10pt"><span style="font-family:宋体">查看</span>R3<span style="font-family:宋体">和</span>R4<span style="font-family:宋体">的多播路由表</span><br>                </span></p>
<p><span style="color:black; font-size:10pt">R3#sh ip mroute<br></span></p>
<p><span style="color:black; font-size:10pt">IP Multicast Routing Table<br></span></p>
<p><span style="color:black; font-size:10pt">Flags: D - Dense, S - Sparse, B - BidirGroup, s - SSM Group, C - Connected,<br></span></p>
<p><span style="color:black; font-size:10pt">      L - Local, P - Pruned, R - RP-bit set, F - Register flag,<br></span></p>
<p><span style="color:black; font-size:10pt">      T - SPT-bit set, J - Join SPT, M - MSDP created entry,<br></span></p>
<p><span style="color:black; font-size:10pt">      X - Proxy Join Timer Running, A - Candidate for MSDP Advertisement,<br></span></p>
<p><span style="color:black; font-size:10pt">      U - URD, I - Received Source Specific Host Report,<br></span></p>
<p><span style="color:black; font-size:10pt">      Z - Multicast Tunnel, z - MDT-data group sender,<br></span></p>
<p><span style="color:black; font-size:10pt">      Y - Joined MDT-data group, y - Sending to MDT-data group<br></span></p>
<p><span style="color:black; font-size:10pt">Outgoing interface flags: H - Hardwareswitched, A - Assert winner<br></span></p>
<p><span style="color:black; font-size:10pt"> Timers: Uptime/Expires<br></span></p>
<p><span style="color:black; font-size:10pt"> Interface state: Interface, Next-Hop or VCD,State/Mode<br></span></p>
<p><span style="color:red; font-size:10pt">(*, 224.1.1.1),00:07:34/00:02:46, RP 10.10.10.10, flags: S<span style="color:black"><br>                    </span></span></p>
<p><span style="color:red; font-size:10pt">  Incoming interface: Ethernet0/0, RPF nbr192.168.23.2<span style="color:black"><br>                    </span></span></p>
<p><span style="color:red; font-size:10pt">  Outgoing interface list:<span style="color:black"><br>                    </span></span></p>
<p><span style="color:red; font-size:10pt">    Ethernet0/1, Forward/Sparse,00:07:34/00:02:46<span style="color:black"><br>                    </span></span></p>
<p><span style="color:red; font-size:10pt">(192.168.1.2,224.1.1.1), 00:06:45/00:00:09, flags: T<span style="color:black"><br>                    </span></span></p>
<p><span style="color:red; font-size:10pt">  Incoming interface: Ethernet0/0, RPF nbr192.168.23.2<span style="color:black"><br>                    </span></span></p>
<p><span style="color:red; font-size:10pt">  Outgoing interface list:<span style="color:black"><br>                    </span></span></p>
<p><span style="color:red; font-size:10pt">    Ethernet0/1, Forward/Sparse,00:06:45/00:02:46<span style="color:black"><br>                    </span></span></p>
<p><span style="color:black; font-size:10pt">(*, 224.0.1.40), 00:12:22/00:02:37, RP0.0.0.0, flags: DCL<br></span></p>
<p><span style="color:black; font-size:10pt"> Incoming interface: Null, RPF nbr 0.0.0.0<br></span></p>
<p><span style="color:black; font-size:10pt"> Outgoing interface list:<br></span></p>
<p><span style="color:black; font-size:10pt">   Loopback0, Forward/Sparse, 00:12:22/00:02:37<br></span></p>
<p><span style="color:black; font-size:10pt">R4#sh ip mroute<br></span></p>
<p><span style="color:black; font-size:10pt">IP Multicast Routing Table<br></span></p>
<p><span style="color:black; font-size:10pt">Flags: D - Dense, S - Sparse, B - BidirGroup, s - SSM Group, C - Connected,<br></span></p>
<p><span style="color:black; font-size:10pt">      L - Local, P - Pruned, R - RP-bit set, F - Register flag,<br></span></p>
<p><span style="color:black; font-size:10pt">      T - SPT-bit set, J - Join SPT, M - MSDP created entry,<br></span></p>
<p><span style="color:black; font-size:10pt">      X - Proxy Join Timer Running, A - Candidate for MSDP Advertisement,<br></span></p>
<p><span style="color:black; font-size:10pt">      U - URD, I - Received Source Specific Host Report,<br></span></p>
<p><span style="color:black; font-size:10pt">      Z - Multicast Tunnel, z - MDT-data group sender,<br></span></p>
<p><span style="color:black; font-size:10pt">      Y - Joined MDT-data group, y - Sending to MDT-data group<br></span></p>
<p><span style="color:black; font-size:10pt">Outgoing interface flags: H - Hardwareswitched, A - Assert winner<br></span></p>
<p><span style="color:black; font-size:10pt"> Timers: Uptime/Expires<br></span></p>
<p><span style="color:black; font-size:10pt"> Interface state: Interface, Next-Hop or VCD,State/Mode<br></span></p>
<p><span style="color:red; font-size:10pt">(*, 224.1.1.1),00:08:08/00:03:15, RP 10.10.10.10, flags: S<span style="color:black"><br>                    </span></span></p>
<p><span style="color:red; font-size:10pt">  Incoming interface: Ethernet0/0, RPF nbr192.168.34.3<span style="color:black"><br>                    </span></span></p>
<p><span style="color:red; font-size:10pt">  Outgoing interface list:<span style="color:black"><br>                    </span></span></p>
<p><span style="color:red; font-size:10pt">    Ethernet0/1, Forward/Sparse,00:08:08/00:03:15<span style="color:black"><br>                    </span></span></p>
<p><span style="color:black; font-size:10pt">(*, 224.0.1.40), 00:10:28/00:02:35, RP0.0.0.0, flags: DCL<br></span></p>
<p><span style="color:black; font-size:10pt"> Incoming interface: Null, RPF nbr 0.0.0.0<br></span></p>
<p><span style="color:black; font-size:10pt"> Outgoing interface list:<br></span></p>
<p><span style="color:black; font-size:10pt">   Loopback0, Forward/Sparse, 00:10:28/00:02:35<br></span></p>

        </div>
        
          


  <section class='meta' id="footer-meta">
    <hr>
    <div class='new-meta-box'>
      
        
          <div class="new-meta-item date" itemprop="dateUpdated" datetime="2017-07-10T16:45:39+08:00">
  <a class='notlink'>
    <i class="fas fa-clock" aria-hidden="true"></i>
    <p>最后更新于 2017年7月10日</p>
  </a>
</div>

        
      
        
          

        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title="QQ好友" rel="external nofollow noopener noreferrer"
          
          href="http://connect.qq.com/widget/shareqq/index.html?url=http://demonelf.github.io/EMBEDDED/CCNP路由实验之十 组播（多播）.html&title=CCNP路由实验之十 组播（多播） | 芯机智&summary=CCNP路由实验之十 组播（多播）


 单播（Unicast）：网络节点之间的通信通讯的模式是”一对一”的，此时信息的接收和传递只在两个节点之间进行。例如，你在收发电子邮件、浏览网页时，必须与邮件服务器、Web服务器建立连接，此时使用的就是单播数据传输方"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/qq.png">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title="QQ空间" rel="external nofollow noopener noreferrer"
          
          href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://demonelf.github.io/EMBEDDED/CCNP路由实验之十 组播（多播）.html&title=CCNP路由实验之十 组播（多播） | 芯机智&summary=CCNP路由实验之十 组播（多播）


 单播（Unicast）：网络节点之间的通信通讯的模式是”一对一”的，此时信息的接收和传递只在两个节点之间进行。例如，你在收发电子邮件、浏览网页时，必须与邮件服务器、Web服务器建立连接，此时使用的就是单播数据传输方"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/qzone.png">
          
        </a>
      
    
      
        <a class="-mob-share-weibo" title="微博" rel="external nofollow noopener noreferrer"
          
          href="http://service.weibo.com/share/share.php?url=http://demonelf.github.io/EMBEDDED/CCNP路由实验之十 组播（多播）.html&title=CCNP路由实验之十 组播（多播） | 芯机智&summary=CCNP路由实验之十 组播（多播）


 单播（Unicast）：网络节点之间的通信通讯的模式是”一对一”的，此时信息的接收和传递只在两个节点之间进行。例如，你在收发电子邮件、浏览网页时，必须与邮件服务器、Web服务器建立连接，此时使用的就是单播数据传输方"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/weibo.png">
          
        </a>
      
    
  </div>
</div>



        
      
    </div>
  </section>


        
        
            <div class="prev-next">
                
                    <section class="prev">
                        <span class="art-item-left">
                            <h6><i class="fas fa-chevron-left" aria-hidden="true"></i>&nbsp;上一页</h6>
                            <h4>
                                <a href="/EMBEDDED/CISCO组播RPF逆向路径转发实验原理.html" rel="prev" title="CISCO组播RPF逆向路径转发实验原理">
                                  
                                      CISCO组播RPF逆向路径转发实验原理
                                  
                                </a>
                            </h4>
                            
                        </span>
                    </section>
                
                
                    <section class="next">
                        <span class="art-item-right" aria-hidden="true">
                            <h6>下一页&nbsp;<i class="fas fa-chevron-right" aria-hidden="true"></i></h6>
                            <h4>
                                <a href="/EMBEDDED/PIM-SSM简介.html" rel="prev" title="PIM-SSM简介">
                                    
                                        PIM-SSM简介
                                    
                                </a>
                            </h4>
                            
                        </span>
                    </section>
                
            </div>
        
      </section>
    </article>
  

  
    <!-- 显示推荐文章和评论 -->



  


  




<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->



  <script>
    window.subData = {
      title: 'CCNP路由实验之十 组播（多播）',
      tools: true
    }
  </script>


</div>
<aside class='l_side'>
  
    
    
      
        
          
          
            <section class='widget author'>
  <div class='content pure'>
    
      <div class='avatar'>
        <img class='avatar' src='http://bbs.dnsnat.com/discuz/uc_server/data/avatar/000/00/00/01_avatar_big.jpg'/>
      </div>
    
    
    
      <div class="social-wrapper">
        
          
            <a href="/atom.xml"
              class="social fas fa-rss flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="mailto:me@xaoxuu.com"
              class="social fas fa-envelope flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://github.com/xaoxuu"
              class="social fab fa-github flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://music.163.com/#/user/home?id=63035382"
              class="social fas fa-headphones-alt flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
      </div>
    
  </div>
</section>

          
        
      
        
          
          
            

          
        
      
        
          
          
            <section class='widget grid'>
  
<header class='pure'>
  <div><i class="fas fa-map-signs fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;站内导航</div>
  
</header>

  <div class='content pure'>
    <ul class="grid navgation">
      
        <li><a class="flat-box" title="/" href="/"
          
          
          id="home">
          
            <i class="fas fa-clock fa-fw" aria-hidden="true"></i>
          
          近期文章
        </a></li>
      
        <li><a class="flat-box" title="/blog/archives/" href="/blog/archives/"
          
            rel="nofollow"
          
          
          id="blogarchives">
          
            <i class="fas fa-archive fa-fw" aria-hidden="true"></i>
          
          文章归档
        </a></li>
      
        <li><a class="flat-box" title="/projects/" href="/projects/"
          
          
          id="projects">
          
            <i class="fas fa-code-branch fa-fw" aria-hidden="true"></i>
          
          开源项目
        </a></li>
      
        <li><a class="flat-box" title="/friends/" href="/friends/"
          
            rel="nofollow"
          
          
          id="friends">
          
            <i class="fas fa-link fa-fw" aria-hidden="true"></i>
          
          我的友链
        </a></li>
      
        <li><a class="flat-box" title="https://xaoxuu.com/wiki/material-x/" href="https://xaoxuu.com/wiki/material-x/"
          
            rel="nofollow"
          
          
          id="https:xaoxuu.comwikimaterial-x">
          
            <i class="fas fa-book fa-fw" aria-hidden="true"></i>
          
          主题文档
        </a></li>
      
        <li><a class="flat-box" title="/about/" href="/about/"
          
            rel="nofollow"
          
          
          id="about">
          
            <i class="fas fa-info-circle fa-fw" aria-hidden="true"></i>
          
          关于小站
        </a></li>
      
    </ul>
  </div>
</section>

          
        
      
        
          
          
            
  <section class='widget category'>
    
<header class='pure'>
  <div><i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;文章分类</div>
  
    <a class="rightBtn"
    
      rel="nofollow"
    
    
    href="/categories/"
    title="categories/">
    <i class="fas fa-expand-arrows-alt fa-fw"></i></a>
  
</header>

    <div class='content pure'>
      <ul class="entry">
        
          <li><a class="flat-box" title="/categories/DEVELOP/" href="/categories/DEVELOP/"><div class='name'>DEVELOP</div><div class='badge'>(4)</div></a></li>
        
          <li><a class="flat-box" title="/categories/EMBEDDED/" href="/categories/EMBEDDED/"><div class='name'>EMBEDDED</div><div class='badge'>(95)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/EMBEDDED/mini2440/" href="/categories/EMBEDDED/mini2440/"><div class='name'>mini2440</div><div class='badge'>(3)</div></a></li>
        
          <li><a class="flat-box" title="/categories/LIVE/" href="/categories/LIVE/"><div class='name'>LIVE</div><div class='badge'>(3)</div></a></li>
        
          <li><a class="flat-box" title="/categories/NETWORK/" href="/categories/NETWORK/"><div class='name'>NETWORK</div><div class='badge'>(12)</div></a></li>
        
          <li><a class="flat-box" title="/categories/SYSTEM/" href="/categories/SYSTEM/"><div class='name'>SYSTEM</div><div class='badge'>(12)</div></a></li>
        
          <li><a class="flat-box" title="/categories/VPN系列之五花八门/" href="/categories/VPN系列之五花八门/"><div class='name'>VPN系列之五花八门</div><div class='badge'>(2)</div></a></li>
        
          <li><a class="flat-box" title="/categories/arm/" href="/categories/arm/"><div class='name'>arm</div><div class='badge'>(0)</div></a></li>
        
          <li><a class="flat-box" title="/categories/embedded/" href="/categories/embedded/"><div class='name'>embedded</div><div class='badge'>(0)</div></a></li>
        
          <li><a class="flat-box" title="/categories/linux/" href="/categories/linux/"><div class='name'>linux</div><div class='badge'>(0)</div></a></li>
        
          <li><a class="flat-box" title="/categories/笑看人生/" href="/categories/笑看人生/"><div class='name'>笑看人生</div><div class='badge'>(0)</div></a></li>
        
      </ul>
    </div>
  </section>


          
        
      
        
          
          
            
  <section class='widget tagcloud'>
    
<header class='pure'>
  <div><i class="fas fa-fire fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;热门标签</div>
  
    <a class="rightBtn"
    
      rel="nofollow"
    
    
    href="/blog/tags/"
    title="blog/tags/">
    <i class="fas fa-expand-arrows-alt fa-fw"></i></a>
  
</header>

    <div class='content pure'>
      <a href="/tags/linux/" style="font-size: 14px; color: #999">linux</a>
    </div>
  </section>


          
        
      
        
          
          
            


  <section class='widget music'>
    
<header class='pure'>
  <div><i class="fas fa-compact-disc fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;最近在听</div>
  
    <a class="rightBtn"
    
      rel="external nofollow noopener noreferrer"
    
    
      target="_blank"
    
    href="https://music.163.com/#/user/home?id=63035382"
    title="https://music.163.com/#/user/home?id=63035382">
    <i class="far fa-heart fa-fw"></i></a>
  
</header>

    <div class='content pure'>
      
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.7.0/dist/APlayer.min.css">
  <div class="aplayer"
    data-theme="#1BCDFC"
    
    
    data-mode="circulation"
    data-server="netease"
    data-type="playlist"
    data-id="2615636388"
    data-volume="0.7">
  </div>
  <script src="https://cdn.jsdelivr.net/npm/aplayer@1.7.0/dist/APlayer.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/meting@1.1.0/dist/Meting.min.js"></script>


    </div>
  </section>


          
        
      
    

  
</aside>

<footer id="footer" class="clearfix">
  
  
    <div class="social-wrapper">
      
        
          <a href="/atom.xml"
            class="social fas fa-rss flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="mailto:me@xaoxuu.com"
            class="social fas fa-envelope flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://github.com/xaoxuu"
            class="social fab fa-github flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://music.163.com/#/user/home?id=63035382"
            class="social fas fa-headphones-alt flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
    </div>
  
  <br>
  <div><p>博客内容遵循 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p>
</div>
  <div>
    本站使用
    <a href="https://xaoxuu.com/wiki/material-x/" target="_blank" class="codename">Material X</a>
    作为主题
    
      ，
      总访问量为
      <span id="busuanzi_value_site_pv"><i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span>
      次
    
    。
  </div>
</footer>
<script>setLoadingBarProgress(80);</script>


      <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>

  <script>
    var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
    var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
    var ALGOLIA_API_KEY = "";
    var ALGOLIA_APP_ID = "";
    var ALGOLIA_INDEX_NAME = "";
    var AZURE_SERVICE_NAME = "";
    var AZURE_INDEX_NAME = "";
    var AZURE_QUERY_KEY = "";
    var BAIDU_API_ID = "";
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/"||"/";
    if(!ROOT.endsWith('/'))ROOT += '/';
  </script>

<script src="//instant.page/1.2.2" type="module" integrity="sha384-2xV8M5griQmzyiY3CDqh1dn4z3llDVqZDqzjzcY+jCBCk/a5fXJmuZ/40JJAPeoU"></script>


  <script async src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.5/dist/scrollreveal.min.js"></script>
  <script type="text/javascript">
    $(function() {
      const $reveal = $('.reveal');
      if ($reveal.length === 0) return;
      const sr = ScrollReveal({ distance: 0 });
      sr.reveal('.reveal');
    });
  </script>


  <script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>
  <script type="text/javascript">
    $(function() {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>




  
  
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-backstretch/2.0.4/jquery.backstretch.min.js"></script>
    <script type="text/javascript">
      $(function(){
        if ('.cover') {
          $('.cover').backstretch(
          ["https://img.vim-cn.com/6d/a0c9e6f9efad8b731cb7376504bd10d79d2053.jpg"],
          {
            duration: "6000",
            fade: "2500"
          });
        } else {
          $.backstretch(
          ["https://img.vim-cn.com/6d/a0c9e6f9efad8b731cb7376504bd10d79d2053.jpg"],
          {
            duration: "6000",
            fade: "2500"
          });
        }
      });
    </script>
  











  <script src="/js/app.js"></script>


  <script src="/js/search.js"></script>




<!-- 复制 -->
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  let COPY_SUCCESS = "复制成功";
  let COPY_FAILURE = "复制失败";
  /*页面载入完成后，创建复制按钮*/
  !function (e, t, a) {
    /* code */
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '  <i class="fa fa-copy"></i><span>复制</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });

      clipboard.on('success', function(e) {
        //您可以加入成功提示
        console.info('Action:', e.action);
        console.info('Text:', e.text);
        console.info('Trigger:', e.trigger);
        success_prompt(COPY_SUCCESS);
        e.clearSelection();
      });
      clipboard.on('error', function(e) {
        //您可以加入失败提示
        console.error('Action:', e.action);
        console.error('Trigger:', e.trigger);
        fail_prompt(COPY_FAILURE);
      });
    }
    initCopyCode();

  }(window, document);

  /**
   * 弹出式提示框，默认1.5秒自动消失
   * @param message 提示信息
   * @param style 提示样式，有alert-success、alert-danger、alert-warning、alert-info
   * @param time 消失时间
   */
  var prompt = function (message, style, time)
  {
      style = (style === undefined) ? 'alert-success' : style;
      time = (time === undefined) ? 1500 : time*1000;
      $('<div>')
          .appendTo('body')
          .addClass('alert ' + style)
          .html(message)
          .show()
          .delay(time)
          .fadeOut();
  };

  // 成功提示
  var success_prompt = function(message, time)
  {
      prompt(message, 'alert-success', time);
  };

  // 失败提示
  var fail_prompt = function(message, time)
  {
      prompt(message, 'alert-danger', time);
  };

  // 提醒
  var warning_prompt = function(message, time)
  {
      prompt(message, 'alert-warning', time);
  };

  // 信息提示
  var info_prompt = function(message, time)
  {
      prompt(message, 'alert-info', time);
  };

</script>


<!-- fancybox -->
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  let LAZY_LOAD_IMAGE = "";
  $(".article-entry").find("fancybox").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* 图片采用懒加载处理时,
       * 一般图片标签内会有个属性名来存放图片的真实地址，比如 data-original,
       * 那么此处将原本的属性名src替换为对应属性名data-original,
       * 修改如下
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });
</script>





  <script>setLoadingBarProgress(100);</script>
</body>
</html>
